"use strict";// Helper functions for accessing the Spotify API.
function cov_xf23uqgkz(){var path="/parse-server/lib/Adapters/Auth/spotify.js";var hash="3412e00a9e4061824d1ad94b7e84359c9fa1b527";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/parse-server/lib/Adapters/Auth/spotify.js",statementMap:{"0":{start:{line:4,column:21},end:{line:4,column:46}},"1":{start:{line:6,column:12},end:{line:6,column:39}},"2":{start:{line:10,column:2},end:{line:16,column:5}},"3":{start:{line:11,column:4},end:{line:13,column:5}},"4":{start:{line:12,column:6},end:{line:12,column:13}},"5":{start:{line:15,column:4},end:{line:15,column:98}},"6":{start:{line:21,column:21},end:{line:21,column:42}},"7":{start:{line:23,column:2},end:{line:25,column:3}},"8":{start:{line:24,column:4},end:{line:24,column:91}},"9":{start:{line:27,column:2},end:{line:33,column:5}},"10":{start:{line:28,column:4},end:{line:30,column:5}},"11":{start:{line:29,column:6},end:{line:29,column:13}},"12":{start:{line:32,column:4},end:{line:32,column:98}},"13":{start:{line:38,column:2},end:{line:44,column:5}},"14":{start:{line:47,column:0},end:{line:50,column:2}}},fnMap:{"0":{name:"validateAuthData",decl:{start:{line:9,column:9},end:{line:9,column:25}},loc:{start:{line:9,column:36},end:{line:17,column:1}},line:9},"1":{name:"(anonymous_1)",decl:{start:{line:10,column:51},end:{line:10,column:52}},loc:{start:{line:10,column:59},end:{line:16,column:3}},line:10},"2":{name:"validateAppId",decl:{start:{line:20,column:9},end:{line:20,column:22}},loc:{start:{line:20,column:41},end:{line:34,column:1}},line:20},"3":{name:"(anonymous_3)",decl:{start:{line:27,column:42},end:{line:27,column:43}},loc:{start:{line:27,column:50},end:{line:33,column:3}},line:27},"4":{name:"request",decl:{start:{line:37,column:9},end:{line:37,column:16}},loc:{start:{line:37,column:37},end:{line:45,column:1}},line:37}},branchMap:{"0":{loc:{start:{line:11,column:4},end:{line:13,column:5}},type:"if",locations:[{start:{line:11,column:4},end:{line:13,column:5}},{start:{line:11,column:4},end:{line:13,column:5}}],line:11},"1":{loc:{start:{line:11,column:8},end:{line:11,column:38}},type:"binary-expr",locations:[{start:{line:11,column:8},end:{line:11,column:12}},{start:{line:11,column:16},end:{line:11,column:38}}],line:11},"2":{loc:{start:{line:23,column:2},end:{line:25,column:3}},type:"if",locations:[{start:{line:23,column:2},end:{line:25,column:3}},{start:{line:23,column:2},end:{line:25,column:3}}],line:23},"3":{loc:{start:{line:28,column:4},end:{line:30,column:5}},type:"if",locations:[{start:{line:28,column:4},end:{line:30,column:5}},{start:{line:28,column:4},end:{line:30,column:5}}],line:28},"4":{loc:{start:{line:28,column:8},end:{line:28,column:45}},type:"binary-expr",locations:[{start:{line:28,column:8},end:{line:28,column:12}},{start:{line:28,column:16},end:{line:28,column:45}}],line:28}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0]},inputSourceMap:{version:3,sources:["../../../src/Adapters/Auth/spotify.js"],names:["httpsRequest","require","Parse","validateAuthData","authData","request","access_token","then","data","id","Error","OBJECT_NOT_FOUND","validateAppId","appIds","length","indexOf","path","get","host","headers","Authorization","module","exports"],mappings:";;AAAA;AACA,MAAMA,YAAY,GAAGC,OAAO,CAAC,gBAAD,CAA5B;;AACA,IAAIC,KAAK,GAAGD,OAAO,CAAC,YAAD,CAAP,CAAsBC,KAAlC,C,CAEA;;;AACA,SAASC,gBAAT,CAA0BC,QAA1B,EAAoC;AAClC,SAAOC,OAAO,CAAC,IAAD,EAAOD,QAAQ,CAACE,YAAhB,CAAP,CAAqCC,IAArC,CAA0CC,IAAI,IAAI;AACvD,QAAIA,IAAI,IAAIA,IAAI,CAACC,EAAL,IAAWL,QAAQ,CAACK,EAAhC,EAAoC;AAClC;AACD;;AACD,UAAM,IAAIP,KAAK,CAACQ,KAAV,CAAgBR,KAAK,CAACQ,KAAN,CAAYC,gBAA5B,EAA8C,wCAA9C,CAAN;AACD,GALM,CAAP;AAMD,C,CAED;;;AACA,SAASC,aAAT,CAAuBC,MAAvB,EAA+BT,QAA/B,EAAyC;AACvC,MAAIE,YAAY,GAAGF,QAAQ,CAACE,YAA5B;;AACA,MAAI,CAACO,MAAM,CAACC,MAAZ,EAAoB;AAClB,UAAM,IAAIZ,KAAK,CAACQ,KAAV,CAAgBR,KAAK,CAACQ,KAAN,CAAYC,gBAA5B,EAA8C,iCAA9C,CAAN;AACD;;AACD,SAAON,OAAO,CAAC,IAAD,EAAOC,YAAP,CAAP,CAA4BC,IAA5B,CAAiCC,IAAI,IAAI;AAC9C,QAAIA,IAAI,IAAIK,MAAM,CAACE,OAAP,CAAeP,IAAI,CAACC,EAApB,KAA2B,CAAC,CAAxC,EAA2C;AACzC;AACD;;AACD,UAAM,IAAIP,KAAK,CAACQ,KAAV,CAAgBR,KAAK,CAACQ,KAAN,CAAYC,gBAA5B,EAA8C,wCAA9C,CAAN;AACD,GALM,CAAP;AAMD,C,CAED;;;AACA,SAASN,OAAT,CAAiBW,IAAjB,EAAuBV,YAAvB,EAAqC;AACnC,SAAON,YAAY,CAACiB,GAAb,CAAiB;AACtBC,IAAAA,IAAI,EAAE,iBADgB;AAEtBF,IAAAA,IAAI,EAAE,SAASA,IAFO;AAGtBG,IAAAA,OAAO,EAAE;AACPC,MAAAA,aAAa,EAAE,YAAYd;AADpB;AAHa,GAAjB,CAAP;AAOD;;AAEDe,MAAM,CAACC,OAAP,GAAiB;AACfV,EAAAA,aAAa,EAAEA,aADA;AAEfT,EAAAA,gBAAgB,EAAEA;AAFH,CAAjB",sourcesContent:["// Helper functions for accessing the Spotify API.\nconst httpsRequest = require('./httpsRequest');\nvar Parse = require('parse/node').Parse;\n\n// Returns a promise that fulfills iff this user id is valid.\nfunction validateAuthData(authData) {\n  return request('me', authData.access_token).then(data => {\n    if (data && data.id == authData.id) {\n      return;\n    }\n    throw new Parse.Error(Parse.Error.OBJECT_NOT_FOUND, 'Spotify auth is invalid for this user.');\n  });\n}\n\n// Returns a promise that fulfills if this app id is valid.\nfunction validateAppId(appIds, authData) {\n  var access_token = authData.access_token;\n  if (!appIds.length) {\n    throw new Parse.Error(Parse.Error.OBJECT_NOT_FOUND, 'Spotify auth is not configured.');\n  }\n  return request('me', access_token).then(data => {\n    if (data && appIds.indexOf(data.id) != -1) {\n      return;\n    }\n    throw new Parse.Error(Parse.Error.OBJECT_NOT_FOUND, 'Spotify auth is invalid for this user.');\n  });\n}\n\n// A promisey wrapper for Spotify API requests.\nfunction request(path, access_token) {\n  return httpsRequest.get({\n    host: 'api.spotify.com',\n    path: '/v1/' + path,\n    headers: {\n      Authorization: 'Bearer ' + access_token,\n    },\n  });\n}\n\nmodule.exports = {\n  validateAppId: validateAppId,\n  validateAuthData: validateAuthData,\n};\n"]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"3412e00a9e4061824d1ad94b7e84359c9fa1b527"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_xf23uqgkz=function(){return actualCoverage;};}return actualCoverage;}cov_xf23uqgkz();const httpsRequest=(cov_xf23uqgkz().s[0]++,require('./httpsRequest'));var Parse=(cov_xf23uqgkz().s[1]++,require('parse/node').Parse);// Returns a promise that fulfills iff this user id is valid.
function validateAuthData(authData){cov_xf23uqgkz().f[0]++;cov_xf23uqgkz().s[2]++;return request('me',authData.access_token).then(data=>{cov_xf23uqgkz().f[1]++;cov_xf23uqgkz().s[3]++;if((cov_xf23uqgkz().b[1][0]++,data)&&(cov_xf23uqgkz().b[1][1]++,data.id==authData.id)){cov_xf23uqgkz().b[0][0]++;cov_xf23uqgkz().s[4]++;return;}else{cov_xf23uqgkz().b[0][1]++;}cov_xf23uqgkz().s[5]++;throw new Parse.Error(Parse.Error.OBJECT_NOT_FOUND,'Spotify auth is invalid for this user.');});}// Returns a promise that fulfills if this app id is valid.
function validateAppId(appIds,authData){cov_xf23uqgkz().f[2]++;var access_token=(cov_xf23uqgkz().s[6]++,authData.access_token);cov_xf23uqgkz().s[7]++;if(!appIds.length){cov_xf23uqgkz().b[2][0]++;cov_xf23uqgkz().s[8]++;throw new Parse.Error(Parse.Error.OBJECT_NOT_FOUND,'Spotify auth is not configured.');}else{cov_xf23uqgkz().b[2][1]++;}cov_xf23uqgkz().s[9]++;return request('me',access_token).then(data=>{cov_xf23uqgkz().f[3]++;cov_xf23uqgkz().s[10]++;if((cov_xf23uqgkz().b[4][0]++,data)&&(cov_xf23uqgkz().b[4][1]++,appIds.indexOf(data.id)!=-1)){cov_xf23uqgkz().b[3][0]++;cov_xf23uqgkz().s[11]++;return;}else{cov_xf23uqgkz().b[3][1]++;}cov_xf23uqgkz().s[12]++;throw new Parse.Error(Parse.Error.OBJECT_NOT_FOUND,'Spotify auth is invalid for this user.');});}// A promisey wrapper for Spotify API requests.
function request(path,access_token){cov_xf23uqgkz().f[4]++;cov_xf23uqgkz().s[13]++;return httpsRequest.get({host:'api.spotify.com',path:'/v1/'+path,headers:{Authorization:'Bearer '+access_token}});}cov_xf23uqgkz().s[14]++;module.exports={validateAppId:validateAppId,validateAuthData:validateAuthData};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9BZGFwdGVycy9BdXRoL3Nwb3RpZnkuanMiXSwibmFtZXMiOlsiaHR0cHNSZXF1ZXN0IiwicmVxdWlyZSIsIlBhcnNlIiwidmFsaWRhdGVBdXRoRGF0YSIsImF1dGhEYXRhIiwicmVxdWVzdCIsImFjY2Vzc190b2tlbiIsInRoZW4iLCJkYXRhIiwiaWQiLCJFcnJvciIsIk9CSkVDVF9OT1RfRk9VTkQiLCJ2YWxpZGF0ZUFwcElkIiwiYXBwSWRzIiwibGVuZ3RoIiwiaW5kZXhPZiIsInBhdGgiLCJnZXQiLCJob3N0IiwiaGVhZGVycyIsIkF1dGhvcml6YXRpb24iLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOztBQUFBO0FBQ0EsTUFBTUEsWUFBWSxHQUFHQyxPQUFPLENBQUMsZ0JBQUQsQ0FBNUI7O0FBQ0EsSUFBSUMsS0FBSyxHQUFHRCxPQUFPLENBQUMsWUFBRCxDQUFQLENBQXNCQyxLQUFsQyxDLENBRUE7OztBQUNBLFNBQVNDLGdCQUFULENBQTBCQyxRQUExQixFQUFvQztBQUNsQyxTQUFPQyxPQUFPLENBQUMsSUFBRCxFQUFPRCxRQUFRLENBQUNFLFlBQWhCLENBQVAsQ0FBcUNDLElBQXJDLENBQTBDQyxJQUFJLElBQUk7QUFDdkQsUUFBSUEsSUFBSSxJQUFJQSxJQUFJLENBQUNDLEVBQUwsSUFBV0wsUUFBUSxDQUFDSyxFQUFoQyxFQUFvQztBQUNsQztBQUNEOztBQUNELFVBQU0sSUFBSVAsS0FBSyxDQUFDUSxLQUFWLENBQWdCUixLQUFLLENBQUNRLEtBQU4sQ0FBWUMsZ0JBQTVCLEVBQThDLHdDQUE5QyxDQUFOO0FBQ0QsR0FMTSxDQUFQO0FBTUQsQyxDQUVEOzs7QUFDQSxTQUFTQyxhQUFULENBQXVCQyxNQUF2QixFQUErQlQsUUFBL0IsRUFBeUM7QUFDdkMsTUFBSUUsWUFBWSxHQUFHRixRQUFRLENBQUNFLFlBQTVCOztBQUNBLE1BQUksQ0FBQ08sTUFBTSxDQUFDQyxNQUFaLEVBQW9CO0FBQ2xCLFVBQU0sSUFBSVosS0FBSyxDQUFDUSxLQUFWLENBQWdCUixLQUFLLENBQUNRLEtBQU4sQ0FBWUMsZ0JBQTVCLEVBQThDLGlDQUE5QyxDQUFOO0FBQ0Q7O0FBQ0QsU0FBT04sT0FBTyxDQUFDLElBQUQsRUFBT0MsWUFBUCxDQUFQLENBQTRCQyxJQUE1QixDQUFpQ0MsSUFBSSxJQUFJO0FBQzlDLFFBQUlBLElBQUksSUFBSUssTUFBTSxDQUFDRSxPQUFQLENBQWVQLElBQUksQ0FBQ0MsRUFBcEIsS0FBMkIsQ0FBQyxDQUF4QyxFQUEyQztBQUN6QztBQUNEOztBQUNELFVBQU0sSUFBSVAsS0FBSyxDQUFDUSxLQUFWLENBQWdCUixLQUFLLENBQUNRLEtBQU4sQ0FBWUMsZ0JBQTVCLEVBQThDLHdDQUE5QyxDQUFOO0FBQ0QsR0FMTSxDQUFQO0FBTUQsQyxDQUVEOzs7QUFDQSxTQUFTTixPQUFULENBQWlCVyxJQUFqQixFQUF1QlYsWUFBdkIsRUFBcUM7QUFDbkMsU0FBT04sWUFBWSxDQUFDaUIsR0FBYixDQUFpQjtBQUN0QkMsSUFBQUEsSUFBSSxFQUFFLGlCQURnQjtBQUV0QkYsSUFBQUEsSUFBSSxFQUFFLFNBQVNBLElBRk87QUFHdEJHLElBQUFBLE9BQU8sRUFBRTtBQUNQQyxNQUFBQSxhQUFhLEVBQUUsWUFBWWQ7QUFEcEI7QUFIYSxHQUFqQixDQUFQO0FBT0Q7O0FBRURlLE1BQU0sQ0FBQ0MsT0FBUCxHQUFpQjtBQUNmVixFQUFBQSxhQUFhLEVBQUVBLGFBREE7QUFFZlQsRUFBQUEsZ0JBQWdCLEVBQUVBO0FBRkgsQ0FBakIiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBIZWxwZXIgZnVuY3Rpb25zIGZvciBhY2Nlc3NpbmcgdGhlIFNwb3RpZnkgQVBJLlxuY29uc3QgaHR0cHNSZXF1ZXN0ID0gcmVxdWlyZSgnLi9odHRwc1JlcXVlc3QnKTtcbnZhciBQYXJzZSA9IHJlcXVpcmUoJ3BhcnNlL25vZGUnKS5QYXJzZTtcblxuLy8gUmV0dXJucyBhIHByb21pc2UgdGhhdCBmdWxmaWxscyBpZmYgdGhpcyB1c2VyIGlkIGlzIHZhbGlkLlxuZnVuY3Rpb24gdmFsaWRhdGVBdXRoRGF0YShhdXRoRGF0YSkge1xuICByZXR1cm4gcmVxdWVzdCgnbWUnLCBhdXRoRGF0YS5hY2Nlc3NfdG9rZW4pLnRoZW4oZGF0YSA9PiB7XG4gICAgaWYgKGRhdGEgJiYgZGF0YS5pZCA9PSBhdXRoRGF0YS5pZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aHJvdyBuZXcgUGFyc2UuRXJyb3IoUGFyc2UuRXJyb3IuT0JKRUNUX05PVF9GT1VORCwgJ1Nwb3RpZnkgYXV0aCBpcyBpbnZhbGlkIGZvciB0aGlzIHVzZXIuJyk7XG4gIH0pO1xufVxuXG4vLyBSZXR1cm5zIGEgcHJvbWlzZSB0aGF0IGZ1bGZpbGxzIGlmIHRoaXMgYXBwIGlkIGlzIHZhbGlkLlxuZnVuY3Rpb24gdmFsaWRhdGVBcHBJZChhcHBJZHMsIGF1dGhEYXRhKSB7XG4gIHZhciBhY2Nlc3NfdG9rZW4gPSBhdXRoRGF0YS5hY2Nlc3NfdG9rZW47XG4gIGlmICghYXBwSWRzLmxlbmd0aCkge1xuICAgIHRocm93IG5ldyBQYXJzZS5FcnJvcihQYXJzZS5FcnJvci5PQkpFQ1RfTk9UX0ZPVU5ELCAnU3BvdGlmeSBhdXRoIGlzIG5vdCBjb25maWd1cmVkLicpO1xuICB9XG4gIHJldHVybiByZXF1ZXN0KCdtZScsIGFjY2Vzc190b2tlbikudGhlbihkYXRhID0+IHtcbiAgICBpZiAoZGF0YSAmJiBhcHBJZHMuaW5kZXhPZihkYXRhLmlkKSAhPSAtMSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aHJvdyBuZXcgUGFyc2UuRXJyb3IoUGFyc2UuRXJyb3IuT0JKRUNUX05PVF9GT1VORCwgJ1Nwb3RpZnkgYXV0aCBpcyBpbnZhbGlkIGZvciB0aGlzIHVzZXIuJyk7XG4gIH0pO1xufVxuXG4vLyBBIHByb21pc2V5IHdyYXBwZXIgZm9yIFNwb3RpZnkgQVBJIHJlcXVlc3RzLlxuZnVuY3Rpb24gcmVxdWVzdChwYXRoLCBhY2Nlc3NfdG9rZW4pIHtcbiAgcmV0dXJuIGh0dHBzUmVxdWVzdC5nZXQoe1xuICAgIGhvc3Q6ICdhcGkuc3BvdGlmeS5jb20nLFxuICAgIHBhdGg6ICcvdjEvJyArIHBhdGgsXG4gICAgaGVhZGVyczoge1xuICAgICAgQXV0aG9yaXphdGlvbjogJ0JlYXJlciAnICsgYWNjZXNzX3Rva2VuLFxuICAgIH0sXG4gIH0pO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgdmFsaWRhdGVBcHBJZDogdmFsaWRhdGVBcHBJZCxcbiAgdmFsaWRhdGVBdXRoRGF0YTogdmFsaWRhdGVBdXRoRGF0YSxcbn07XG4iXX0=
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9BZGFwdGVycy9BdXRoL3Nwb3RpZnkuanMiXSwibmFtZXMiOlsiaHR0cHNSZXF1ZXN0IiwicmVxdWlyZSIsIlBhcnNlIiwiYXV0aERhdGEiLCJkYXRhIiwiYWNjZXNzX3Rva2VuIiwiYXBwSWRzIiwiaG9zdCIsInBhdGgiLCJoZWFkZXJzIiwiQXV0aG9yaXphdGlvbiIsIm1vZHVsZSIsInZhbGlkYXRlQXBwSWQiLCJ2YWxpZGF0ZUF1dGhEYXRhIl0sIm1hcHBpbmdzIjoiYUFBQTswbE1BTUU7eUZBTEYsS0FBTUEsQ0FBQUEsWUFBWSx5QkFBR0MsT0FBTyxDQUE1QixnQkFBNEIsQ0FBVixDQUFsQixDQUNBLEdBQUlDLENBQUFBLEtBQUsseUJBQUdELE9BQU8sQ0FBUEEsWUFBTyxDQUFQQSxDQUFaLEtBQVMsQ0FBVCxDQUVBO0FBQ0EsUUFBQSxDQUFBLGdCQUFBLENBQUEsUUFBQSxDQUFvQywrQ0FDbEMsTUFBTyxDQUFBLE9BQU8sQ0FBQSxJQUFBLENBQU9FLFFBQVEsQ0FBdEIsWUFBTyxDQUFQLENBQUEsSUFBQSxDQUEwQ0MsSUFBSSxFQUFJLCtDQUN2RCxHQUFJQSwyQkFBQUEsSUFBSSw4QkFBSUEsSUFBSSxDQUFKQSxFQUFBQSxFQUFXRCxRQUFRLENBQS9CLEVBQVEsQ0FBUixDQUFvQyxrREFDbEMsT0FDRCxDQUZELGdDQUR1RCx1QkFJdkQsS0FBTSxJQUFJRCxDQUFBQSxLQUFLLENBQVQsS0FBQSxDQUFnQkEsS0FBSyxDQUFMQSxLQUFBQSxDQUFoQixnQkFBQSxDQUFOLHdDQUFNLENBQU4sQ0FKRixDQUFPLENBQVAsQyxDQVFGO0FBQ0EsUUFBQSxDQUFBLGFBQUEsQ0FBQSxNQUFBLENBQUEsUUFBQSxDQUF5Qyx3QkFDdkMsR0FBSUcsQ0FBQUEsWUFBWSx5QkFBR0YsUUFBUSxDQUEzQixZQUFnQixDQUFoQixDQUR1Qyx1QkFFdkMsR0FBSSxDQUFDRyxNQUFNLENBQVgsTUFBQSxDQUFvQixrREFDbEIsS0FBTSxJQUFJSixDQUFBQSxLQUFLLENBQVQsS0FBQSxDQUFnQkEsS0FBSyxDQUFMQSxLQUFBQSxDQUFoQixnQkFBQSxDQUFOLGlDQUFNLENBQU4sQ0FDRCxDQUZELGdDQUZ1Qyx1QkFLdkMsTUFBTyxDQUFBLE9BQU8sQ0FBQSxJQUFBLENBQVAsWUFBTyxDQUFQLENBQUEsSUFBQSxDQUFpQ0UsSUFBSSxFQUFJLGdEQUM5QyxHQUFJQSwyQkFBQUEsSUFBSSw4QkFBSUUsTUFBTSxDQUFOQSxPQUFBQSxDQUFlRixJQUFJLENBQW5CRSxFQUFBQSxHQUEyQixDQUF2QyxDQUFRLENBQVIsQ0FBMkMsbURBQ3pDLE9BQ0QsQ0FGRCxnQ0FEOEMsd0JBSTlDLEtBQU0sSUFBSUosQ0FBQUEsS0FBSyxDQUFULEtBQUEsQ0FBZ0JBLEtBQUssQ0FBTEEsS0FBQUEsQ0FBaEIsZ0JBQUEsQ0FBTix3Q0FBTSxDQUFOLENBSkYsQ0FBTyxDQUFQLEMsQ0FRRjtBQUNBLFFBQUEsQ0FBQSxPQUFBLENBQUEsSUFBQSxDQUFBLFlBQUEsQ0FBcUMsZ0RBQ25DLE1BQU8sQ0FBQSxZQUFZLENBQVosR0FBQSxDQUFpQixDQUN0QkssSUFBSSxDQURrQixpQkFBQSxDQUV0QkMsSUFBSSxDQUFFLE9BRmdCLElBQUEsQ0FHdEJDLE9BQU8sQ0FBRSxDQUNQQyxhQUFhLENBQUUsVUFBWUwsWUFEcEIsQ0FIYSxDQUFqQixDQUFQLENBT0QsQyx3QkFFRE0sTUFBTSxDQUFOQSxPQUFBQSxDQUFpQixDQUNmQyxhQUFhLENBREUsYUFBQSxDQUVmQyxnQkFBZ0IsQ0FBRUEsZ0JBRkgsQ0FBakJGLEMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBIZWxwZXIgZnVuY3Rpb25zIGZvciBhY2Nlc3NpbmcgdGhlIFNwb3RpZnkgQVBJLlxuY29uc3QgaHR0cHNSZXF1ZXN0ID0gcmVxdWlyZSgnLi9odHRwc1JlcXVlc3QnKTtcbnZhciBQYXJzZSA9IHJlcXVpcmUoJ3BhcnNlL25vZGUnKS5QYXJzZTtcblxuLy8gUmV0dXJucyBhIHByb21pc2UgdGhhdCBmdWxmaWxscyBpZmYgdGhpcyB1c2VyIGlkIGlzIHZhbGlkLlxuZnVuY3Rpb24gdmFsaWRhdGVBdXRoRGF0YShhdXRoRGF0YSkge1xuICByZXR1cm4gcmVxdWVzdCgnbWUnLCBhdXRoRGF0YS5hY2Nlc3NfdG9rZW4pLnRoZW4oZGF0YSA9PiB7XG4gICAgaWYgKGRhdGEgJiYgZGF0YS5pZCA9PSBhdXRoRGF0YS5pZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aHJvdyBuZXcgUGFyc2UuRXJyb3IoUGFyc2UuRXJyb3IuT0JKRUNUX05PVF9GT1VORCwgJ1Nwb3RpZnkgYXV0aCBpcyBpbnZhbGlkIGZvciB0aGlzIHVzZXIuJyk7XG4gIH0pO1xufVxuXG4vLyBSZXR1cm5zIGEgcHJvbWlzZSB0aGF0IGZ1bGZpbGxzIGlmIHRoaXMgYXBwIGlkIGlzIHZhbGlkLlxuZnVuY3Rpb24gdmFsaWRhdGVBcHBJZChhcHBJZHMsIGF1dGhEYXRhKSB7XG4gIHZhciBhY2Nlc3NfdG9rZW4gPSBhdXRoRGF0YS5hY2Nlc3NfdG9rZW47XG4gIGlmICghYXBwSWRzLmxlbmd0aCkge1xuICAgIHRocm93IG5ldyBQYXJzZS5FcnJvcihQYXJzZS5FcnJvci5PQkpFQ1RfTk9UX0ZPVU5ELCAnU3BvdGlmeSBhdXRoIGlzIG5vdCBjb25maWd1cmVkLicpO1xuICB9XG4gIHJldHVybiByZXF1ZXN0KCdtZScsIGFjY2Vzc190b2tlbikudGhlbihkYXRhID0+IHtcbiAgICBpZiAoZGF0YSAmJiBhcHBJZHMuaW5kZXhPZihkYXRhLmlkKSAhPSAtMSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aHJvdyBuZXcgUGFyc2UuRXJyb3IoUGFyc2UuRXJyb3IuT0JKRUNUX05PVF9GT1VORCwgJ1Nwb3RpZnkgYXV0aCBpcyBpbnZhbGlkIGZvciB0aGlzIHVzZXIuJyk7XG4gIH0pO1xufVxuXG4vLyBBIHByb21pc2V5IHdyYXBwZXIgZm9yIFNwb3RpZnkgQVBJIHJlcXVlc3RzLlxuZnVuY3Rpb24gcmVxdWVzdChwYXRoLCBhY2Nlc3NfdG9rZW4pIHtcbiAgcmV0dXJuIGh0dHBzUmVxdWVzdC5nZXQoe1xuICAgIGhvc3Q6ICdhcGkuc3BvdGlmeS5jb20nLFxuICAgIHBhdGg6ICcvdjEvJyArIHBhdGgsXG4gICAgaGVhZGVyczoge1xuICAgICAgQXV0aG9yaXphdGlvbjogJ0JlYXJlciAnICsgYWNjZXNzX3Rva2VuLFxuICAgIH0sXG4gIH0pO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgdmFsaWRhdGVBcHBJZDogdmFsaWRhdGVBcHBJZCxcbiAgdmFsaWRhdGVBdXRoRGF0YTogdmFsaWRhdGVBdXRoRGF0YSxcbn07XG4iXX0=