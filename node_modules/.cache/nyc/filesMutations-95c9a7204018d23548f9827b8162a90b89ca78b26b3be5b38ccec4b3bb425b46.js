"use strict";function cov_2g080izq9n(){var path="/parse-server/lib/GraphQL/loaders/filesMutations.js";var hash="e286490f5b784a9fcf543ba88306def3d9fc92c1";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/parse-server/lib/GraphQL/loaders/filesMutations.js",statementMap:{"0":{start:{line:3,column:0},end:{line:5,column:3}},"1":{start:{line:6,column:0},end:{line:6,column:45}},"2":{start:{line:8,column:15},end:{line:8,column:33}},"3":{start:{line:10,column:20},end:{line:10,column:44}},"4":{start:{line:12,column:13},end:{line:12,column:44}},"5":{start:{line:14,column:12},end:{line:14,column:57}},"6":{start:{line:16,column:26},end:{line:16,column:83}},"7":{start:{line:18,column:14},end:{line:18,column:61}},"8":{start:{line:20,column:49},end:{line:20,column:96}},"9":{start:{line:20,column:84},end:{line:20,column:96}},"10":{start:{line:20,column:121},end:{line:20,column:134}},"11":{start:{line:20,column:159},end:{line:20,column:172}},"12":{start:{line:20,column:174},end:{line:20,column:309}},"13":{start:{line:20,column:234},end:{line:20,column:292}},"14":{start:{line:22,column:53},end:{line:22,column:111}},"15":{start:{line:22,column:98},end:{line:22,column:109}},"16":{start:{line:22,column:112},end:{line:22,column:214}},"17":{start:{line:22,column:188},end:{line:22,column:212}},"18":{start:{line:22,column:227},end:{line:22,column:264}},"19":{start:{line:22,column:266},end:{line:22,column:321}},"20":{start:{line:22,column:297},end:{line:22,column:319}},"21":{start:{line:22,column:335},end:{line:22,column:337}},"22":{start:{line:22,column:367},end:{line:22,column:423}},"23":{start:{line:22,column:425},end:{line:22,column:726}},"24":{start:{line:22,column:448},end:{line:22,column:724}},"25":{start:{line:22,column:534},end:{line:22,column:606}},"26":{start:{line:22,column:608},end:{line:22,column:722}},"27":{start:{line:22,column:646},end:{line:22,column:687}},"28":{start:{line:22,column:697},end:{line:22,column:720}},"29":{start:{line:22,column:727},end:{line:22,column:748}},"30":{start:{line:22,column:749},end:{line:22,column:787}},"31":{start:{line:22,column:762},end:{line:22,column:785}},"32":{start:{line:22,column:788},end:{line:22,column:802}},"33":{start:{line:24,column:39},end:{line:24,column:93}},"34":{start:{line:26,column:21},end:{line:63,column:1}},"35":{start:{line:31,column:6},end:{line:31,column:18}},"36":{start:{line:32,column:13},end:{line:32,column:17}},"37":{start:{line:34,column:2},end:{line:40,column:3}},"38":{start:{line:35,column:19},end:{line:35,column:37}},"39":{start:{line:36,column:4},end:{line:39,column:7}},"40":{start:{line:37,column:21},end:{line:37,column:23}},"41":{start:{line:38,column:6},end:{line:38,column:121}},"42":{start:{line:38,column:53},end:{line:38,column:71}},"43":{start:{line:38,column:89},end:{line:38,column:119}},"44":{start:{line:42,column:2},end:{line:44,column:3}},"45":{start:{line:43,column:4},end:{line:43,column:95}},"46":{start:{line:46,column:2},end:{line:48,column:3}},"47":{start:{line:47,column:4},end:{line:47,column:95}},"48":{start:{line:50,column:2},end:{line:52,column:3}},"49":{start:{line:51,column:4},end:{line:51,column:114}},"50":{start:{line:54,column:2},end:{line:62,column:3}},"51":{start:{line:55,column:4},end:{line:57,column:6}},"52":{start:{line:59,column:4},end:{line:59,column:56}},"53":{start:{line:61,column:4},end:{line:61,column:109}},"54":{start:{line:65,column:0},end:{line:65,column:36}},"55":{start:{line:67,column:13},end:{line:100,column:1}},"56":{start:{line:68,column:25},end:{line:96,column:4}},"57":{start:{line:84,column:6},end:{line:94,column:7}},"58":{start:{line:87,column:12},end:{line:87,column:16}},"59":{start:{line:90,column:12},end:{line:90,column:19}},"60":{start:{line:91,column:8},end:{line:91,column:44}},"61":{start:{line:93,column:8},end:{line:93,column:42}},"62":{start:{line:97,column:2},end:{line:97,column:87}},"63":{start:{line:98,column:2},end:{line:98,column:69}},"64":{start:{line:99,column:2},end:{line:99,column:82}},"65":{start:{line:102,column:0},end:{line:102,column:20}}},fnMap:{"0":{name:"_getRequireWildcardCache",decl:{start:{line:20,column:9},end:{line:20,column:33}},loc:{start:{line:20,column:47},end:{line:20,column:311}},line:20},"1":{name:"(anonymous_1)",decl:{start:{line:20,column:209},end:{line:20,column:210}},loc:{start:{line:20,column:232},end:{line:20,column:294}},line:20},"2":{name:"_interopRequireWildcard",decl:{start:{line:22,column:9},end:{line:22,column:32}},loc:{start:{line:22,column:51},end:{line:22,column:804}},line:22},"3":{name:"_interopRequireDefault",decl:{start:{line:24,column:9},end:{line:24,column:31}},loc:{start:{line:24,column:37},end:{line:24,column:95}},line:24},"4":{name:"(anonymous_4)",decl:{start:{line:26,column:21},end:{line:26,column:22}},loc:{start:{line:26,column:47},end:{line:63,column:1}},line:26},"5":{name:"(anonymous_5)",decl:{start:{line:36,column:29},end:{line:36,column:30}},loc:{start:{line:36,column:50},end:{line:39,column:5}},line:36},"6":{name:"(anonymous_6)",decl:{start:{line:38,column:44},end:{line:38,column:45}},loc:{start:{line:38,column:53},end:{line:38,column:71}},line:38},"7":{name:"(anonymous_7)",decl:{start:{line:38,column:83},end:{line:38,column:84}},loc:{start:{line:38,column:89},end:{line:38,column:119}},line:38},"8":{name:"(anonymous_8)",decl:{start:{line:67,column:13},end:{line:67,column:14}},loc:{start:{line:67,column:35},end:{line:100,column:1}},line:67},"9":{name:"(anonymous_9)",decl:{start:{line:83,column:25},end:{line:83,column:26}},loc:{start:{line:83,column:50},end:{line:95,column:5}},line:83}},branchMap:{"0":{loc:{start:{line:20,column:49},end:{line:20,column:96}},type:"if",locations:[{start:{line:20,column:49},end:{line:20,column:96}},{start:{line:20,column:49},end:{line:20,column:96}}],line:20},"1":{loc:{start:{line:20,column:241},end:{line:20,column:291}},type:"cond-expr",locations:[{start:{line:20,column:255},end:{line:20,column:271}},{start:{line:20,column:274},end:{line:20,column:291}}],line:20},"2":{loc:{start:{line:22,column:53},end:{line:22,column:111}},type:"if",locations:[{start:{line:22,column:53},end:{line:22,column:111}},{start:{line:22,column:53},end:{line:22,column:111}}],line:22},"3":{loc:{start:{line:22,column:57},end:{line:22,column:94}},type:"binary-expr",locations:[{start:{line:22,column:57},end:{line:22,column:69}},{start:{line:22,column:73},end:{line:22,column:76}},{start:{line:22,column:80},end:{line:22,column:94}}],line:22},"4":{loc:{start:{line:22,column:112},end:{line:22,column:214}},type:"if",locations:[{start:{line:22,column:112},end:{line:22,column:214}},{start:{line:22,column:112},end:{line:22,column:214}}],line:22},"5":{loc:{start:{line:22,column:116},end:{line:22,column:184}},type:"binary-expr",locations:[{start:{line:22,column:116},end:{line:22,column:128}},{start:{line:22,column:132},end:{line:22,column:155}},{start:{line:22,column:159},end:{line:22,column:184}}],line:22},"6":{loc:{start:{line:22,column:266},end:{line:22,column:321}},type:"if",locations:[{start:{line:22,column:266},end:{line:22,column:321}},{start:{line:22,column:266},end:{line:22,column:321}}],line:22},"7":{loc:{start:{line:22,column:270},end:{line:22,column:293}},type:"binary-expr",locations:[{start:{line:22,column:270},end:{line:22,column:275}},{start:{line:22,column:279},end:{line:22,column:293}}],line:22},"8":{loc:{start:{line:22,column:367},end:{line:22,column:423}},type:"binary-expr",locations:[{start:{line:22,column:367},end:{line:22,column:388}},{start:{line:22,column:392},end:{line:22,column:423}}],line:22},"9":{loc:{start:{line:22,column:448},end:{line:22,column:724}},type:"if",locations:[{start:{line:22,column:448},end:{line:22,column:724}},{start:{line:22,column:448},end:{line:22,column:724}}],line:22},"10":{loc:{start:{line:22,column:452},end:{line:22,column:519}},type:"binary-expr",locations:[{start:{line:22,column:452},end:{line:22,column:469}},{start:{line:22,column:473},end:{line:22,column:519}}],line:22},"11":{loc:{start:{line:22,column:534},end:{line:22,column:606}},type:"cond-expr",locations:[{start:{line:22,column:558},end:{line:22,column:599}},{start:{line:22,column:602},end:{line:22,column:606}}],line:22},"12":{loc:{start:{line:22,column:608},end:{line:22,column:722}},type:"if",locations:[{start:{line:22,column:608},end:{line:22,column:722}},{start:{line:22,column:608},end:{line:22,column:722}}],line:22},"13":{loc:{start:{line:22,column:612},end:{line:22,column:642}},type:"binary-expr",locations:[{start:{line:22,column:612},end:{line:22,column:616}},{start:{line:22,column:621},end:{line:22,column:629}},{start:{line:22,column:633},end:{line:22,column:641}}],line:22},"14":{loc:{start:{line:22,column:749},end:{line:22,column:787}},type:"if",locations:[{start:{line:22,column:749},end:{line:22,column:787}},{start:{line:22,column:749},end:{line:22,column:787}}],line:22},"15":{loc:{start:{line:24,column:46},end:{line:24,column:92}},type:"cond-expr",locations:[{start:{line:24,column:70},end:{line:24,column:73}},{start:{line:24,column:76},end:{line:24,column:92}}],line:24},"16":{loc:{start:{line:24,column:46},end:{line:24,column:67}},type:"binary-expr",locations:[{start:{line:24,column:46},end:{line:24,column:49}},{start:{line:24,column:53},end:{line:24,column:67}}],line:24},"17":{loc:{start:{line:34,column:2},end:{line:40,column:3}},type:"if",locations:[{start:{line:34,column:2},end:{line:40,column:3}},{start:{line:34,column:2},end:{line:40,column:3}}],line:34},"18":{loc:{start:{line:42,column:2},end:{line:44,column:3}},type:"if",locations:[{start:{line:42,column:2},end:{line:44,column:3}},{start:{line:42,column:2},end:{line:44,column:3}}],line:42},"19":{loc:{start:{line:42,column:6},end:{line:42,column:27}},type:"binary-expr",locations:[{start:{line:42,column:6},end:{line:42,column:11}},{start:{line:42,column:15},end:{line:42,column:27}}],line:42},"20":{loc:{start:{line:46,column:2},end:{line:48,column:3}},type:"if",locations:[{start:{line:46,column:2},end:{line:48,column:3}},{start:{line:46,column:2},end:{line:48,column:3}}],line:46},"21":{loc:{start:{line:50,column:2},end:{line:52,column:3}},type:"if",locations:[{start:{line:50,column:2},end:{line:52,column:3}},{start:{line:50,column:2},end:{line:52,column:3}}],line:50}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0,0],"4":[0,0],"5":[0,0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0]},inputSourceMap:{version:3,sources:["../../../src/GraphQL/loaders/filesMutations.js"],names:["handleUpload","upload","config","createReadStream","filename","mimetype","data","stream","Promise","resolve","reject","chunks","on","chunk","push","Buffer","concat","length","Parse","Error","FILE_SAVE_ERROR","INVALID_FILE_NAME","match","fileInfo","filesController","createFile","e","logger","error","load","parseGraphQLSchema","createMutation","name","description","inputFields","type","GraphQLNonNull","GraphQLUpload","outputFields","defaultGraphQLTypes","FILE_INFO","mutateAndGetPayload","args","context","handleError","addGraphQLType","input","ofType","addGraphQLMutation"],mappings:"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",sourcesContent:["import { GraphQLNonNull } from 'graphql';\nimport { mutationWithClientMutationId } from 'graphql-relay';\nimport { GraphQLUpload } from '@graphql-tools/links';\nimport Parse from 'parse/node';\nimport * as defaultGraphQLTypes from './defaultGraphQLTypes';\nimport logger from '../../logger';\n\nconst handleUpload = async (upload, config) => {\n  const { createReadStream, filename, mimetype } = await upload;\n  let data = null;\n  if (createReadStream) {\n    const stream = createReadStream();\n    data = await new Promise((resolve, reject) => {\n      const chunks = [];\n      stream\n        .on('error', reject)\n        .on('data', chunk => chunks.push(chunk))\n        .on('end', () => resolve(Buffer.concat(chunks)));\n    });\n  }\n\n  if (!data || !data.length) {\n    throw new Parse.Error(Parse.Error.FILE_SAVE_ERROR, 'Invalid file upload.');\n  }\n\n  if (filename.length > 128) {\n    throw new Parse.Error(Parse.Error.INVALID_FILE_NAME, 'Filename too long.');\n  }\n\n  if (!filename.match(/^[_a-zA-Z0-9][a-zA-Z0-9@\\.\\ ~_-]*$/)) {\n    throw new Parse.Error(Parse.Error.INVALID_FILE_NAME, 'Filename contains invalid characters.');\n  }\n\n  try {\n    return {\n      fileInfo: await config.filesController.createFile(config, filename, data, mimetype),\n    };\n  } catch (e) {\n    logger.error('Error creating a file: ', e);\n    throw new Parse.Error(Parse.Error.FILE_SAVE_ERROR, `Could not store file: ${filename}.`);\n  }\n};\n\nconst load = parseGraphQLSchema => {\n  const createMutation = mutationWithClientMutationId({\n    name: 'CreateFile',\n    description: 'The createFile mutation can be used to create and upload a new file.',\n    inputFields: {\n      upload: {\n        description: 'This is the new file to be created and uploaded.',\n        type: new GraphQLNonNull(GraphQLUpload),\n      },\n    },\n    outputFields: {\n      fileInfo: {\n        description: 'This is the created file info.',\n        type: new GraphQLNonNull(defaultGraphQLTypes.FILE_INFO),\n      },\n    },\n    mutateAndGetPayload: async (args, context) => {\n      try {\n        const { upload } = args;\n        const { config } = context;\n        return handleUpload(upload, config);\n      } catch (e) {\n        parseGraphQLSchema.handleError(e);\n      }\n    },\n  });\n\n  parseGraphQLSchema.addGraphQLType(createMutation.args.input.type.ofType, true, true);\n  parseGraphQLSchema.addGraphQLType(createMutation.type, true, true);\n  parseGraphQLSchema.addGraphQLMutation('createFile', createMutation, true, true);\n};\n\nexport { load, handleUpload };\n"]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"e286490f5b784a9fcf543ba88306def3d9fc92c1"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_2g080izq9n=function(){return actualCoverage;};}return actualCoverage;}cov_2g080izq9n();cov_2g080izq9n().s[0]++;Object.defineProperty(exports,"__esModule",{value:true});cov_2g080izq9n().s[1]++;exports.handleUpload=exports.load=void 0;var _graphql=(cov_2g080izq9n().s[2]++,require("graphql"));var _graphqlRelay=(cov_2g080izq9n().s[3]++,require("graphql-relay"));var _links=(cov_2g080izq9n().s[4]++,require("@graphql-tools/links"));var _node=(cov_2g080izq9n().s[5]++,_interopRequireDefault(require("parse/node")));var defaultGraphQLTypes=(cov_2g080izq9n().s[6]++,_interopRequireWildcard(require("./defaultGraphQLTypes")));var _logger=(cov_2g080izq9n().s[7]++,_interopRequireDefault(require("../../logger")));function _getRequireWildcardCache(nodeInterop){cov_2g080izq9n().f[0]++;cov_2g080izq9n().s[8]++;if(typeof WeakMap!=="function"){cov_2g080izq9n().b[0][0]++;cov_2g080izq9n().s[9]++;return null;}else{cov_2g080izq9n().b[0][1]++;}var cacheBabelInterop=(cov_2g080izq9n().s[10]++,new WeakMap());var cacheNodeInterop=(cov_2g080izq9n().s[11]++,new WeakMap());cov_2g080izq9n().s[12]++;return(_getRequireWildcardCache=function(nodeInterop){cov_2g080izq9n().f[1]++;cov_2g080izq9n().s[13]++;return nodeInterop?(cov_2g080izq9n().b[1][0]++,cacheNodeInterop):(cov_2g080izq9n().b[1][1]++,cacheBabelInterop);})(nodeInterop);}function _interopRequireWildcard(obj,nodeInterop){cov_2g080izq9n().f[2]++;cov_2g080izq9n().s[14]++;if((cov_2g080izq9n().b[3][0]++,!nodeInterop)&&(cov_2g080izq9n().b[3][1]++,obj)&&(cov_2g080izq9n().b[3][2]++,obj.__esModule)){cov_2g080izq9n().b[2][0]++;cov_2g080izq9n().s[15]++;return obj;}else{cov_2g080izq9n().b[2][1]++;}cov_2g080izq9n().s[16]++;if((cov_2g080izq9n().b[5][0]++,obj===null)||(cov_2g080izq9n().b[5][1]++,typeof obj!=="object")&&(cov_2g080izq9n().b[5][2]++,typeof obj!=="function")){cov_2g080izq9n().b[4][0]++;cov_2g080izq9n().s[17]++;return{default:obj};}else{cov_2g080izq9n().b[4][1]++;}var cache=(cov_2g080izq9n().s[18]++,_getRequireWildcardCache(nodeInterop));cov_2g080izq9n().s[19]++;if((cov_2g080izq9n().b[7][0]++,cache)&&(cov_2g080izq9n().b[7][1]++,cache.has(obj))){cov_2g080izq9n().b[6][0]++;cov_2g080izq9n().s[20]++;return cache.get(obj);}else{cov_2g080izq9n().b[6][1]++;}var newObj=(cov_2g080izq9n().s[21]++,{});var hasPropertyDescriptor=(cov_2g080izq9n().s[22]++,(cov_2g080izq9n().b[8][0]++,Object.defineProperty)&&(cov_2g080izq9n().b[8][1]++,Object.getOwnPropertyDescriptor));cov_2g080izq9n().s[23]++;for(var key in obj){cov_2g080izq9n().s[24]++;if((cov_2g080izq9n().b[10][0]++,key!=="default")&&(cov_2g080izq9n().b[10][1]++,Object.prototype.hasOwnProperty.call(obj,key))){cov_2g080izq9n().b[9][0]++;var desc=(cov_2g080izq9n().s[25]++,hasPropertyDescriptor?(cov_2g080izq9n().b[11][0]++,Object.getOwnPropertyDescriptor(obj,key)):(cov_2g080izq9n().b[11][1]++,null));cov_2g080izq9n().s[26]++;if((cov_2g080izq9n().b[13][0]++,desc)&&((cov_2g080izq9n().b[13][1]++,desc.get)||(cov_2g080izq9n().b[13][2]++,desc.set))){cov_2g080izq9n().b[12][0]++;cov_2g080izq9n().s[27]++;Object.defineProperty(newObj,key,desc);}else{cov_2g080izq9n().b[12][1]++;cov_2g080izq9n().s[28]++;newObj[key]=obj[key];}}else{cov_2g080izq9n().b[9][1]++;}}cov_2g080izq9n().s[29]++;newObj.default=obj;cov_2g080izq9n().s[30]++;if(cache){cov_2g080izq9n().b[14][0]++;cov_2g080izq9n().s[31]++;cache.set(obj,newObj);}else{cov_2g080izq9n().b[14][1]++;}cov_2g080izq9n().s[32]++;return newObj;}function _interopRequireDefault(obj){cov_2g080izq9n().f[3]++;cov_2g080izq9n().s[33]++;return(cov_2g080izq9n().b[16][0]++,obj)&&(cov_2g080izq9n().b[16][1]++,obj.__esModule)?(cov_2g080izq9n().b[15][0]++,obj):(cov_2g080izq9n().b[15][1]++,{default:obj});}cov_2g080izq9n().s[34]++;const handleUpload=async(upload,config)=>{cov_2g080izq9n().f[4]++;const{createReadStream,filename,mimetype}=(cov_2g080izq9n().s[35]++,await upload);let data=(cov_2g080izq9n().s[36]++,null);cov_2g080izq9n().s[37]++;if(createReadStream){cov_2g080izq9n().b[17][0]++;const stream=(cov_2g080izq9n().s[38]++,createReadStream());cov_2g080izq9n().s[39]++;data=await new Promise((resolve,reject)=>{cov_2g080izq9n().f[5]++;const chunks=(cov_2g080izq9n().s[40]++,[]);cov_2g080izq9n().s[41]++;stream.on('error',reject).on('data',chunk=>{cov_2g080izq9n().f[6]++;cov_2g080izq9n().s[42]++;return chunks.push(chunk);}).on('end',()=>{cov_2g080izq9n().f[7]++;cov_2g080izq9n().s[43]++;return resolve(Buffer.concat(chunks));});});}else{cov_2g080izq9n().b[17][1]++;}cov_2g080izq9n().s[44]++;if((cov_2g080izq9n().b[19][0]++,!data)||(cov_2g080izq9n().b[19][1]++,!data.length)){cov_2g080izq9n().b[18][0]++;cov_2g080izq9n().s[45]++;throw new _node.default.Error(_node.default.Error.FILE_SAVE_ERROR,'Invalid file upload.');}else{cov_2g080izq9n().b[18][1]++;}cov_2g080izq9n().s[46]++;if(filename.length>128){cov_2g080izq9n().b[20][0]++;cov_2g080izq9n().s[47]++;throw new _node.default.Error(_node.default.Error.INVALID_FILE_NAME,'Filename too long.');}else{cov_2g080izq9n().b[20][1]++;}cov_2g080izq9n().s[48]++;if(!filename.match(/^[_a-zA-Z0-9][a-zA-Z0-9@\.\ ~_-]*$/)){cov_2g080izq9n().b[21][0]++;cov_2g080izq9n().s[49]++;throw new _node.default.Error(_node.default.Error.INVALID_FILE_NAME,'Filename contains invalid characters.');}else{cov_2g080izq9n().b[21][1]++;}cov_2g080izq9n().s[50]++;try{cov_2g080izq9n().s[51]++;return{fileInfo:await config.filesController.createFile(config,filename,data,mimetype)};}catch(e){cov_2g080izq9n().s[52]++;_logger.default.error('Error creating a file: ',e);cov_2g080izq9n().s[53]++;throw new _node.default.Error(_node.default.Error.FILE_SAVE_ERROR,`Could not store file: ${filename}.`);}};cov_2g080izq9n().s[54]++;exports.handleUpload=handleUpload;cov_2g080izq9n().s[55]++;const load=parseGraphQLSchema=>{cov_2g080izq9n().f[8]++;const createMutation=(cov_2g080izq9n().s[56]++,(0,_graphqlRelay.mutationWithClientMutationId)({name:'CreateFile',description:'The createFile mutation can be used to create and upload a new file.',inputFields:{upload:{description:'This is the new file to be created and uploaded.',type:new _graphql.GraphQLNonNull(_links.GraphQLUpload)}},outputFields:{fileInfo:{description:'This is the created file info.',type:new _graphql.GraphQLNonNull(defaultGraphQLTypes.FILE_INFO)}},mutateAndGetPayload:async(args,context)=>{cov_2g080izq9n().f[9]++;cov_2g080izq9n().s[57]++;try{const{upload}=(cov_2g080izq9n().s[58]++,args);const{config}=(cov_2g080izq9n().s[59]++,context);cov_2g080izq9n().s[60]++;return handleUpload(upload,config);}catch(e){cov_2g080izq9n().s[61]++;parseGraphQLSchema.handleError(e);}}}));cov_2g080izq9n().s[62]++;parseGraphQLSchema.addGraphQLType(createMutation.args.input.type.ofType,true,true);cov_2g080izq9n().s[63]++;parseGraphQLSchema.addGraphQLType(createMutation.type,true,true);cov_2g080izq9n().s[64]++;parseGraphQLSchema.addGraphQLMutation('createFile',createMutation,true,true);};cov_2g080izq9n().s[65]++;exports.load=load;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9HcmFwaFFML2xvYWRlcnMvZmlsZXNNdXRhdGlvbnMuanMiXSwibmFtZXMiOlsiaGFuZGxlVXBsb2FkIiwidXBsb2FkIiwiY29uZmlnIiwiY3JlYXRlUmVhZFN0cmVhbSIsImZpbGVuYW1lIiwibWltZXR5cGUiLCJkYXRhIiwic3RyZWFtIiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJjaHVua3MiLCJvbiIsImNodW5rIiwicHVzaCIsIkJ1ZmZlciIsImNvbmNhdCIsImxlbmd0aCIsIlBhcnNlIiwiRXJyb3IiLCJGSUxFX1NBVkVfRVJST1IiLCJJTlZBTElEX0ZJTEVfTkFNRSIsIm1hdGNoIiwiZmlsZUluZm8iLCJmaWxlc0NvbnRyb2xsZXIiLCJjcmVhdGVGaWxlIiwiZSIsImxvZ2dlciIsImVycm9yIiwibG9hZCIsInBhcnNlR3JhcGhRTFNjaGVtYSIsImNyZWF0ZU11dGF0aW9uIiwibmFtZSIsImRlc2NyaXB0aW9uIiwiaW5wdXRGaWVsZHMiLCJ0eXBlIiwiR3JhcGhRTE5vbk51bGwiLCJHcmFwaFFMVXBsb2FkIiwib3V0cHV0RmllbGRzIiwiZGVmYXVsdEdyYXBoUUxUeXBlcyIsIkZJTEVfSU5GTyIsIm11dGF0ZUFuZEdldFBheWxvYWQiLCJhcmdzIiwiY29udGV4dCIsImhhbmRsZUVycm9yIiwiYWRkR3JhcGhRTFR5cGUiLCJpbnB1dCIsIm9mVHlwZSIsImFkZEdyYXBoUUxNdXRhdGlvbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOzs7Ozs7OztBQUVBLE1BQU1BLFlBQVksR0FBRyxPQUFPQyxNQUFQLEVBQWVDLE1BQWYsS0FBMEI7QUFDN0MsUUFBTTtBQUFFQyxJQUFBQSxnQkFBRjtBQUFvQkMsSUFBQUEsUUFBcEI7QUFBOEJDLElBQUFBO0FBQTlCLE1BQTJDLE1BQU1KLE1BQXZEO0FBQ0EsTUFBSUssSUFBSSxHQUFHLElBQVg7O0FBQ0EsTUFBSUgsZ0JBQUos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QUEwQkFJLEVBQUFBLGtCQUFrQixDQUFDZSxjQUFuQixDQUFrQ2QsY0FBYyxDQUFDVyxJQUFmLENBQW9CSSxLQUFwQixDQUEwQlgsSUFBMUIsQ0FBK0JZLE1BQWpFLEVBQXlFLElBQXpFLEVBQStFLElBQS9FO0FBQ0FqQixFQUFBQSxrQkFBa0IsQ0FBQ2UsY0FBbkIsQ0FBa0NkLGNBQWMsQ0FBQ0ksSUFBakQsRUFBdUQsSUFBdkQsRUFBNkQsSUFBN0Q7QUFDQUwsRUFBQUEsa0JBQWtCLENBQUNrQixrQkFBbkIsQ0FBc0MsWUFBdEMsRUFBb0RqQixjQUFwRCxFQUFvRSxJQUFwRSxFQUEwRSxJQUExRTtBQUNELENBOUJEIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgR3JhcGhRTE5vbk51bGwgfSBmcm9tICdncmFwaHFsJztcbmltcG9ydCB7IG11dGF0aW9uV2l0aENsaWVudE11dGF0aW9uSWQgfSBmcm9tICdncmFwaHFsLXJlbGF5JztcbmltcG9ydCB7IEdyYXBoUUxVcGxvYWQgfSBmcm9tICdAZ3JhcGhxbC10b29scy9saW5rcyc7XG5pbXBvcnQgUGFyc2UgZnJvbSAncGFyc2Uvbm9kZSc7XG5pbXBvcnQgKiBhcyBkZWZhdWx0R3JhcGhRTFR5cGVzIGZyb20gJy4vZGVmYXVsdEdyYXBoUUxUeXBlcyc7XG5pbXBvcnQgbG9nZ2VyIGZyb20gJy4uLy4uL2xvZ2dlcic7XG5cbmNvbnN0IGhhbmRsZVVwbG9hZCA9IGFzeW5jICh1cGxvYWQsIGNvbmZpZykgPT4ge1xuICBjb25zdCB7IGNyZWF0ZVJlYWRTdHJlYW0sIGZpbGVuYW1lLCBtaW1ldHlwZSB9ID0gYXdhaXQgdXBsb2FkO1xuICBsZXQgZGF0YSA9IG51bGw7XG4gIGlmIChjcmVhdGVSZWFkU3RyZWFtKSB7XG4gICAgY29uc3Qgc3RyZWFtID0gY3JlYXRlUmVhZFN0cmVhbSgpO1xuICAgIGRhdGEgPSBhd2FpdCBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICBjb25zdCBjaHVua3MgPSBbXTtcbiAgICAgIHN0cmVhbVxuICAgICAgICAub24oJ2Vycm9yJywgcmVqZWN0KVxuICAgICAgICAub24oJ2RhdGEnLCBjaHVuayA9PiBjaHVua3MucHVzaChjaHVuaykpXG4gICAgICAgIC5vbignZW5kJywgKCkgPT4gcmVzb2x2ZShCdWZmZXIuY29uY2F0KGNodW5rcykpKTtcbiAgICB9KTtcbiAgfVxuXG4gIGlmICghZGF0YSB8fCAhZGF0YS5sZW5ndGgpIHtcbiAgICB0aHJvdyBuZXcgUGFyc2UuRXJyb3IoUGFyc2UuRXJyb3IuRklMRV9TQVZFX0VSUk9SLCAnSW52YWxpZCBmaWxlIHVwbG9hZC4nKTtcbiAgfVxuXG4gIGlmIChmaWxlbmFtZS5sZW5ndGggPiAxMjgpIHtcbiAgICB0aHJvdyBuZXcgUGFyc2UuRXJyb3IoUGFyc2UuRXJyb3IuSU5WQUxJRF9GSUxFX05BTUUsICdGaWxlbmFtZSB0b28gbG9uZy4nKTtcbiAgfVxuXG4gIGlmICghZmlsZW5hbWUubWF0Y2goL15bX2EtekEtWjAtOV1bYS16QS1aMC05QFxcLlxcIH5fLV0qJC8pKSB7XG4gICAgdGhyb3cgbmV3IFBhcnNlLkVycm9yKFBhcnNlLkVycm9yLklOVkFMSURfRklMRV9OQU1FLCAnRmlsZW5hbWUgY29udGFpbnMgaW52YWxpZCBjaGFyYWN0ZXJzLicpO1xuICB9XG5cbiAgdHJ5IHtcbiAgICByZXR1cm4ge1xuICAgICAgZmlsZUluZm86IGF3YWl0IGNvbmZpZy5maWxlc0NvbnRyb2xsZXIuY3JlYXRlRmlsZShjb25maWcsIGZpbGVuYW1lLCBkYXRhLCBtaW1ldHlwZSksXG4gICAgfTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIGxvZ2dlci5lcnJvcignRXJyb3IgY3JlYXRpbmcgYSBmaWxlOiAnLCBlKTtcbiAgICB0aHJvdyBuZXcgUGFyc2UuRXJyb3IoUGFyc2UuRXJyb3IuRklMRV9TQVZFX0VSUk9SLCBgQ291bGQgbm90IHN0b3JlIGZpbGU6ICR7ZmlsZW5hbWV9LmApO1xuICB9XG59O1xuXG5jb25zdCBsb2FkID0gcGFyc2VHcmFwaFFMU2NoZW1hID0+IHtcbiAgY29uc3QgY3JlYXRlTXV0YXRpb24gPSBtdXRhdGlvbldpdGhDbGllbnRNdXRhdGlvbklkKHtcbiAgICBuYW1lOiAnQ3JlYXRlRmlsZScsXG4gICAgZGVzY3JpcHRpb246ICdUaGUgY3JlYXRlRmlsZSBtdXRhdGlvbiBjYW4gYmUgdXNlZCB0byBjcmVhdGUgYW5kIHVwbG9hZCBhIG5ldyBmaWxlLicsXG4gICAgaW5wdXRGaWVsZHM6IHtcbiAgICAgIHVwbG9hZDoge1xuICAgICAgICBkZXNjcmlwdGlvbjogJ1RoaXMgaXMgdGhlIG5ldyBmaWxlIHRvIGJlIGNyZWF0ZWQgYW5kIHVwbG9hZGVkLicsXG4gICAgICAgIHR5cGU6IG5ldyBHcmFwaFFMTm9uTnVsbChHcmFwaFFMVXBsb2FkKSxcbiAgICAgIH0sXG4gICAgfSxcbiAgICBvdXRwdXRGaWVsZHM6IHtcbiAgICAgIGZpbGVJbmZvOiB7XG4gICAgICAgIGRlc2NyaXB0aW9uOiAnVGhpcyBpcyB0aGUgY3JlYXRlZCBmaWxlIGluZm8uJyxcbiAgICAgICAgdHlwZTogbmV3IEdyYXBoUUxOb25OdWxsKGRlZmF1bHRHcmFwaFFMVHlwZXMuRklMRV9JTkZPKSxcbiAgICAgIH0sXG4gICAgfSxcbiAgICBtdXRhdGVBbmRHZXRQYXlsb2FkOiBhc3luYyAoYXJncywgY29udGV4dCkgPT4ge1xuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgeyB1cGxvYWQgfSA9IGFyZ3M7XG4gICAgICAgIGNvbnN0IHsgY29uZmlnIH0gPSBjb250ZXh0O1xuICAgICAgICByZXR1cm4gaGFuZGxlVXBsb2FkKHVwbG9hZCwgY29uZmlnKTtcbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgcGFyc2VHcmFwaFFMU2NoZW1hLmhhbmRsZUVycm9yKGUpO1xuICAgICAgfVxuICAgIH0sXG4gIH0pO1xuXG4gIHBhcnNlR3JhcGhRTFNjaGVtYS5hZGRHcmFwaFFMVHlwZShjcmVhdGVNdXRhdGlvbi5hcmdzLmlucHV0LnR5cGUub2ZUeXBlLCB0cnVlLCB0cnVlKTtcbiAgcGFyc2VHcmFwaFFMU2NoZW1hLmFkZEdyYXBoUUxUeXBlKGNyZWF0ZU11dGF0aW9uLnR5cGUsIHRydWUsIHRydWUpO1xuICBwYXJzZUdyYXBoUUxTY2hlbWEuYWRkR3JhcGhRTE11dGF0aW9uKCdjcmVhdGVGaWxlJywgY3JlYXRlTXV0YXRpb24sIHRydWUsIHRydWUpO1xufTtcblxuZXhwb3J0IHsgbG9hZCwgaGFuZGxlVXBsb2FkIH07XG4iXX0=
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9HcmFwaFFML2xvYWRlcnMvZmlsZXNNdXRhdGlvbnMuanMiXSwibmFtZXMiOlsiaGFuZGxlVXBsb2FkIiwibWltZXR5cGUiLCJkYXRhIiwic3RyZWFtIiwiY3JlYXRlUmVhZFN0cmVhbSIsImNodW5rcyIsImNodW5rIiwicmVzb2x2ZSIsIkJ1ZmZlciIsIlBhcnNlIiwiZmlsZW5hbWUiLCJmaWxlSW5mbyIsImNvbmZpZyIsImxvZ2dlciIsImxvYWQiLCJwYXJzZUdyYXBoUUxTY2hlbWEiLCJjcmVhdGVNdXRhdGlvbiIsIm5hbWUiLCJkZXNjcmlwdGlvbiIsImlucHV0RmllbGRzIiwidXBsb2FkIiwidHlwZSIsIkdyYXBoUUxOb25OdWxsIiwiR3JhcGhRTFVwbG9hZCIsIm91dHB1dEZpZWxkcyIsImRlZmF1bHRHcmFwaFFMVHlwZXMiLCJtdXRhdGVBbmRHZXRQYXlsb2FkIl0sIm1hcHBpbmdzIjoicTlnQkFJQTs2T0FKQSxHQUFBLENBQUEsUUFBQSwwQkFBQSxPQUFBLENBQUEsU0FBQSxDQUFBLENBQUEsQ0FDQSxHQUFBLENBQUEsYUFBQSwwQkFBQSxPQUFBLENBQUEsZUFBQSxDQUFBLENBQUEsQ0FDQSxHQUFBLENBQUEsTUFBQSwwQkFBQSxPQUFBLENBQUEsc0JBQUEsQ0FBQSxDQUFBLENBQ0EsR0FBQSxDQUFBLEtBQUEsMEJBQUEsc0JBQUEsQ0FBQSxPQUFBLENBQUEsWUFBQSxDQUFBLENBQUEsQ0FBQSxDQUNBLEdBQUEsQ0FBQSxtQkFBQSwwQkFBQSx1QkFBQSxDQUFBLE9BQUEsQ0FBQSx1QkFBQSxDQUFBLENBQUEsQ0FBQSxDQUNBLEdBQUEsQ0FBQSxPQUFBLDBCQUFBLHNCQUFBLENBQUEsT0FBQSxDQUFBLGNBQUEsQ0FBQSxDQUFBLENBQUEsQywwNEZBRUEsS0FBTUEsQ0FBQUEsWUFBWSxDQUFHLE1BQUEsTUFBQSxDQUFBLE1BQUEsR0FBMEIseUJBQzdDLEtBQU0sQ0FBQSxnQkFBQSxDQUFBLFFBQUEsQ0FBOEJDLFFBQTlCLDRC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QVksQ0FBRSxDQUNaYixRQUFRLENBQUUsQ0FDUk8sV0FBVyxDQURILGdDQUFBLENBRVJHLElBQUksQ0FBRSxHQUFJQyxDQUFBQSxRQUFBQSxDQUFKLGNBQUEsQ0FBbUJHLG1CQUFtQixDQUF0QyxTQUFBLENBRkUsQ0FERSxDQVRvQyxDQWVsREMsbUJBQW1CLENBQUUsTUFBQSxJQUFBLENBQUEsT0FBQSxHQUF5QixrREFDNUMsR0FBSSxDQUNGLEtBQU0sQ0FBRU4sTUFBRiw0QkFBTixJQUFNLENBQU4sQ0FDQSxLQUFNLENBQUVSLE1BQUYsNEJBQU4sT0FBTSxDQUFOLENBRkUseUJBR0YsTUFBT1osQ0FBQUEsWUFBWSxDQUFBLE1BQUEsQ0FBbkIsTUFBbUIsQ0FBbkIsQ0FIRixDQUlFLE1BQUEsQ0FBQSxDQUFVLDBCQUNWZSxrQkFBa0IsQ0FBbEJBLFdBQUFBLENBQUFBLENBQUFBLEVBQ0QsQ0FDRixDQXZCaUQsQ0FBN0IsQ0FBSCxDQUFwQixDQURpQyx5QkEyQmpDQSxrQkFBa0IsQ0FBbEJBLGNBQUFBLENBQWtDQyxjQUFjLENBQWRBLElBQUFBLENBQUFBLEtBQUFBLENBQUFBLElBQUFBLENBQWxDRCxNQUFBQSxDQUFBQSxJQUFBQSxDQUFBQSxJQUFBQSxFQTNCaUMseUJBNEJqQ0Esa0JBQWtCLENBQWxCQSxjQUFBQSxDQUFrQ0MsY0FBYyxDQUFoREQsSUFBQUEsQ0FBQUEsSUFBQUEsQ0FBQUEsSUFBQUEsRUE1QmlDLHlCQTZCakNBLGtCQUFrQixDQUFsQkEsa0JBQUFBLENBQUFBLFlBQUFBLENBQUFBLGNBQUFBLENBQUFBLElBQUFBLENBQUFBLElBQUFBLEVBN0JGLENBQUEsQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEdyYXBoUUxOb25OdWxsIH0gZnJvbSAnZ3JhcGhxbCc7XG5pbXBvcnQgeyBtdXRhdGlvbldpdGhDbGllbnRNdXRhdGlvbklkIH0gZnJvbSAnZ3JhcGhxbC1yZWxheSc7XG5pbXBvcnQgeyBHcmFwaFFMVXBsb2FkIH0gZnJvbSAnQGdyYXBocWwtdG9vbHMvbGlua3MnO1xuaW1wb3J0IFBhcnNlIGZyb20gJ3BhcnNlL25vZGUnO1xuaW1wb3J0ICogYXMgZGVmYXVsdEdyYXBoUUxUeXBlcyBmcm9tICcuL2RlZmF1bHRHcmFwaFFMVHlwZXMnO1xuaW1wb3J0IGxvZ2dlciBmcm9tICcuLi8uLi9sb2dnZXInO1xuXG5jb25zdCBoYW5kbGVVcGxvYWQgPSBhc3luYyAodXBsb2FkLCBjb25maWcpID0+IHtcbiAgY29uc3QgeyBjcmVhdGVSZWFkU3RyZWFtLCBmaWxlbmFtZSwgbWltZXR5cGUgfSA9IGF3YWl0IHVwbG9hZDtcbiAgbGV0IGRhdGEgPSBudWxsO1xuICBpZiAoY3JlYXRlUmVhZFN0cmVhbSkge1xuICAgIGNvbnN0IHN0cmVhbSA9IGNyZWF0ZVJlYWRTdHJlYW0oKTtcbiAgICBkYXRhID0gYXdhaXQgbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgY29uc3QgY2h1bmtzID0gW107XG4gICAgICBzdHJlYW1cbiAgICAgICAgLm9uKCdlcnJvcicsIHJlamVjdClcbiAgICAgICAgLm9uKCdkYXRhJywgY2h1bmsgPT4gY2h1bmtzLnB1c2goY2h1bmspKVxuICAgICAgICAub24oJ2VuZCcsICgpID0+IHJlc29sdmUoQnVmZmVyLmNvbmNhdChjaHVua3MpKSk7XG4gICAgfSk7XG4gIH1cblxuICBpZiAoIWRhdGEgfHwgIWRhdGEubGVuZ3RoKSB7XG4gICAgdGhyb3cgbmV3IFBhcnNlLkVycm9yKFBhcnNlLkVycm9yLkZJTEVfU0FWRV9FUlJPUiwgJ0ludmFsaWQgZmlsZSB1cGxvYWQuJyk7XG4gIH1cblxuICBpZiAoZmlsZW5hbWUubGVuZ3RoID4gMTI4KSB7XG4gICAgdGhyb3cgbmV3IFBhcnNlLkVycm9yKFBhcnNlLkVycm9yLklOVkFMSURfRklMRV9OQU1FLCAnRmlsZW5hbWUgdG9vIGxvbmcuJyk7XG4gIH1cblxuICBpZiAoIWZpbGVuYW1lLm1hdGNoKC9eW19hLXpBLVowLTldW2EtekEtWjAtOUBcXC5cXCB+Xy1dKiQvKSkge1xuICAgIHRocm93IG5ldyBQYXJzZS5FcnJvcihQYXJzZS5FcnJvci5JTlZBTElEX0ZJTEVfTkFNRSwgJ0ZpbGVuYW1lIGNvbnRhaW5zIGludmFsaWQgY2hhcmFjdGVycy4nKTtcbiAgfVxuXG4gIHRyeSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGZpbGVJbmZvOiBhd2FpdCBjb25maWcuZmlsZXNDb250cm9sbGVyLmNyZWF0ZUZpbGUoY29uZmlnLCBmaWxlbmFtZSwgZGF0YSwgbWltZXR5cGUpLFxuICAgIH07XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICBsb2dnZXIuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIGEgZmlsZTogJywgZSk7XG4gICAgdGhyb3cgbmV3IFBhcnNlLkVycm9yKFBhcnNlLkVycm9yLkZJTEVfU0FWRV9FUlJPUiwgYENvdWxkIG5vdCBzdG9yZSBmaWxlOiAke2ZpbGVuYW1lfS5gKTtcbiAgfVxufTtcblxuY29uc3QgbG9hZCA9IHBhcnNlR3JhcGhRTFNjaGVtYSA9PiB7XG4gIGNvbnN0IGNyZWF0ZU11dGF0aW9uID0gbXV0YXRpb25XaXRoQ2xpZW50TXV0YXRpb25JZCh7XG4gICAgbmFtZTogJ0NyZWF0ZUZpbGUnLFxuICAgIGRlc2NyaXB0aW9uOiAnVGhlIGNyZWF0ZUZpbGUgbXV0YXRpb24gY2FuIGJlIHVzZWQgdG8gY3JlYXRlIGFuZCB1cGxvYWQgYSBuZXcgZmlsZS4nLFxuICAgIGlucHV0RmllbGRzOiB7XG4gICAgICB1cGxvYWQ6IHtcbiAgICAgICAgZGVzY3JpcHRpb246ICdUaGlzIGlzIHRoZSBuZXcgZmlsZSB0byBiZSBjcmVhdGVkIGFuZCB1cGxvYWRlZC4nLFxuICAgICAgICB0eXBlOiBuZXcgR3JhcGhRTE5vbk51bGwoR3JhcGhRTFVwbG9hZCksXG4gICAgICB9LFxuICAgIH0sXG4gICAgb3V0cHV0RmllbGRzOiB7XG4gICAgICBmaWxlSW5mbzoge1xuICAgICAgICBkZXNjcmlwdGlvbjogJ1RoaXMgaXMgdGhlIGNyZWF0ZWQgZmlsZSBpbmZvLicsXG4gICAgICAgIHR5cGU6IG5ldyBHcmFwaFFMTm9uTnVsbChkZWZhdWx0R3JhcGhRTFR5cGVzLkZJTEVfSU5GTyksXG4gICAgICB9LFxuICAgIH0sXG4gICAgbXV0YXRlQW5kR2V0UGF5bG9hZDogYXN5bmMgKGFyZ3MsIGNvbnRleHQpID0+IHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHsgdXBsb2FkIH0gPSBhcmdzO1xuICAgICAgICBjb25zdCB7IGNvbmZpZyB9ID0gY29udGV4dDtcbiAgICAgICAgcmV0dXJuIGhhbmRsZVVwbG9hZCh1cGxvYWQsIGNvbmZpZyk7XG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIHBhcnNlR3JhcGhRTFNjaGVtYS5oYW5kbGVFcnJvcihlKTtcbiAgICAgIH1cbiAgICB9LFxuICB9KTtcblxuICBwYXJzZUdyYXBoUUxTY2hlbWEuYWRkR3JhcGhRTFR5cGUoY3JlYXRlTXV0YXRpb24uYXJncy5pbnB1dC50eXBlLm9mVHlwZSwgdHJ1ZSwgdHJ1ZSk7XG4gIHBhcnNlR3JhcGhRTFNjaGVtYS5hZGRHcmFwaFFMVHlwZShjcmVhdGVNdXRhdGlvbi50eXBlLCB0cnVlLCB0cnVlKTtcbiAgcGFyc2VHcmFwaFFMU2NoZW1hLmFkZEdyYXBoUUxNdXRhdGlvbignY3JlYXRlRmlsZScsIGNyZWF0ZU11dGF0aW9uLCB0cnVlLCB0cnVlKTtcbn07XG5cbmV4cG9ydCB7IGxvYWQsIGhhbmRsZVVwbG9hZCB9O1xuIl19