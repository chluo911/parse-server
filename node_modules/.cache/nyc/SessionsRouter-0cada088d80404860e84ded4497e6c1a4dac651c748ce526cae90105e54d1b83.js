"use strict";function cov_1b6orx580z(){var path="/parse-server/lib/Routers/SessionsRouter.js";var hash="3d6304bdfceead65ad8e2b51da63ade1686da964";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/parse-server/lib/Routers/SessionsRouter.js",statementMap:{"0":{start:{line:3,column:0},end:{line:5,column:3}},"1":{start:{line:6,column:0},end:{line:6,column:50}},"2":{start:{line:8,column:21},end:{line:8,column:71}},"3":{start:{line:10,column:12},end:{line:10,column:57}},"4":{start:{line:12,column:12},end:{line:12,column:54}},"5":{start:{line:14,column:12},end:{line:14,column:54}},"6":{start:{line:16,column:17},end:{line:16,column:64}},"7":{start:{line:18,column:39},end:{line:18,column:93}},"8":{start:{line:22,column:4},end:{line:22,column:22}},"9":{start:{line:27,column:4},end:{line:29,column:5}},"10":{start:{line:28,column:6},end:{line:28,column:106}},"11":{start:{line:31,column:4},end:{line:41,column:7}},"12":{start:{line:34,column:6},end:{line:36,column:7}},"13":{start:{line:35,column:8},end:{line:35,column:109}},"14":{start:{line:38,column:6},end:{line:40,column:8}},"15":{start:{line:45,column:19},end:{line:45,column:29}},"16":{start:{line:46,column:17},end:{line:46,column:30}},"17":{start:{line:49,column:4},end:{line:51,column:5}},"18":{start:{line:50,column:6},end:{line:50,column:93}},"19":{start:{line:56,column:8},end:{line:62,column:6}},"20":{start:{line:64,column:4},end:{line:77,column:7}},"21":{start:{line:66,column:6},end:{line:72,column:9}},"22":{start:{line:74,column:6},end:{line:76,column:9}},"23":{start:{line:81,column:4},end:{line:83,column:7}},"24":{start:{line:82,column:6},end:{line:82,column:32}},"25":{start:{line:84,column:4},end:{line:86,column:7}},"26":{start:{line:85,column:6},end:{line:85,column:34}},"27":{start:{line:87,column:4},end:{line:89,column:7}},"28":{start:{line:88,column:6},end:{line:88,column:33}},"29":{start:{line:90,column:4},end:{line:92,column:7}},"30":{start:{line:91,column:6},end:{line:91,column:36}},"31":{start:{line:93,column:4},end:{line:95,column:7}},"32":{start:{line:94,column:6},end:{line:94,column:36}},"33":{start:{line:96,column:4},end:{line:98,column:7}},"34":{start:{line:97,column:6},end:{line:97,column:36}},"35":{start:{line:99,column:4},end:{line:101,column:7}},"36":{start:{line:100,column:6},end:{line:100,column:54}},"37":{start:{line:106,column:0},end:{line:106,column:40}},"38":{start:{line:107,column:15},end:{line:107,column:29}},"39":{start:{line:108,column:0},end:{line:108,column:27}}},fnMap:{"0":{name:"_interopRequireDefault",decl:{start:{line:18,column:9},end:{line:18,column:31}},loc:{start:{line:18,column:37},end:{line:18,column:95}},line:18},"1":{name:"(anonymous_1)",decl:{start:{line:21,column:2},end:{line:21,column:3}},loc:{start:{line:21,column:14},end:{line:23,column:3}},line:21},"2":{name:"(anonymous_2)",decl:{start:{line:25,column:2},end:{line:25,column:3}},loc:{start:{line:25,column:16},end:{line:42,column:3}},line:25},"3":{name:"(anonymous_3)",decl:{start:{line:33,column:61},end:{line:33,column:62}},loc:{start:{line:33,column:73},end:{line:41,column:5}},line:33},"4":{name:"(anonymous_4)",decl:{start:{line:44,column:2},end:{line:44,column:3}},loc:{start:{line:44,column:38},end:{line:78,column:3}},line:44},"5":{name:"(anonymous_5)",decl:{start:{line:64,column:32},end:{line:64,column:33}},loc:{start:{line:64,column:38},end:{line:73,column:5}},line:64},"6":{name:"(anonymous_6)",decl:{start:{line:73,column:12},end:{line:73,column:13}},loc:{start:{line:73,column:18},end:{line:77,column:5}},line:73},"7":{name:"(anonymous_7)",decl:{start:{line:80,column:2},end:{line:80,column:3}},loc:{start:{line:80,column:16},end:{line:102,column:3}},line:80},"8":{name:"(anonymous_8)",decl:{start:{line:81,column:38},end:{line:81,column:39}},loc:{start:{line:81,column:45},end:{line:83,column:5}},line:81},"9":{name:"(anonymous_9)",decl:{start:{line:84,column:35},end:{line:84,column:36}},loc:{start:{line:84,column:42},end:{line:86,column:5}},line:84},"10":{name:"(anonymous_10)",decl:{start:{line:87,column:45},end:{line:87,column:46}},loc:{start:{line:87,column:52},end:{line:89,column:5}},line:87},"11":{name:"(anonymous_11)",decl:{start:{line:90,column:36},end:{line:90,column:37}},loc:{start:{line:90,column:43},end:{line:92,column:5}},line:90},"12":{name:"(anonymous_12)",decl:{start:{line:93,column:45},end:{line:93,column:46}},loc:{start:{line:93,column:52},end:{line:95,column:5}},line:93},"13":{name:"(anonymous_13)",decl:{start:{line:96,column:48},end:{line:96,column:49}},loc:{start:{line:96,column:55},end:{line:98,column:5}},line:96},"14":{name:"(anonymous_14)",decl:{start:{line:99,column:53},end:{line:99,column:54}},loc:{start:{line:99,column:60},end:{line:101,column:5}},line:99}},branchMap:{"0":{loc:{start:{line:18,column:46},end:{line:18,column:92}},type:"cond-expr",locations:[{start:{line:18,column:70},end:{line:18,column:73}},{start:{line:18,column:76},end:{line:18,column:92}}],line:18},"1":{loc:{start:{line:18,column:46},end:{line:18,column:67}},type:"binary-expr",locations:[{start:{line:18,column:46},end:{line:18,column:49}},{start:{line:18,column:53},end:{line:18,column:67}}],line:18},"2":{loc:{start:{line:27,column:4},end:{line:29,column:5}},type:"if",locations:[{start:{line:27,column:4},end:{line:29,column:5}},{start:{line:27,column:4},end:{line:29,column:5}}],line:27},"3":{loc:{start:{line:27,column:8},end:{line:27,column:43}},type:"binary-expr",locations:[{start:{line:27,column:8},end:{line:27,column:17}},{start:{line:27,column:21},end:{line:27,column:43}}],line:27},"4":{loc:{start:{line:34,column:6},end:{line:36,column:7}},type:"if",locations:[{start:{line:34,column:6},end:{line:36,column:7}},{start:{line:34,column:6},end:{line:36,column:7}}],line:34},"5":{loc:{start:{line:34,column:10},end:{line:34,column:59}},type:"binary-expr",locations:[{start:{line:34,column:10},end:{line:34,column:27}},{start:{line:34,column:31},end:{line:34,column:59}}],line:34},"6":{loc:{start:{line:49,column:4},end:{line:51,column:5}},type:"if",locations:[{start:{line:49,column:4},end:{line:51,column:5}},{start:{line:49,column:4},end:{line:51,column:5}}],line:49}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0]},inputSourceMap:{version:3,sources:["../../src/Routers/SessionsRouter.js"],names:["SessionsRouter","ClassesRouter","className","handleMe","req","info","sessionToken","Parse","Error","INVALID_SESSION_TOKEN","rest","find","config","Auth","master","undefined","clientSDK","context","then","response","results","length","handleUpdateToRevocableSession","user","auth","OBJECT_NOT_FOUND","sessionData","createSession","RestWrite","userId","id","createdWith","action","installationId","database","update","objectId","__op","Promise","resolve","mountRoutes","route","handleFind","handleGet","handleCreate","handleUpdate","handleDelete"],mappings:"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",sourcesContent:["import ClassesRouter from './ClassesRouter';\nimport Parse from 'parse/node';\nimport rest from '../rest';\nimport Auth from '../Auth';\nimport RestWrite from '../RestWrite';\n\nexport class SessionsRouter extends ClassesRouter {\n  className() {\n    return '_Session';\n  }\n\n  handleMe(req) {\n    // TODO: Verify correct behavior\n    if (!req.info || !req.info.sessionToken) {\n      throw new Parse.Error(Parse.Error.INVALID_SESSION_TOKEN, 'Session token required.');\n    }\n    return rest\n      .find(\n        req.config,\n        Auth.master(req.config),\n        '_Session',\n        { sessionToken: req.info.sessionToken },\n        undefined,\n        req.info.clientSDK,\n        req.info.context\n      )\n      .then(response => {\n        if (!response.results || response.results.length == 0) {\n          throw new Parse.Error(Parse.Error.INVALID_SESSION_TOKEN, 'Session token not found.');\n        }\n        return {\n          response: response.results[0],\n        };\n      });\n  }\n\n  handleUpdateToRevocableSession(req) {\n    const config = req.config;\n    const user = req.auth.user;\n    // Issue #2720\n    // Calling without a session token would result in a not found user\n    if (!user) {\n      throw new Parse.Error(Parse.Error.OBJECT_NOT_FOUND, 'invalid session');\n    }\n    const { sessionData, createSession } = RestWrite.createSession(config, {\n      userId: user.id,\n      createdWith: {\n        action: 'upgrade',\n      },\n      installationId: req.auth.installationId,\n    });\n\n    return createSession()\n      .then(() => {\n        // delete the session token, use the db to skip beforeSave\n        return config.database.update(\n          '_User',\n          {\n            objectId: user.id,\n          },\n          {\n            sessionToken: { __op: 'Delete' },\n          }\n        );\n      })\n      .then(() => {\n        return Promise.resolve({ response: sessionData });\n      });\n  }\n\n  mountRoutes() {\n    this.route('GET', '/sessions/me', req => {\n      return this.handleMe(req);\n    });\n    this.route('GET', '/sessions', req => {\n      return this.handleFind(req);\n    });\n    this.route('GET', '/sessions/:objectId', req => {\n      return this.handleGet(req);\n    });\n    this.route('POST', '/sessions', req => {\n      return this.handleCreate(req);\n    });\n    this.route('PUT', '/sessions/:objectId', req => {\n      return this.handleUpdate(req);\n    });\n    this.route('DELETE', '/sessions/:objectId', req => {\n      return this.handleDelete(req);\n    });\n    this.route('POST', '/upgradeToRevocableSession', req => {\n      return this.handleUpdateToRevocableSession(req);\n    });\n  }\n}\n\nexport default SessionsRouter;\n"]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"3d6304bdfceead65ad8e2b51da63ade1686da964"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_1b6orx580z=function(){return actualCoverage;};}return actualCoverage;}cov_1b6orx580z();cov_1b6orx580z().s[0]++;Object.defineProperty(exports,"__esModule",{value:true});cov_1b6orx580z().s[1]++;exports.default=exports.SessionsRouter=void 0;var _ClassesRouter=(cov_1b6orx580z().s[2]++,_interopRequireDefault(require("./ClassesRouter")));var _node=(cov_1b6orx580z().s[3]++,_interopRequireDefault(require("parse/node")));var _rest=(cov_1b6orx580z().s[4]++,_interopRequireDefault(require("../rest")));var _Auth=(cov_1b6orx580z().s[5]++,_interopRequireDefault(require("../Auth")));var _RestWrite=(cov_1b6orx580z().s[6]++,_interopRequireDefault(require("../RestWrite")));function _interopRequireDefault(obj){cov_1b6orx580z().f[0]++;cov_1b6orx580z().s[7]++;return(cov_1b6orx580z().b[1][0]++,obj)&&(cov_1b6orx580z().b[1][1]++,obj.__esModule)?(cov_1b6orx580z().b[0][0]++,obj):(cov_1b6orx580z().b[0][1]++,{default:obj});}class SessionsRouter extends(_ClassesRouter.default){className(){cov_1b6orx580z().f[1]++;cov_1b6orx580z().s[8]++;return'_Session';}handleMe(req){cov_1b6orx580z().f[2]++;cov_1b6orx580z().s[9]++;// TODO: Verify correct behavior
if((cov_1b6orx580z().b[3][0]++,!req.info)||(cov_1b6orx580z().b[3][1]++,!req.info.sessionToken)){cov_1b6orx580z().b[2][0]++;cov_1b6orx580z().s[10]++;throw new _node.default.Error(_node.default.Error.INVALID_SESSION_TOKEN,'Session token required.');}else{cov_1b6orx580z().b[2][1]++;}cov_1b6orx580z().s[11]++;return _rest.default.find(req.config,_Auth.default.master(req.config),'_Session',{sessionToken:req.info.sessionToken},undefined,req.info.clientSDK,req.info.context).then(response=>{cov_1b6orx580z().f[3]++;cov_1b6orx580z().s[12]++;if((cov_1b6orx580z().b[5][0]++,!response.results)||(cov_1b6orx580z().b[5][1]++,response.results.length==0)){cov_1b6orx580z().b[4][0]++;cov_1b6orx580z().s[13]++;throw new _node.default.Error(_node.default.Error.INVALID_SESSION_TOKEN,'Session token not found.');}else{cov_1b6orx580z().b[4][1]++;}cov_1b6orx580z().s[14]++;return{response:response.results[0]};});}handleUpdateToRevocableSession(req){cov_1b6orx580z().f[4]++;const config=(cov_1b6orx580z().s[15]++,req.config);const user=(cov_1b6orx580z().s[16]++,req.auth.user);// Issue #2720
// Calling without a session token would result in a not found user
cov_1b6orx580z().s[17]++;if(!user){cov_1b6orx580z().b[6][0]++;cov_1b6orx580z().s[18]++;throw new _node.default.Error(_node.default.Error.OBJECT_NOT_FOUND,'invalid session');}else{cov_1b6orx580z().b[6][1]++;}const{sessionData,createSession}=(cov_1b6orx580z().s[19]++,_RestWrite.default.createSession(config,{userId:user.id,createdWith:{action:'upgrade'},installationId:req.auth.installationId}));cov_1b6orx580z().s[20]++;return createSession().then(()=>{cov_1b6orx580z().f[5]++;cov_1b6orx580z().s[21]++;// delete the session token, use the db to skip beforeSave
return config.database.update('_User',{objectId:user.id},{sessionToken:{__op:'Delete'}});}).then(()=>{cov_1b6orx580z().f[6]++;cov_1b6orx580z().s[22]++;return Promise.resolve({response:sessionData});});}mountRoutes(){cov_1b6orx580z().f[7]++;cov_1b6orx580z().s[23]++;this.route('GET','/sessions/me',req=>{cov_1b6orx580z().f[8]++;cov_1b6orx580z().s[24]++;return this.handleMe(req);});cov_1b6orx580z().s[25]++;this.route('GET','/sessions',req=>{cov_1b6orx580z().f[9]++;cov_1b6orx580z().s[26]++;return this.handleFind(req);});cov_1b6orx580z().s[27]++;this.route('GET','/sessions/:objectId',req=>{cov_1b6orx580z().f[10]++;cov_1b6orx580z().s[28]++;return this.handleGet(req);});cov_1b6orx580z().s[29]++;this.route('POST','/sessions',req=>{cov_1b6orx580z().f[11]++;cov_1b6orx580z().s[30]++;return this.handleCreate(req);});cov_1b6orx580z().s[31]++;this.route('PUT','/sessions/:objectId',req=>{cov_1b6orx580z().f[12]++;cov_1b6orx580z().s[32]++;return this.handleUpdate(req);});cov_1b6orx580z().s[33]++;this.route('DELETE','/sessions/:objectId',req=>{cov_1b6orx580z().f[13]++;cov_1b6orx580z().s[34]++;return this.handleDelete(req);});cov_1b6orx580z().s[35]++;this.route('POST','/upgradeToRevocableSession',req=>{cov_1b6orx580z().f[14]++;cov_1b6orx580z().s[36]++;return this.handleUpdateToRevocableSession(req);});}}cov_1b6orx580z().s[37]++;exports.SessionsRouter=SessionsRouter;var _default=(cov_1b6orx580z().s[38]++,SessionsRouter);cov_1b6orx580z().s[39]++;exports.default=_default;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9Sb3V0ZXJzL1Nlc3Npb25zUm91dGVyLmpzIl0sIm5hbWVzIjpbIlNlc3Npb25zUm91dGVyIiwiQ2xhc3Nlc1JvdXRlciIsImNsYXNzTmFtZSIsImhhbmRsZU1lIiwicmVxIiwiaW5mbyIsInNlc3Npb25Ub2tlbiIsIlBhcnNlIiwiRXJyb3IiLCJJTlZBTElEX1NFU1NJT05fVE9LRU4iLCJyZXN0IiwiZmluZCIsImNvbmZpZyIsIkF1dGgiLCJtYXN0ZXIiLCJ1bmRlZmluZWQiLCJjbGllbnRTREsiLCJjb250ZXh0IiwidGhlbiIsInJlc3BvbnNlIiwicmVzdWx0cyIsImxlbmd0aCIsImhhbmRsZVVwZGF0ZVRvUmV2b2NhYmxlU2Vzc2lvbiIsInVzZXIiLCJhdXRoIiwiT0JKRUNUX05PVF9GT1VORCIsInNlc3Npb25EYXRhIiwiY3JlYXRlU2Vzc2lvbiIsIlJlc3RXcml0ZSIsInVzZXJJZCIsImlkIiwiY3JlYXRlZFdpdGgiLCJhY3Rpb24iLCJpbnN0YWxsYXRpb25JZCIsImRhdGFiYXNlIiwidXBkYXRlIiwib2JqZWN0SWQiLCJfX29wIiwiUHJvbWlzZSIsInJlc29sdmUiLCJtb3VudFJvdXRlcyIsInJvdXRlIiwiaGFuZGxlRmluZCIsImhhbmRsZUdldCIsImhhbmRsZUNyZWF0ZSIsImhhbmRsZVVwZGF0ZSIsImhhbmRsZURlbGV0ZSJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOzs7O0FBRU8sTUFBTUEsY0FBTixTQUE2QkMsc0JBQTdCLENBQTJDO0FBQ2hEQyxFQUFBQSxTQUFTLEdBQUc7QUFDVixXQUFPLFVBQVA7QUFDRDs7QUFFREMsRUFBQUEsUUFBUSxDQUFDQyxHQUFELEVBQU07QUFDWjtBQUNBLFFBQUksQ0FBQ0EsR0FBRyxDQUFDQyxJQUFMLElBQWEsQ0FBQ0QsR0FBRyxDQUFDQyxJQUFKLENBQVNDLFlBQTNCLEVBQXlDO0FBQ3ZDLFlBQU0sSUFBSUMsY0FBTUMsS0FBVixDQUFnQkQs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QUFuQixFQUFnQ3JDLEdBQUcsSUFBSTtBQUNyQyxhQUFPLEtBQUt3QyxZQUFMLENBQWtCeEMsR0FBbEIsQ0FBUDtBQUNELEtBRkQ7QUFHQSxTQUFLcUMsS0FBTCxDQUFXLEtBQVgsRUFBa0IscUJBQWxCLEVBQXlDckMsR0FBRyxJQUFJO0FBQzlDLGFBQU8sS0FBS3lDLFlBQUwsQ0FBa0J6QyxHQUFsQixDQUFQO0FBQ0QsS0FGRDtBQUdBLFNBQUtxQyxLQUFMLENBQVcsUUFBWCxFQUFxQixxQkFBckIsRUFBNENyQyxHQUFHLElBQUk7QUFDakQsYUFBTyxLQUFLMEMsWUFBTCxDQUFrQjFDLEdBQWxCLENBQVA7QUFDRCxLQUZEO0FBR0EsU0FBS3FDLEtBQUwsQ0FBVyxNQUFYLEVBQW1CLDRCQUFuQixFQUFpRHJDLEdBQUcsSUFBSTtBQUN0RCxhQUFPLEtBQUtrQiw4QkFBTCxDQUFvQ2xCLEdBQXBDLENBQVA7QUFDRCxLQUZEO0FBR0Q7O0FBdEYrQzs7O2VBeUZuQ0osYyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBDbGFzc2VzUm91dGVyIGZyb20gJy4vQ2xhc3Nlc1JvdXRlcic7XG5pbXBvcnQgUGFyc2UgZnJvbSAncGFyc2Uvbm9kZSc7XG5pbXBvcnQgcmVzdCBmcm9tICcuLi9yZXN0JztcbmltcG9ydCBBdXRoIGZyb20gJy4uL0F1dGgnO1xuaW1wb3J0IFJlc3RXcml0ZSBmcm9tICcuLi9SZXN0V3JpdGUnO1xuXG5leHBvcnQgY2xhc3MgU2Vzc2lvbnNSb3V0ZXIgZXh0ZW5kcyBDbGFzc2VzUm91dGVyIHtcbiAgY2xhc3NOYW1lKCkge1xuICAgIHJldHVybiAnX1Nlc3Npb24nO1xuICB9XG5cbiAgaGFuZGxlTWUocmVxKSB7XG4gICAgLy8gVE9ETzogVmVyaWZ5IGNvcnJlY3QgYmVoYXZpb3JcbiAgICBpZiAoIXJlcS5pbmZvIHx8ICFyZXEuaW5mby5zZXNzaW9uVG9rZW4pIHtcbiAgICAgIHRocm93IG5ldyBQYXJzZS5FcnJvcihQYXJzZS5FcnJvci5JTlZBTElEX1NFU1NJT05fVE9LRU4sICdTZXNzaW9uIHRva2VuIHJlcXVpcmVkLicpO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdFxuICAgICAgLmZpbmQoXG4gICAgICAgIHJlcS5jb25maWcsXG4gICAgICAgIEF1dGgubWFzdGVyKHJlcS5jb25maWcpLFxuICAgICAgICAnX1Nlc3Npb24nLFxuICAgICAgICB7IHNlc3Npb25Ub2tlbjogcmVxLmluZm8uc2Vzc2lvblRva2VuIH0sXG4gICAgICAgIHVuZGVmaW5lZCxcbiAgICAgICAgcmVxLmluZm8uY2xpZW50U0RLLFxuICAgICAgICByZXEuaW5mby5jb250ZXh0XG4gICAgICApXG4gICAgICAudGhlbihyZXNwb25zZSA9PiB7XG4gICAgICAgIGlmICghcmVzcG9uc2UucmVzdWx0cyB8fCByZXNwb25zZS5yZXN1bHRzLmxlbmd0aCA9PSAwKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IFBhcnNlLkVycm9yKFBhcnNlLkVycm9yLklOVkFMSURfU0VTU0lPTl9UT0tFTiwgJ1Nlc3Npb24gdG9rZW4gbm90IGZvdW5kLicpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgcmVzcG9uc2U6IHJlc3BvbnNlLnJlc3VsdHNbMF0sXG4gICAgICAgIH07XG4gICAgICB9KTtcbiAgfVxuXG4gIGhhbmRsZVVwZGF0ZVRvUmV2b2NhYmxlU2Vzc2lvbihyZXEpIHtcbiAgICBjb25zdCBjb25maWcgPSByZXEuY29uZmlnO1xuICAgIGNvbnN0IHVzZXIgPSByZXEuYXV0aC51c2VyO1xuICAgIC8vIElzc3VlICMyNzIwXG4gICAgLy8gQ2FsbGluZyB3aXRob3V0IGEgc2Vzc2lvbiB0b2tlbiB3b3VsZCByZXN1bHQgaW4gYSBub3QgZm91bmQgdXNlclxuICAgIGlmICghdXNlcikge1xuICAgICAgdGhyb3cgbmV3IFBhcnNlLkVycm9yKFBhcnNlLkVycm9yLk9CSkVDVF9OT1RfRk9VTkQsICdpbnZhbGlkIHNlc3Npb24nKTtcbiAgICB9XG4gICAgY29uc3QgeyBzZXNzaW9uRGF0YSwgY3JlYXRlU2Vzc2lvbiB9ID0gUmVzdFdyaXRlLmNyZWF0ZVNlc3Npb24oY29uZmlnLCB7XG4gICAgICB1c2VySWQ6IHVzZXIuaWQsXG4gICAgICBjcmVhdGVkV2l0aDoge1xuICAgICAgICBhY3Rpb246ICd1cGdyYWRlJyxcbiAgICAgIH0sXG4gICAgICBpbnN0YWxsYXRpb25JZDogcmVxLmF1dGguaW5zdGFsbGF0aW9uSWQsXG4gICAgfSk7XG5cbiAgICByZXR1cm4gY3JlYXRlU2Vzc2lvbigpXG4gICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgIC8vIGRlbGV0ZSB0aGUgc2Vzc2lvbiB0b2tlbiwgdXNlIHRoZSBkYiB0byBza2lwIGJlZm9yZVNhdmVcbiAgICAgICAgcmV0dXJuIGNvbmZpZy5kYXRhYmFzZS51cGRhdGUoXG4gICAgICAgICAgJ19Vc2VyJyxcbiAgICAgICAgICB7XG4gICAgICAgICAgICBvYmplY3RJZDogdXNlci5pZCxcbiAgICAgICAgICB9LFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIHNlc3Npb25Ub2tlbjogeyBfX29wOiAnRGVsZXRlJyB9LFxuICAgICAgICAgIH1cbiAgICAgICAgKTtcbiAgICAgIH0pXG4gICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoeyByZXNwb25zZTogc2Vzc2lvbkRhdGEgfSk7XG4gICAgICB9KTtcbiAgfVxuXG4gIG1vdW50Um91dGVzKCkge1xuICAgIHRoaXMucm91dGUoJ0dFVCcsICcvc2Vzc2lvbnMvbWUnLCByZXEgPT4ge1xuICAgICAgcmV0dXJuIHRoaXMuaGFuZGxlTWUocmVxKTtcbiAgICB9KTtcbiAgICB0aGlzLnJvdXRlKCdHRVQnLCAnL3Nlc3Npb25zJywgcmVxID0+IHtcbiAgICAgIHJldHVybiB0aGlzLmhhbmRsZUZpbmQocmVxKTtcbiAgICB9KTtcbiAgICB0aGlzLnJvdXRlKCdHRVQnLCAnL3Nlc3Npb25zLzpvYmplY3RJZCcsIHJlcSA9PiB7XG4gICAgICByZXR1cm4gdGhpcy5oYW5kbGVHZXQocmVxKTtcbiAgICB9KTtcbiAgICB0aGlzLnJvdXRlKCdQT1NUJywgJy9zZXNzaW9ucycsIHJlcSA9PiB7XG4gICAgICByZXR1cm4gdGhpcy5oYW5kbGVDcmVhdGUocmVxKTtcbiAgICB9KTtcbiAgICB0aGlzLnJvdXRlKCdQVVQnLCAnL3Nlc3Npb25zLzpvYmplY3RJZCcsIHJlcSA9PiB7XG4gICAgICByZXR1cm4gdGhpcy5oYW5kbGVVcGRhdGUocmVxKTtcbiAgICB9KTtcbiAgICB0aGlzLnJvdXRlKCdERUxFVEUnLCAnL3Nlc3Npb25zLzpvYmplY3RJZCcsIHJlcSA9PiB7XG4gICAgICByZXR1cm4gdGhpcy5oYW5kbGVEZWxldGUocmVxKTtcbiAgICB9KTtcbiAgICB0aGlzLnJvdXRlKCdQT1NUJywgJy91cGdyYWRlVG9SZXZvY2FibGVTZXNzaW9uJywgcmVxID0+IHtcbiAgICAgIHJldHVybiB0aGlzLmhhbmRsZVVwZGF0ZVRvUmV2b2NhYmxlU2Vzc2lvbihyZXEpO1xuICAgIH0pO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IFNlc3Npb25zUm91dGVyO1xuIl19
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9Sb3V0ZXJzL1Nlc3Npb25zUm91dGVyLmpzIl0sIm5hbWVzIjpbIkNsYXNzZXNSb3V0ZXIiLCJjbGFzc05hbWUiLCJoYW5kbGVNZSIsInJlcSIsIlBhcnNlIiwiQXV0aCIsInNlc3Npb25Ub2tlbiIsInJlc3BvbnNlIiwiaGFuZGxlVXBkYXRlVG9SZXZvY2FibGVTZXNzaW9uIiwiY29uZmlnIiwidXNlciIsImNyZWF0ZVNlc3Npb24iLCJ1c2VySWQiLCJjcmVhdGVkV2l0aCIsImFjdGlvbiIsImluc3RhbGxhdGlvbklkIiwib2JqZWN0SWQiLCJpZCIsIl9fb3AiLCJzZXNzaW9uRGF0YSIsIm1vdW50Um91dGVzIiwiU2Vzc2lvbnNSb3V0ZXIiXSwibWFwcGluZ3MiOiJpOVlBSUE7a1BBSkEsR0FBQSxDQUFBLGNBQUEsMEJBQUEsc0JBQUEsQ0FBQSxPQUFBLENBQUEsaUJBQUEsQ0FBQSxDQUFBLENBQUEsQ0FDQSxHQUFBLENBQUEsS0FBQSwwQkFBQSxzQkFBQSxDQUFBLE9BQUEsQ0FBQSxZQUFBLENBQUEsQ0FBQSxDQUFBLENBQ0EsR0FBQSxDQUFBLEtBQUEsMEJBQUEsc0JBQUEsQ0FBQSxPQUFBLENBQUEsU0FBQSxDQUFBLENBQUEsQ0FBQSxDQUNBLEdBQUEsQ0FBQSxLQUFBLDBCQUFBLHNCQUFBLENBQUEsT0FBQSxDQUFBLFNBQUEsQ0FBQSxDQUFBLENBQUEsQ0FDQSxHQUFBLENBQUEsVUFBQSwwQkFBQSxzQkFBQSxDQUFBLE9BQUEsQ0FBQSxjQUFBLENBQUEsQ0FBQSxDQUFBLEMsc1BBRU8sS0FBQSxDQUFBLGNBQUEsU0FBNkJBLGNBQUFBLENBQTdCLE9BQUEsQ0FBMkMsQ0FDaERDLFNBQVMsRUFBRyxpREFDVixNQUFBLFVBQUEsQ0FDRCxDQUVEQyxRQUFRLENBQUEsR0FBQSxDQUFNLGlEQUNaO0FBQ0EsR0FBSSw2QkFBQ0MsR0FBRyxDQUFKLElBQUEsK0JBQWEsQ0FBQ0EsR0FBRyxDQUFIQSxJQUFBQSxDQUFsQixZQUFJLENBQUosQ0FB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QUFBLENBQVAsR0FBTyxDQUFQLENBREYsQ0FBQSxFQUpZLHlCQU9aLEtBQUEsS0FBQSxDQUFBLEtBQUEsQ0FBQSxxQkFBQSxDQUF5Q0EsR0FBRyxFQUFJLG1EQUM5QyxNQUFPLE1BQUEsU0FBQSxDQUFQLEdBQU8sQ0FBUCxDQURGLENBQUEsRUFQWSx5QkFVWixLQUFBLEtBQUEsQ0FBQSxNQUFBLENBQUEsV0FBQSxDQUFnQ0EsR0FBRyxFQUFJLG1EQUNyQyxNQUFPLE1BQUEsWUFBQSxDQUFQLEdBQU8sQ0FBUCxDQURGLENBQUEsRUFWWSx5QkFhWixLQUFBLEtBQUEsQ0FBQSxLQUFBLENBQUEscUJBQUEsQ0FBeUNBLEdBQUcsRUFBSSxtREFDOUMsTUFBTyxNQUFBLFlBQUEsQ0FBUCxHQUFPLENBQVAsQ0FERixDQUFBLEVBYlkseUJBZ0JaLEtBQUEsS0FBQSxDQUFBLFFBQUEsQ0FBQSxxQkFBQSxDQUE0Q0EsR0FBRyxFQUFJLG1EQUNqRCxNQUFPLE1BQUEsWUFBQSxDQUFQLEdBQU8sQ0FBUCxDQURGLENBQUEsRUFoQlkseUJBbUJaLEtBQUEsS0FBQSxDQUFBLE1BQUEsQ0FBQSw0QkFBQSxDQUFpREEsR0FBRyxFQUFJLG1EQUN0RCxNQUFPLE1BQUEsOEJBQUEsQ0FBUCxHQUFPLENBQVAsQ0FERixDQUFBLEVBR0QsQ0F0RitDLEMsc0dBeUZuQ2tCLGMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgQ2xhc3Nlc1JvdXRlciBmcm9tICcuL0NsYXNzZXNSb3V0ZXInO1xuaW1wb3J0IFBhcnNlIGZyb20gJ3BhcnNlL25vZGUnO1xuaW1wb3J0IHJlc3QgZnJvbSAnLi4vcmVzdCc7XG5pbXBvcnQgQXV0aCBmcm9tICcuLi9BdXRoJztcbmltcG9ydCBSZXN0V3JpdGUgZnJvbSAnLi4vUmVzdFdyaXRlJztcblxuZXhwb3J0IGNsYXNzIFNlc3Npb25zUm91dGVyIGV4dGVuZHMgQ2xhc3Nlc1JvdXRlciB7XG4gIGNsYXNzTmFtZSgpIHtcbiAgICByZXR1cm4gJ19TZXNzaW9uJztcbiAgfVxuXG4gIGhhbmRsZU1lKHJlcSkge1xuICAgIC8vIFRPRE86IFZlcmlmeSBjb3JyZWN0IGJlaGF2aW9yXG4gICAgaWYgKCFyZXEuaW5mbyB8fCAhcmVxLmluZm8uc2Vzc2lvblRva2VuKSB7XG4gICAgICB0aHJvdyBuZXcgUGFyc2UuRXJyb3IoUGFyc2UuRXJyb3IuSU5WQUxJRF9TRVNTSU9OX1RPS0VOLCAnU2Vzc2lvbiB0b2tlbiByZXF1aXJlZC4nKTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3RcbiAgICAgIC5maW5kKFxuICAgICAgICByZXEuY29uZmlnLFxuICAgICAgICBBdXRoLm1hc3RlcihyZXEuY29uZmlnKSxcbiAgICAgICAgJ19TZXNzaW9uJyxcbiAgICAgICAgeyBzZXNzaW9uVG9rZW46IHJlcS5pbmZvLnNlc3Npb25Ub2tlbiB9LFxuICAgICAgICB1bmRlZmluZWQsXG4gICAgICAgIHJlcS5pbmZvLmNsaWVudFNESyxcbiAgICAgICAgcmVxLmluZm8uY29udGV4dFxuICAgICAgKVxuICAgICAgLnRoZW4ocmVzcG9uc2UgPT4ge1xuICAgICAgICBpZiAoIXJlc3BvbnNlLnJlc3VsdHMgfHwgcmVzcG9uc2UucmVzdWx0cy5sZW5ndGggPT0gMCkge1xuICAgICAgICAgIHRocm93IG5ldyBQYXJzZS5FcnJvcihQYXJzZS5FcnJvci5JTlZBTElEX1NFU1NJT05fVE9LRU4sICdTZXNzaW9uIHRva2VuIG5vdCBmb3VuZC4nKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHJlc3BvbnNlOiByZXNwb25zZS5yZXN1bHRzWzBdLFxuICAgICAgICB9O1xuICAgICAgfSk7XG4gIH1cblxuICBoYW5kbGVVcGRhdGVUb1Jldm9jYWJsZVNlc3Npb24ocmVxKSB7XG4gICAgY29uc3QgY29uZmlnID0gcmVxLmNvbmZpZztcbiAgICBjb25zdCB1c2VyID0gcmVxLmF1dGgudXNlcjtcbiAgICAvLyBJc3N1ZSAjMjcyMFxuICAgIC8vIENhbGxpbmcgd2l0aG91dCBhIHNlc3Npb24gdG9rZW4gd291bGQgcmVzdWx0IGluIGEgbm90IGZvdW5kIHVzZXJcbiAgICBpZiAoIXVzZXIpIHtcbiAgICAgIHRocm93IG5ldyBQYXJzZS5FcnJvcihQYXJzZS5FcnJvci5PQkpFQ1RfTk9UX0ZPVU5ELCAnaW52YWxpZCBzZXNzaW9uJyk7XG4gICAgfVxuICAgIGNvbnN0IHsgc2Vzc2lvbkRhdGEsIGNyZWF0ZVNlc3Npb24gfSA9IFJlc3RXcml0ZS5jcmVhdGVTZXNzaW9uKGNvbmZpZywge1xuICAgICAgdXNlcklkOiB1c2VyLmlkLFxuICAgICAgY3JlYXRlZFdpdGg6IHtcbiAgICAgICAgYWN0aW9uOiAndXBncmFkZScsXG4gICAgICB9LFxuICAgICAgaW5zdGFsbGF0aW9uSWQ6IHJlcS5hdXRoLmluc3RhbGxhdGlvbklkLFxuICAgIH0pO1xuXG4gICAgcmV0dXJuIGNyZWF0ZVNlc3Npb24oKVxuICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICAvLyBkZWxldGUgdGhlIHNlc3Npb24gdG9rZW4sIHVzZSB0aGUgZGIgdG8gc2tpcCBiZWZvcmVTYXZlXG4gICAgICAgIHJldHVybiBjb25maWcuZGF0YWJhc2UudXBkYXRlKFxuICAgICAgICAgICdfVXNlcicsXG4gICAgICAgICAge1xuICAgICAgICAgICAgb2JqZWN0SWQ6IHVzZXIuaWQsXG4gICAgICAgICAgfSxcbiAgICAgICAgICB7XG4gICAgICAgICAgICBzZXNzaW9uVG9rZW46IHsgX19vcDogJ0RlbGV0ZScgfSxcbiAgICAgICAgICB9XG4gICAgICAgICk7XG4gICAgICB9KVxuICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHsgcmVzcG9uc2U6IHNlc3Npb25EYXRhIH0pO1xuICAgICAgfSk7XG4gIH1cblxuICBtb3VudFJvdXRlcygpIHtcbiAgICB0aGlzLnJvdXRlKCdHRVQnLCAnL3Nlc3Npb25zL21lJywgcmVxID0+IHtcbiAgICAgIHJldHVybiB0aGlzLmhhbmRsZU1lKHJlcSk7XG4gICAgfSk7XG4gICAgdGhpcy5yb3V0ZSgnR0VUJywgJy9zZXNzaW9ucycsIHJlcSA9PiB7XG4gICAgICByZXR1cm4gdGhpcy5oYW5kbGVGaW5kKHJlcSk7XG4gICAgfSk7XG4gICAgdGhpcy5yb3V0ZSgnR0VUJywgJy9zZXNzaW9ucy86b2JqZWN0SWQnLCByZXEgPT4ge1xuICAgICAgcmV0dXJuIHRoaXMuaGFuZGxlR2V0KHJlcSk7XG4gICAgfSk7XG4gICAgdGhpcy5yb3V0ZSgnUE9TVCcsICcvc2Vzc2lvbnMnLCByZXEgPT4ge1xuICAgICAgcmV0dXJuIHRoaXMuaGFuZGxlQ3JlYXRlKHJlcSk7XG4gICAgfSk7XG4gICAgdGhpcy5yb3V0ZSgnUFVUJywgJy9zZXNzaW9ucy86b2JqZWN0SWQnLCByZXEgPT4ge1xuICAgICAgcmV0dXJuIHRoaXMuaGFuZGxlVXBkYXRlKHJlcSk7XG4gICAgfSk7XG4gICAgdGhpcy5yb3V0ZSgnREVMRVRFJywgJy9zZXNzaW9ucy86b2JqZWN0SWQnLCByZXEgPT4ge1xuICAgICAgcmV0dXJuIHRoaXMuaGFuZGxlRGVsZXRlKHJlcSk7XG4gICAgfSk7XG4gICAgdGhpcy5yb3V0ZSgnUE9TVCcsICcvdXBncmFkZVRvUmV2b2NhYmxlU2Vzc2lvbicsIHJlcSA9PiB7XG4gICAgICByZXR1cm4gdGhpcy5oYW5kbGVVcGRhdGVUb1Jldm9jYWJsZVNlc3Npb24ocmVxKTtcbiAgICB9KTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBTZXNzaW9uc1JvdXRlcjtcbiJdfQ==