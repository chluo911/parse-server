"use strict";// Helper functions for accessing the qq Graph API.
function cov_xrewq73bh(){var path="/parse-server/lib/Adapters/Auth/qq.js";var hash="acd49f2a9cbee300633c9e9c223c9b0150f39108";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/parse-server/lib/Adapters/Auth/qq.js",statementMap:{"0":{start:{line:4,column:21},end:{line:4,column:46}},"1":{start:{line:6,column:12},end:{line:6,column:39}},"2":{start:{line:10,column:2},end:{line:16,column:5}},"3":{start:{line:11,column:4},end:{line:13,column:5}},"4":{start:{line:12,column:6},end:{line:12,column:13}},"5":{start:{line:15,column:4},end:{line:15,column:93}},"6":{start:{line:21,column:2},end:{line:21,column:27}},"7":{start:{line:26,column:2},end:{line:28,column:5}},"8":{start:{line:27,column:4},end:{line:27,column:35}},"9":{start:{line:32,column:18},end:{line:32,column:35}},"10":{start:{line:33,column:17},end:{line:33,column:34}},"11":{start:{line:35,column:2},end:{line:37,column:3}},"12":{start:{line:36,column:4},end:{line:36,column:93}},"13":{start:{line:39,column:2},end:{line:39,column:49}},"14":{start:{line:40,column:2},end:{line:40,column:26}},"15":{start:{line:43,column:0},end:{line:47,column:2}}},fnMap:{"0":{name:"validateAuthData",decl:{start:{line:9,column:9},end:{line:9,column:25}},loc:{start:{line:9,column:36},end:{line:17,column:1}},line:9},"1":{name:"(anonymous_1)",decl:{start:{line:10,column:71},end:{line:10,column:72}},loc:{start:{line:10,column:87},end:{line:16,column:3}},line:10},"2":{name:"validateAppId",decl:{start:{line:20,column:9},end:{line:20,column:22}},loc:{start:{line:20,column:25},end:{line:22,column:1}},line:20},"3":{name:"graphRequest",decl:{start:{line:25,column:9},end:{line:25,column:21}},loc:{start:{line:25,column:28},end:{line:29,column:1}},line:25},"4":{name:"(anonymous_4)",decl:{start:{line:26,column:78},end:{line:26,column:79}},loc:{start:{line:26,column:86},end:{line:28,column:3}},line:26},"5":{name:"parseResponseData",decl:{start:{line:31,column:9},end:{line:31,column:26}},loc:{start:{line:31,column:33},end:{line:41,column:1}},line:31}},branchMap:{"0":{loc:{start:{line:11,column:4},end:{line:13,column:5}},type:"if",locations:[{start:{line:11,column:4},end:{line:13,column:5}},{start:{line:11,column:4},end:{line:13,column:5}}],line:11},"1":{loc:{start:{line:11,column:8},end:{line:11,column:42}},type:"binary-expr",locations:[{start:{line:11,column:8},end:{line:11,column:12}},{start:{line:11,column:16},end:{line:11,column:42}}],line:11},"2":{loc:{start:{line:35,column:2},end:{line:37,column:3}},type:"if",locations:[{start:{line:35,column:2},end:{line:37,column:3}},{start:{line:35,column:2},end:{line:37,column:3}}],line:35},"3":{loc:{start:{line:35,column:6},end:{line:35,column:35}},type:"binary-expr",locations:[{start:{line:35,column:6},end:{line:35,column:19}},{start:{line:35,column:23},end:{line:35,column:35}}],line:35}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0]},inputSourceMap:{version:3,sources:["../../../src/Adapters/Auth/qq.js"],names:["httpsRequest","require","Parse","validateAuthData","authData","graphRequest","access_token","then","data","openid","id","Error","OBJECT_NOT_FOUND","validateAppId","Promise","resolve","path","get","parseResponseData","starPos","indexOf","endPos","substring","JSON","parse","module","exports"],mappings:";;AAAA;AACA,MAAMA,YAAY,GAAGC,OAAO,CAAC,gBAAD,CAA5B;;AACA,IAAIC,KAAK,GAAGD,OAAO,CAAC,YAAD,CAAP,CAAsBC,KAAlC,C,CAEA;;;AACA,SAASC,gBAAT,CAA0BC,QAA1B,EAAoC;AAClC,SAAOC,YAAY,CAAC,qBAAqBD,QAAQ,CAACE,YAA/B,CAAZ,CAAyDC,IAAzD,CAA8D,UAAUC,IAAV,EAAgB;AACnF,QAAIA,IAAI,IAAIA,IAAI,CAACC,MAAL,IAAeL,QAAQ,CAACM,EAApC,EAAwC;AACtC;AACD;;AACD,UAAM,IAAIR,KAAK,CAACS,KAAV,CAAgBT,KAAK,CAACS,KAAN,CAAYC,gBAA5B,EAA8C,mCAA9C,CAAN;AACD,GALM,CAAP;AAMD,C,CAED;;;AACA,SAASC,aAAT,GAAyB;AACvB,SAAOC,OAAO,CAACC,OAAR,EAAP;AACD,C,CAED;;;AACA,SAASV,YAAT,CAAsBW,IAAtB,EAA4B;AAC1B,SAAOhB,YAAY,CAACiB,GAAb,CAAiB,mCAAmCD,IAApD,EAA0D,IAA1D,EAAgET,IAAhE,CAAqEC,IAAI,IAAI;AAClF,WAAOU,iBAAiB,CAACV,IAAD,CAAxB;AACD,GAFM,CAAP;AAGD;;AAED,SAASU,iBAAT,CAA2BV,IAA3B,EAAiC;AAC/B,QAAMW,OAAO,GAAGX,IAAI,CAACY,OAAL,CAAa,GAAb,CAAhB;AACA,QAAMC,MAAM,GAAGb,IAAI,CAACY,OAAL,CAAa,GAAb,CAAf;;AACA,MAAID,OAAO,IAAI,CAAC,CAAZ,IAAiBE,MAAM,IAAI,CAAC,CAAhC,EAAmC;AACjC,UAAM,IAAInB,KAAK,CAACS,KAAV,CAAgBT,KAAK,CAACS,KAAN,CAAYC,gBAA5B,EAA8C,mCAA9C,CAAN;AACD;;AACDJ,EAAAA,IAAI,GAAGA,IAAI,CAACc,SAAL,CAAeH,OAAO,GAAG,CAAzB,EAA4BE,MAAM,GAAG,CAArC,CAAP;AACA,SAAOE,IAAI,CAACC,KAAL,CAAWhB,IAAX,CAAP;AACD;;AAEDiB,MAAM,CAACC,OAAP,GAAiB;AACfb,EAAAA,aADe;AAEfV,EAAAA,gBAFe;AAGfe,EAAAA;AAHe,CAAjB",sourcesContent:["// Helper functions for accessing the qq Graph API.\nconst httpsRequest = require('./httpsRequest');\nvar Parse = require('parse/node').Parse;\n\n// Returns a promise that fulfills iff this user id is valid.\nfunction validateAuthData(authData) {\n  return graphRequest('me?access_token=' + authData.access_token).then(function (data) {\n    if (data && data.openid == authData.id) {\n      return;\n    }\n    throw new Parse.Error(Parse.Error.OBJECT_NOT_FOUND, 'qq auth is invalid for this user.');\n  });\n}\n\n// Returns a promise that fulfills if this app id is valid.\nfunction validateAppId() {\n  return Promise.resolve();\n}\n\n// A promisey wrapper for qq graph requests.\nfunction graphRequest(path) {\n  return httpsRequest.get('https://graph.qq.com/oauth2.0/' + path, true).then(data => {\n    return parseResponseData(data);\n  });\n}\n\nfunction parseResponseData(data) {\n  const starPos = data.indexOf('(');\n  const endPos = data.indexOf(')');\n  if (starPos == -1 || endPos == -1) {\n    throw new Parse.Error(Parse.Error.OBJECT_NOT_FOUND, 'qq auth is invalid for this user.');\n  }\n  data = data.substring(starPos + 1, endPos - 1);\n  return JSON.parse(data);\n}\n\nmodule.exports = {\n  validateAppId,\n  validateAuthData,\n  parseResponseData,\n};\n"]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"acd49f2a9cbee300633c9e9c223c9b0150f39108"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_xrewq73bh=function(){return actualCoverage;};}return actualCoverage;}cov_xrewq73bh();const httpsRequest=(cov_xrewq73bh().s[0]++,require('./httpsRequest'));var Parse=(cov_xrewq73bh().s[1]++,require('parse/node').Parse);// Returns a promise that fulfills iff this user id is valid.
function validateAuthData(authData){cov_xrewq73bh().f[0]++;cov_xrewq73bh().s[2]++;return graphRequest('me?access_token='+authData.access_token).then(function(data){cov_xrewq73bh().f[1]++;cov_xrewq73bh().s[3]++;if((cov_xrewq73bh().b[1][0]++,data)&&(cov_xrewq73bh().b[1][1]++,data.openid==authData.id)){cov_xrewq73bh().b[0][0]++;cov_xrewq73bh().s[4]++;return;}else{cov_xrewq73bh().b[0][1]++;}cov_xrewq73bh().s[5]++;throw new Parse.Error(Parse.Error.OBJECT_NOT_FOUND,'qq auth is invalid for this user.');});}// Returns a promise that fulfills if this app id is valid.
function validateAppId(){cov_xrewq73bh().f[2]++;cov_xrewq73bh().s[6]++;return Promise.resolve();}// A promisey wrapper for qq graph requests.
function graphRequest(path){cov_xrewq73bh().f[3]++;cov_xrewq73bh().s[7]++;return httpsRequest.get('https://graph.qq.com/oauth2.0/'+path,true).then(data=>{cov_xrewq73bh().f[4]++;cov_xrewq73bh().s[8]++;return parseResponseData(data);});}function parseResponseData(data){cov_xrewq73bh().f[5]++;const starPos=(cov_xrewq73bh().s[9]++,data.indexOf('('));const endPos=(cov_xrewq73bh().s[10]++,data.indexOf(')'));cov_xrewq73bh().s[11]++;if((cov_xrewq73bh().b[3][0]++,starPos==-1)||(cov_xrewq73bh().b[3][1]++,endPos==-1)){cov_xrewq73bh().b[2][0]++;cov_xrewq73bh().s[12]++;throw new Parse.Error(Parse.Error.OBJECT_NOT_FOUND,'qq auth is invalid for this user.');}else{cov_xrewq73bh().b[2][1]++;}cov_xrewq73bh().s[13]++;data=data.substring(starPos+1,endPos-1);cov_xrewq73bh().s[14]++;return JSON.parse(data);}cov_xrewq73bh().s[15]++;module.exports={validateAppId,validateAuthData,parseResponseData};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9BZGFwdGVycy9BdXRoL3FxLmpzIl0sIm5hbWVzIjpbImh0dHBzUmVxdWVzdCIsInJlcXVpcmUiLCJQYXJzZSIsInZhbGlkYXRlQXV0aERhdGEiLCJhdXRoRGF0YSIsImdyYXBoUmVxdWVzdCIsImFjY2Vzc190b2tlbiIsInRoZW4iLCJkYXRhIiwib3BlbmlkIiwiaWQiLCJFcnJvciIsIk9CSkVDVF9OT1RfRk9VTkQiLCJ2YWxpZGF0ZUFwcElkIiwiUHJvbWlzZSIsInJlc29sdmUiLCJwYXRoIiwiZ2V0IiwicGFyc2VSZXNwb25zZURhdGEiLCJzdGFyUG9zIiwiaW5kZXhPZiIsImVuZFBvcyIsInN1YnN0cmluZyIsIkpTT04iLCJwYXJzZSIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiI7O0FBQUE7QUFDQSxNQUFNQSxZQUFZLEdBQUdDLE9BQU8sQ0FBQyxnQkFBRCxDQUE1Qjs7QUFDQSxJQUFJQyxLQUFLLEdBQUdELE9BQU8sQ0FBQyxZQUFELENBQVAsQ0FBc0JDLEtBQWxDLEMsQ0FFQTs7O0FBQ0EsU0FBU0MsZ0JBQVQsQ0FBMEJDLFFBQTFCLEVBQW9DO0FBQ2xDLFNBQU9DLFlBQVksQ0FBQyxxQkFBcUJELFFBQVEsQ0FBQ0UsWUFBL0IsQ0FBWixDQUF5REMsSUFBekQsQ0FBOEQsVUFBVUMsSUFBVixFQUFnQjtBQUNuRixRQUFJQSxJQUFJLElBQUlBLElBQUksQ0FBQ0MsTUFBTCxJQUFlTCxRQUFRLENBQUNNLEVBQXBDLEVBQXdDO0FBQ3RDO0FBQ0Q7O0FBQ0QsVUFBTSxJQUFJUixLQUFLLENBQUNTLEtBQVYsQ0FBZ0JULEtBQUssQ0FBQ1MsS0FBTixDQUFZQyxnQkFBNUIsRUFBOEMsbUNBQTlDLENBQU47QUFDRCxHQUxNLENBQVA7QUFNRCxDLENBRUQ7OztBQUNBLFNBQVNDLGFBQVQsR0FBeUI7QUFDdkIsU0FBT0MsT0FBTyxDQUFDQyxPQUFSLEVBQVA7QUFDRCxDLENBRUQ7OztBQUNBLFNBQVNWLFlBQVQsQ0FBc0JXLElBQXRCLEVBQTRCO0FBQzFCLFNBQU9oQixZQUFZLENBQUNpQixHQUFiLENBQWlCLG1DQUFtQ0QsSUFBcEQsRUFBMEQsSUFBMUQsRUFBZ0VULElBQWhFLENBQXFFQyxJQUFJLElBQUk7QUFDbEYsV0FBT1UsaUJBQWlCLENBQUNWLElBQUQsQ0FBeEI7QUFDRCxHQUZNLENBQVA7QUFHRDs7QUFFRCxTQUFTVSxpQkFBVCxDQUEyQlYsSUFBM0IsRUFBaUM7QUFDL0IsUUFBTVcsT0FBTyxHQUFHWCxJQUFJLENBQUNZLE9BQUwsQ0FBYSxHQUFiLENBQWhCO0FBQ0EsUUFBTUMsTUFBTSxHQUFHYixJQUFJLENBQUNZLE9BQUwsQ0FBYSxHQUFiLENBQWY7O0FBQ0EsTUFBSUQsT0FBTyxJQUFJLENBQUMsQ0FBWixJQUFpQkUsTUFBTSxJQUFJLENBQUMsQ0FBaEMsRUFBbUM7QUFDakMsVUFBTSxJQUFJbkIsS0FBSyxDQUFDUyxLQUFWLENBQWdCVCxLQUFLLENBQUNTLEtBQU4sQ0FBWUMsZ0JBQTVCLEVBQThDLG1DQUE5QyxDQUFOO0FBQ0Q7O0FBQ0RKLEVBQUFBLElBQUksR0FBR0EsSUFBSSxDQUFDYyxTQUFMLENBQWVILE9BQU8sR0FBRyxDQUF6QixFQUE0QkUsTUFBTSxHQUFHLENBQXJDLENBQVA7QUFDQSxTQUFPRSxJQUFJLENBQUNDLEtBQUwsQ0FBV2hCLElBQVgsQ0FBUDtBQUNEOztBQUVEaUIsTUFBTSxDQUFDQyxPQUFQLEdBQWlCO0FBQ2ZiLEVBQUFBLGFBRGU7QUFFZlYsRUFBQUEsZ0JBRmU7QUFHZmUsRUFBQUE7QUFIZSxDQUFqQiIsInNvdXJjZXNDb250ZW50IjpbIi8vIEhlbHBlciBmdW5jdGlvbnMgZm9yIGFjY2Vzc2luZyB0aGUgcXEgR3JhcGggQVBJLlxuY29uc3QgaHR0cHNSZXF1ZXN0ID0gcmVxdWlyZSgnLi9odHRwc1JlcXVlc3QnKTtcbnZhciBQYXJzZSA9IHJlcXVpcmUoJ3BhcnNlL25vZGUnKS5QYXJzZTtcblxuLy8gUmV0dXJucyBhIHByb21pc2UgdGhhdCBmdWxmaWxscyBpZmYgdGhpcyB1c2VyIGlkIGlzIHZhbGlkLlxuZnVuY3Rpb24gdmFsaWRhdGVBdXRoRGF0YShhdXRoRGF0YSkge1xuICByZXR1cm4gZ3JhcGhSZXF1ZXN0KCdtZT9hY2Nlc3NfdG9rZW49JyArIGF1dGhEYXRhLmFjY2Vzc190b2tlbikudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgIGlmIChkYXRhICYmIGRhdGEub3BlbmlkID09IGF1dGhEYXRhLmlkKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRocm93IG5ldyBQYXJzZS5FcnJvcihQYXJzZS5FcnJvci5PQkpFQ1RfTk9UX0ZPVU5ELCAncXEgYXV0aCBpcyBpbnZhbGlkIGZvciB0aGlzIHVzZXIuJyk7XG4gIH0pO1xufVxuXG4vLyBSZXR1cm5zIGEgcHJvbWlzZSB0aGF0IGZ1bGZpbGxzIGlmIHRoaXMgYXBwIGlkIGlzIHZhbGlkLlxuZnVuY3Rpb24gdmFsaWRhdGVBcHBJZCgpIHtcbiAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xufVxuXG4vLyBBIHByb21pc2V5IHdyYXBwZXIgZm9yIHFxIGdyYXBoIHJlcXVlc3RzLlxuZnVuY3Rpb24gZ3JhcGhSZXF1ZXN0KHBhdGgpIHtcbiAgcmV0dXJuIGh0dHBzUmVxdWVzdC5nZXQoJ2h0dHBzOi8vZ3JhcGgucXEuY29tL29hdXRoMi4wLycgKyBwYXRoLCB0cnVlKS50aGVuKGRhdGEgPT4ge1xuICAgIHJldHVybiBwYXJzZVJlc3BvbnNlRGF0YShkYXRhKTtcbiAgfSk7XG59XG5cbmZ1bmN0aW9uIHBhcnNlUmVzcG9uc2VEYXRhKGRhdGEpIHtcbiAgY29uc3Qgc3RhclBvcyA9IGRhdGEuaW5kZXhPZignKCcpO1xuICBjb25zdCBlbmRQb3MgPSBkYXRhLmluZGV4T2YoJyknKTtcbiAgaWYgKHN0YXJQb3MgPT0gLTEgfHwgZW5kUG9zID09IC0xKSB7XG4gICAgdGhyb3cgbmV3IFBhcnNlLkVycm9yKFBhcnNlLkVycm9yLk9CSkVDVF9OT1RfRk9VTkQsICdxcSBhdXRoIGlzIGludmFsaWQgZm9yIHRoaXMgdXNlci4nKTtcbiAgfVxuICBkYXRhID0gZGF0YS5zdWJzdHJpbmcoc3RhclBvcyArIDEsIGVuZFBvcyAtIDEpO1xuICByZXR1cm4gSlNPTi5wYXJzZShkYXRhKTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSB7XG4gIHZhbGlkYXRlQXBwSWQsXG4gIHZhbGlkYXRlQXV0aERhdGEsXG4gIHBhcnNlUmVzcG9uc2VEYXRhLFxufTtcbiJdfQ==
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9BZGFwdGVycy9BdXRoL3FxLmpzIl0sIm5hbWVzIjpbImh0dHBzUmVxdWVzdCIsInJlcXVpcmUiLCJQYXJzZSIsImF1dGhEYXRhIiwiZGF0YSIsIlByb21pc2UiLCJwYXJzZVJlc3BvbnNlRGF0YSIsInN0YXJQb3MiLCJlbmRQb3MiLCJKU09OIiwibW9kdWxlIl0sIm1hcHBpbmdzIjoiYUFBQTtxaU1BTUU7eUZBTEYsS0FBTUEsQ0FBQUEsWUFBWSx5QkFBR0MsT0FBTyxDQUE1QixnQkFBNEIsQ0FBVixDQUFsQixDQUNBLEdBQUlDLENBQUFBLEtBQUsseUJBQUdELE9BQU8sQ0FBUEEsWUFBTyxDQUFQQSxDQUFaLEtBQVMsQ0FBVCxDQUVBO0FBQ0EsUUFBQSxDQUFBLGdCQUFBLENBQUEsUUFBQSxDQUFvQywrQ0FDbEMsTUFBTyxDQUFBLFlBQVksQ0FBQyxtQkFBcUJFLFFBQVEsQ0FBMUMsWUFBWSxDQUFaLENBQUEsSUFBQSxDQUE4RCxTQUFBLElBQUEsQ0FBZ0IsK0NBQ25GLEdBQUlDLDJCQUFBQSxJQUFJLDhCQUFJQSxJQUFJLENBQUpBLE1BQUFBLEVBQWVELFFBQVEsQ0FBbkMsRUFBUSxDQUFSLENBQXdDLGtEQUN0QyxPQUNELENBRkQsZ0NBRG1GLHVCQUluRixLQUFNLElBQUlELENBQUFBLEtBQUssQ0FBVCxLQUFBLENBQWdCQSxLQUFLLENBQUxBLEtBQUFBLENBQWhCLGdCQUFBLENBQU4sbUNBQU0sQ0FBTixDQUpGLENBQU8sQ0FBUCxDLENBUUY7QUFDQSxRQUFBLENBQUEsYUFBQSxFQUF5QiwrQ0FDdkIsTUFBT0csQ0FBQUEsT0FBTyxDQUFkLE9BQU9BLEVBQVAsQyxDQUdGO0FBQ0EsUUFBQSxDQUFBLFlBQUEsQ0FBQSxJQUFBLENBQTRCLCtDQUMxQixNQUFPLENBQUEsWUFBWSxDQUFaLEdBQUEsQ0FBaUIsaUNBQWpCLElBQUEsQ0FBQSxJQUFBLEVBQUEsSUFBQSxDQUFxRUQsSUFBSSxFQUFJLCtDQUNsRixNQUFPRSxDQUFBQSxpQkFBaUIsQ0FBeEIsSUFBd0IsQ0FBeEIsQ0FERixDQUFPLENBQVAsQ0FHRCxDQUVELFFBQUEsQ0FBQSxpQkFBQSxDQUFBLElBQUEsQ0FBaUMsd0JBQy9CLEtBQU1DLENBQUFBLE9BQU8seUJBQUdILElBQUksQ0FBSkEsT0FBQUEsQ0FBaEIsR0FBZ0JBLENBQUgsQ0FBYixDQUNBLEtBQU1JLENBQUFBLE1BQU0sMEJBQUdKLElBQUksQ0FBSkEsT0FBQUEsQ0FBZixHQUFlQSxDQUFILENBQVosQ0FGK0Isd0JBRy9CLEdBQUlHLDJCQUFBQSxPQUFPLEVBQUksQ0FBWEEsQ0FBQUEsOEJBQWlCQyxNQUFNLEVBQUksQ0FBL0IsQ0FBSUQsQ0FBSixDQUFtQyxtREFDakMsS0FBTSxJQUFJTCxDQUFBQSxLQUFLLENBQVQsS0FBQSxDQUFnQkEsS0FBSyxDQUFMQSxLQUFBQSxDQUFoQixnQkFBQSxDQUFOLG1DQUFNLENBQU4sQ0FDRCxDQUZELGdDQUgrQix3QkFNL0JFLElBQUksQ0FBR0EsSUFBSSxDQUFKQSxTQUFBQSxDQUFlRyxPQUFPLENBQXRCSCxDQUFBQSxDQUE0QkksTUFBTSxDQUF6Q0osQ0FBT0EsQ0FBUEEsQ0FOK0Isd0JBTy9CLE1BQU9LLENBQUFBLElBQUksQ0FBSkEsS0FBQUEsQ0FBUCxJQUFPQSxDQUFQLENBQ0QsQyx3QkFFREMsTUFBTSxDQUFOQSxPQUFBQSxDQUFpQixDQUFBLGFBQUEsQ0FBQSxnQkFBQSxDQUdmSixpQkFIZSxDQUFqQkksQyIsInNvdXJjZXNDb250ZW50IjpbIi8vIEhlbHBlciBmdW5jdGlvbnMgZm9yIGFjY2Vzc2luZyB0aGUgcXEgR3JhcGggQVBJLlxuY29uc3QgaHR0cHNSZXF1ZXN0ID0gcmVxdWlyZSgnLi9odHRwc1JlcXVlc3QnKTtcbnZhciBQYXJzZSA9IHJlcXVpcmUoJ3BhcnNlL25vZGUnKS5QYXJzZTtcblxuLy8gUmV0dXJucyBhIHByb21pc2UgdGhhdCBmdWxmaWxscyBpZmYgdGhpcyB1c2VyIGlkIGlzIHZhbGlkLlxuZnVuY3Rpb24gdmFsaWRhdGVBdXRoRGF0YShhdXRoRGF0YSkge1xuICByZXR1cm4gZ3JhcGhSZXF1ZXN0KCdtZT9hY2Nlc3NfdG9rZW49JyArIGF1dGhEYXRhLmFjY2Vzc190b2tlbikudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgIGlmIChkYXRhICYmIGRhdGEub3BlbmlkID09IGF1dGhEYXRhLmlkKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRocm93IG5ldyBQYXJzZS5FcnJvcihQYXJzZS5FcnJvci5PQkpFQ1RfTk9UX0ZPVU5ELCAncXEgYXV0aCBpcyBpbnZhbGlkIGZvciB0aGlzIHVzZXIuJyk7XG4gIH0pO1xufVxuXG4vLyBSZXR1cm5zIGEgcHJvbWlzZSB0aGF0IGZ1bGZpbGxzIGlmIHRoaXMgYXBwIGlkIGlzIHZhbGlkLlxuZnVuY3Rpb24gdmFsaWRhdGVBcHBJZCgpIHtcbiAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xufVxuXG4vLyBBIHByb21pc2V5IHdyYXBwZXIgZm9yIHFxIGdyYXBoIHJlcXVlc3RzLlxuZnVuY3Rpb24gZ3JhcGhSZXF1ZXN0KHBhdGgpIHtcbiAgcmV0dXJuIGh0dHBzUmVxdWVzdC5nZXQoJ2h0dHBzOi8vZ3JhcGgucXEuY29tL29hdXRoMi4wLycgKyBwYXRoLCB0cnVlKS50aGVuKGRhdGEgPT4ge1xuICAgIHJldHVybiBwYXJzZVJlc3BvbnNlRGF0YShkYXRhKTtcbiAgfSk7XG59XG5cbmZ1bmN0aW9uIHBhcnNlUmVzcG9uc2VEYXRhKGRhdGEpIHtcbiAgY29uc3Qgc3RhclBvcyA9IGRhdGEuaW5kZXhPZignKCcpO1xuICBjb25zdCBlbmRQb3MgPSBkYXRhLmluZGV4T2YoJyknKTtcbiAgaWYgKHN0YXJQb3MgPT0gLTEgfHwgZW5kUG9zID09IC0xKSB7XG4gICAgdGhyb3cgbmV3IFBhcnNlLkVycm9yKFBhcnNlLkVycm9yLk9CSkVDVF9OT1RfRk9VTkQsICdxcSBhdXRoIGlzIGludmFsaWQgZm9yIHRoaXMgdXNlci4nKTtcbiAgfVxuICBkYXRhID0gZGF0YS5zdWJzdHJpbmcoc3RhclBvcyArIDEsIGVuZFBvcyAtIDEpO1xuICByZXR1cm4gSlNPTi5wYXJzZShkYXRhKTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSB7XG4gIHZhbGlkYXRlQXBwSWQsXG4gIHZhbGlkYXRlQXV0aERhdGEsXG4gIHBhcnNlUmVzcG9uc2VEYXRhLFxufTtcbiJdfQ==