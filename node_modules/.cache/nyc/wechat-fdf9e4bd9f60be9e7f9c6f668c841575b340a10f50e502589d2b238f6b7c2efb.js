"use strict";// Helper functions for accessing the WeChat Graph API.
function cov_108939t59o(){var path="/parse-server/lib/Adapters/Auth/wechat.js";var hash="21bca5fbbbcf0de32d3a1b6f6d73e409f6c81f06";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/parse-server/lib/Adapters/Auth/wechat.js",statementMap:{"0":{start:{line:4,column:21},end:{line:4,column:46}},"1":{start:{line:6,column:12},end:{line:6,column:39}},"2":{start:{line:10,column:2},end:{line:16,column:5}},"3":{start:{line:11,column:4},end:{line:13,column:5}},"4":{start:{line:12,column:6},end:{line:12,column:13}},"5":{start:{line:15,column:4},end:{line:15,column:97}},"6":{start:{line:21,column:2},end:{line:21,column:27}},"7":{start:{line:26,column:2},end:{line:26,column:67}},"8":{start:{line:29,column:0},end:{line:32,column:2}}},fnMap:{"0":{name:"validateAuthData",decl:{start:{line:9,column:9},end:{line:9,column:25}},loc:{start:{line:9,column:36},end:{line:17,column:1}},line:9},"1":{name:"(anonymous_1)",decl:{start:{line:10,column:100},end:{line:10,column:101}},loc:{start:{line:10,column:116},end:{line:16,column:3}},line:10},"2":{name:"validateAppId",decl:{start:{line:20,column:9},end:{line:20,column:22}},loc:{start:{line:20,column:25},end:{line:22,column:1}},line:20},"3":{name:"graphRequest",decl:{start:{line:25,column:9},end:{line:25,column:21}},loc:{start:{line:25,column:28},end:{line:27,column:1}},line:25}},branchMap:{"0":{loc:{start:{line:11,column:4},end:{line:13,column:5}},type:"if",locations:[{start:{line:11,column:4},end:{line:13,column:5}},{start:{line:11,column:4},end:{line:13,column:5}}],line:11}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0},f:{"0":0,"1":0,"2":0,"3":0},b:{"0":[0,0]},inputSourceMap:{version:3,sources:["../../../src/Adapters/Auth/wechat.js"],names:["httpsRequest","require","Parse","validateAuthData","authData","graphRequest","access_token","id","then","data","errcode","Error","OBJECT_NOT_FOUND","validateAppId","Promise","resolve","path","get","module","exports"],mappings:";;AAAA;AACA,MAAMA,YAAY,GAAGC,OAAO,CAAC,gBAAD,CAA5B;;AACA,IAAIC,KAAK,GAAGD,OAAO,CAAC,YAAD,CAAP,CAAsBC,KAAlC,C,CAEA;;;AACA,SAASC,gBAAT,CAA0BC,QAA1B,EAAoC;AAClC,SAAOC,YAAY,CAAC,uBAAuBD,QAAQ,CAACE,YAAhC,GAA+C,UAA/C,GAA4DF,QAAQ,CAACG,EAAtE,CAAZ,CAAsFC,IAAtF,CACL,UAAUC,IAAV,EAAgB;AACd,QAAIA,IAAI,CAACC,OAAL,IAAgB,CAApB,EAAuB;AACrB;AACD;;AACD,UAAM,IAAIR,KAAK,CAACS,KAAV,CAAgBT,KAAK,CAACS,KAAN,CAAYC,gBAA5B,EAA8C,uCAA9C,CAAN;AACD,GANI,CAAP;AAQD,C,CAED;;;AACA,SAASC,aAAT,GAAyB;AACvB,SAAOC,OAAO,CAACC,OAAR,EAAP;AACD,C,CAED;;;AACA,SAASV,YAAT,CAAsBW,IAAtB,EAA4B;AAC1B,SAAOhB,YAAY,CAACiB,GAAb,CAAiB,mCAAmCD,IAApD,CAAP;AACD;;AAEDE,MAAM,CAACC,OAAP,GAAiB;AACfN,EAAAA,aADe;AAEfV,EAAAA;AAFe,CAAjB",sourcesContent:["// Helper functions for accessing the WeChat Graph API.\nconst httpsRequest = require('./httpsRequest');\nvar Parse = require('parse/node').Parse;\n\n// Returns a promise that fulfills iff this user id is valid.\nfunction validateAuthData(authData) {\n  return graphRequest('auth?access_token=' + authData.access_token + '&openid=' + authData.id).then(\n    function (data) {\n      if (data.errcode == 0) {\n        return;\n      }\n      throw new Parse.Error(Parse.Error.OBJECT_NOT_FOUND, 'wechat auth is invalid for this user.');\n    }\n  );\n}\n\n// Returns a promise that fulfills if this app id is valid.\nfunction validateAppId() {\n  return Promise.resolve();\n}\n\n// A promisey wrapper for WeChat graph requests.\nfunction graphRequest(path) {\n  return httpsRequest.get('https://api.weixin.qq.com/sns/' + path);\n}\n\nmodule.exports = {\n  validateAppId,\n  validateAuthData,\n};\n"]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"21bca5fbbbcf0de32d3a1b6f6d73e409f6c81f06"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_108939t59o=function(){return actualCoverage;};}return actualCoverage;}cov_108939t59o();const httpsRequest=(cov_108939t59o().s[0]++,require('./httpsRequest'));var Parse=(cov_108939t59o().s[1]++,require('parse/node').Parse);// Returns a promise that fulfills iff this user id is valid.
function validateAuthData(authData){cov_108939t59o().f[0]++;cov_108939t59o().s[2]++;return graphRequest('auth?access_token='+authData.access_token+'&openid='+authData.id).then(function(data){cov_108939t59o().f[1]++;cov_108939t59o().s[3]++;if(data.errcode==0){cov_108939t59o().b[0][0]++;cov_108939t59o().s[4]++;return;}else{cov_108939t59o().b[0][1]++;}cov_108939t59o().s[5]++;throw new Parse.Error(Parse.Error.OBJECT_NOT_FOUND,'wechat auth is invalid for this user.');});}// Returns a promise that fulfills if this app id is valid.
function validateAppId(){cov_108939t59o().f[2]++;cov_108939t59o().s[6]++;return Promise.resolve();}// A promisey wrapper for WeChat graph requests.
function graphRequest(path){cov_108939t59o().f[3]++;cov_108939t59o().s[7]++;return httpsRequest.get('https://api.weixin.qq.com/sns/'+path);}cov_108939t59o().s[8]++;module.exports={validateAppId,validateAuthData};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9BZGFwdGVycy9BdXRoL3dlY2hhdC5qcyJdLCJuYW1lcyI6WyJodHRwc1JlcXVlc3QiLCJyZXF1aXJlIiwiUGFyc2UiLCJ2YWxpZGF0ZUF1dGhEYXRhIiwiYXV0aERhdGEiLCJncmFwaFJlcXVlc3QiLCJhY2Nlc3NfdG9rZW4iLCJpZCIsInRoZW4iLCJkYXRhIiwiZXJyY29kZSIsIkVycm9yIiwiT0JKRUNUX05PVF9GT1VORCIsInZhbGlkYXRlQXBwSWQiLCJQcm9taXNlIiwicmVzb2x2ZSIsInBhdGgiLCJnZXQiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOztBQUFBO0FBQ0EsTUFBTUEsWUFBWSxHQUFHQyxPQUFPLENBQUMsZ0JBQUQsQ0FBNUI7O0FBQ0EsSUFBSUMsS0FBSyxHQUFHRCxPQUFPLENBQUMsWUFBRCxDQUFQLENBQXNCQyxLQUFsQyxDLENBRUE7OztBQUNBLFNBQVNDLGdCQUFULENBQTBCQyxRQUExQixFQUFvQztBQUNsQyxTQUFPQyxZQUFZLENBQUMsdUJBQXVCRCxRQUFRLENBQUNFLFlBQWhDLEdBQStDLFVBQS9DLEdBQTRERixRQUFRLENBQUNHLEVBQXRFLENBQVosQ0FBc0ZDLElBQXRGLENBQ0wsVUFBVUMsSUFBVixFQUFnQjtBQUNkLFFBQUlBLElBQUksQ0FBQ0MsT0FBTCxJQUFnQixDQUFwQixFQUF1QjtBQUNyQjtBQUNEOztBQUNELFVBQU0sSUFBSVIsS0FBSyxDQUFDUyxLQUFWLENBQWdCVCxLQUFLLENBQUNTLEtBQU4sQ0FBWUMsZ0JBQTVCLEVBQThDLHVDQUE5QyxDQUFOO0FBQ0QsR0FOSSxDQUFQO0FBUUQsQyxDQUVEOzs7QUFDQSxTQUFTQyxhQUFULEdBQXlCO0FBQ3ZCLFNBQU9DLE9BQU8sQ0FBQ0MsT0FBUixFQUFQO0FBQ0QsQyxDQUVEOzs7QUFDQSxTQUFTVixZQUFULENBQXNCVyxJQUF0QixFQUE0QjtBQUMxQixTQUFPaEIsWUFBWSxDQUFDaUIsR0FBYixDQUFpQixtQ0FBbUNELElBQXBELENBQVA7QUFDRDs7QUFFREUsTUFBTSxDQUFDQyxPQUFQLEdBQWlCO0FBQ2ZOLEVBQUFBLGFBRGU7QUFFZlYsRUFBQUE7QUFGZSxDQUFqQiIsInNvdXJjZXNDb250ZW50IjpbIi8vIEhlbHBlciBmdW5jdGlvbnMgZm9yIGFjY2Vzc2luZyB0aGUgV2VDaGF0IEdyYXBoIEFQSS5cbmNvbnN0IGh0dHBzUmVxdWVzdCA9IHJlcXVpcmUoJy4vaHR0cHNSZXF1ZXN0Jyk7XG52YXIgUGFyc2UgPSByZXF1aXJlKCdwYXJzZS9ub2RlJykuUGFyc2U7XG5cbi8vIFJldHVybnMgYSBwcm9taXNlIHRoYXQgZnVsZmlsbHMgaWZmIHRoaXMgdXNlciBpZCBpcyB2YWxpZC5cbmZ1bmN0aW9uIHZhbGlkYXRlQXV0aERhdGEoYXV0aERhdGEpIHtcbiAgcmV0dXJuIGdyYXBoUmVxdWVzdCgnYXV0aD9hY2Nlc3NfdG9rZW49JyArIGF1dGhEYXRhLmFjY2Vzc190b2tlbiArICcmb3BlbmlkPScgKyBhdXRoRGF0YS5pZCkudGhlbihcbiAgICBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgaWYgKGRhdGEuZXJyY29kZSA9PSAwKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHRocm93IG5ldyBQYXJzZS5FcnJvcihQYXJzZS5FcnJvci5PQkpFQ1RfTk9UX0ZPVU5ELCAnd2VjaGF0IGF1dGggaXMgaW52YWxpZCBmb3IgdGhpcyB1c2VyLicpO1xuICAgIH1cbiAgKTtcbn1cblxuLy8gUmV0dXJucyBhIHByb21pc2UgdGhhdCBmdWxmaWxscyBpZiB0aGlzIGFwcCBpZCBpcyB2YWxpZC5cbmZ1bmN0aW9uIHZhbGlkYXRlQXBwSWQoKSB7XG4gIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcbn1cblxuLy8gQSBwcm9taXNleSB3cmFwcGVyIGZvciBXZUNoYXQgZ3JhcGggcmVxdWVzdHMuXG5mdW5jdGlvbiBncmFwaFJlcXVlc3QocGF0aCkge1xuICByZXR1cm4gaHR0cHNSZXF1ZXN0LmdldCgnaHR0cHM6Ly9hcGkud2VpeGluLnFxLmNvbS9zbnMvJyArIHBhdGgpO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgdmFsaWRhdGVBcHBJZCxcbiAgdmFsaWRhdGVBdXRoRGF0YSxcbn07XG4iXX0=
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9BZGFwdGVycy9BdXRoL3dlY2hhdC5qcyJdLCJuYW1lcyI6WyJodHRwc1JlcXVlc3QiLCJyZXF1aXJlIiwiUGFyc2UiLCJhdXRoRGF0YSIsImRhdGEiLCJQcm9taXNlIiwibW9kdWxlIiwidmFsaWRhdGVBdXRoRGF0YSJdLCJtYXBwaW5ncyI6ImFBQUE7eXZIQU1FOzJGQUxGLEtBQU1BLENBQUFBLFlBQVksMEJBQUdDLE9BQU8sQ0FBNUIsZ0JBQTRCLENBQVYsQ0FBbEIsQ0FDQSxHQUFJQyxDQUFBQSxLQUFLLDBCQUFHRCxPQUFPLENBQVBBLFlBQU8sQ0FBUEEsQ0FBWixLQUFTLENBQVQsQ0FFQTtBQUNBLFFBQUEsQ0FBQSxnQkFBQSxDQUFBLFFBQUEsQ0FBb0MsaURBQ2xDLE1BQU8sQ0FBQSxZQUFZLENBQUMscUJBQXVCRSxRQUFRLENBQS9CLFlBQUEsQ0FBQSxVQUFBLENBQTREQSxRQUFRLENBQWpGLEVBQVksQ0FBWixDQUFBLElBQUEsQ0FDTCxTQUFBLElBQUEsQ0FBZ0IsaURBQ2QsR0FBSUMsSUFBSSxDQUFKQSxPQUFBQSxFQUFKLENBQUEsQ0FBdUIsb0RBQ3JCLE9BQ0QsQ0FGRCxpQ0FEYyx3QkFJZCxLQUFNLElBQUlGLENBQUFBLEtBQUssQ0FBVCxLQUFBLENBQWdCQSxLQUFLLENBQUxBLEtBQUFBLENBQWhCLGdCQUFBLENBQU4sdUNBQU0sQ0FBTixDQUxKLENBQU8sQ0FBUCxDLENBVUY7QUFDQSxRQUFBLENBQUEsYUFBQSxFQUF5QixpREFDdkIsTUFBT0csQ0FBQUEsT0FBTyxDQUFkLE9BQU9BLEVBQVAsQyxDQUdGO0FBQ0EsUUFBQSxDQUFBLFlBQUEsQ0FBQSxJQUFBLENBQTRCLGlEQUMxQixNQUFPTCxDQUFBQSxZQUFZLENBQVpBLEdBQUFBLENBQWlCLGlDQUF4QixJQUFPQSxDQUFQLENBQ0QsQyx3QkFFRE0sTUFBTSxDQUFOQSxPQUFBQSxDQUFpQixDQUFBLGFBQUEsQ0FFZkMsZ0JBRmUsQ0FBakJELEMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBIZWxwZXIgZnVuY3Rpb25zIGZvciBhY2Nlc3NpbmcgdGhlIFdlQ2hhdCBHcmFwaCBBUEkuXG5jb25zdCBodHRwc1JlcXVlc3QgPSByZXF1aXJlKCcuL2h0dHBzUmVxdWVzdCcpO1xudmFyIFBhcnNlID0gcmVxdWlyZSgncGFyc2Uvbm9kZScpLlBhcnNlO1xuXG4vLyBSZXR1cm5zIGEgcHJvbWlzZSB0aGF0IGZ1bGZpbGxzIGlmZiB0aGlzIHVzZXIgaWQgaXMgdmFsaWQuXG5mdW5jdGlvbiB2YWxpZGF0ZUF1dGhEYXRhKGF1dGhEYXRhKSB7XG4gIHJldHVybiBncmFwaFJlcXVlc3QoJ2F1dGg/YWNjZXNzX3Rva2VuPScgKyBhdXRoRGF0YS5hY2Nlc3NfdG9rZW4gKyAnJm9wZW5pZD0nICsgYXV0aERhdGEuaWQpLnRoZW4oXG4gICAgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgIGlmIChkYXRhLmVycmNvZGUgPT0gMCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICB0aHJvdyBuZXcgUGFyc2UuRXJyb3IoUGFyc2UuRXJyb3IuT0JKRUNUX05PVF9GT1VORCwgJ3dlY2hhdCBhdXRoIGlzIGludmFsaWQgZm9yIHRoaXMgdXNlci4nKTtcbiAgICB9XG4gICk7XG59XG5cbi8vIFJldHVybnMgYSBwcm9taXNlIHRoYXQgZnVsZmlsbHMgaWYgdGhpcyBhcHAgaWQgaXMgdmFsaWQuXG5mdW5jdGlvbiB2YWxpZGF0ZUFwcElkKCkge1xuICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG59XG5cbi8vIEEgcHJvbWlzZXkgd3JhcHBlciBmb3IgV2VDaGF0IGdyYXBoIHJlcXVlc3RzLlxuZnVuY3Rpb24gZ3JhcGhSZXF1ZXN0KHBhdGgpIHtcbiAgcmV0dXJuIGh0dHBzUmVxdWVzdC5nZXQoJ2h0dHBzOi8vYXBpLndlaXhpbi5xcS5jb20vc25zLycgKyBwYXRoKTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSB7XG4gIHZhbGlkYXRlQXBwSWQsXG4gIHZhbGlkYXRlQXV0aERhdGEsXG59O1xuIl19