"use strict";function cov_1odpd5nun2(){var path="/parse-server/lib/LiveQuery/ParsePubSub.js";var hash="9a21804b3ebe22f363d61da1b1122439590abcac";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/parse-server/lib/LiveQuery/ParsePubSub.js",statementMap:{"0":{start:{line:3,column:0},end:{line:5,column:3}},"1":{start:{line:6,column:0},end:{line:6,column:29}},"2":{start:{line:8,column:21},end:{line:8,column:57}},"3":{start:{line:10,column:26},end:{line:10,column:74}},"4":{start:{line:12,column:19},end:{line:12,column:60}},"5":{start:{line:14,column:20},end:{line:14,column:22}},"6":{start:{line:15,column:0},end:{line:15,column:34}},"7":{start:{line:18,column:19},end:{line:18,column:34}},"8":{start:{line:19,column:2},end:{line:19,column:60}},"9":{start:{line:22,column:0},end:{line:34,column:2}},"10":{start:{line:23,column:2},end:{line:33,column:3}},"11":{start:{line:24,column:4},end:{line:24,column:60}},"12":{start:{line:26,column:20},end:{line:26,column:121}},"13":{start:{line:28,column:4},end:{line:30,column:5}},"14":{start:{line:29,column:6},end:{line:29,column:58}},"15":{start:{line:32,column:4},end:{line:32,column:43}},"16":{start:{line:36,column:0},end:{line:48,column:2}},"17":{start:{line:37,column:2},end:{line:47,column:3}},"18":{start:{line:38,column:4},end:{line:38,column:61}},"19":{start:{line:40,column:20},end:{line:40,column:121}},"20":{start:{line:42,column:4},end:{line:44,column:5}},"21":{start:{line:43,column:6},end:{line:43,column:59}},"22":{start:{line:46,column:4},end:{line:46,column:44}}},fnMap:{"0":{name:"useRedis",decl:{start:{line:17,column:9},end:{line:17,column:17}},loc:{start:{line:17,column:26},end:{line:20,column:1}},line:17},"1":{name:"(anonymous_1)",decl:{start:{line:22,column:30},end:{line:22,column:31}},loc:{start:{line:22,column:48},end:{line:34,column:1}},line:22},"2":{name:"(anonymous_2)",decl:{start:{line:36,column:31},end:{line:36,column:32}},loc:{start:{line:36,column:49},end:{line:48,column:1}},line:36}},branchMap:{"0":{loc:{start:{line:19,column:9},end:{line:19,column:59}},type:"binary-expr",locations:[{start:{line:19,column:9},end:{line:19,column:40}},{start:{line:19,column:44},end:{line:19,column:59}}],line:19},"1":{loc:{start:{line:23,column:2},end:{line:33,column:3}},type:"if",locations:[{start:{line:23,column:2},end:{line:33,column:3}},{start:{line:23,column:2},end:{line:33,column:3}}],line:23},"2":{loc:{start:{line:28,column:4},end:{line:30,column:5}},type:"if",locations:[{start:{line:28,column:4},end:{line:30,column:5}},{start:{line:28,column:4},end:{line:30,column:5}}],line:28},"3":{loc:{start:{line:37,column:2},end:{line:47,column:3}},type:"if",locations:[{start:{line:37,column:2},end:{line:47,column:3}},{start:{line:37,column:2},end:{line:47,column:3}}],line:37},"4":{loc:{start:{line:42,column:4},end:{line:44,column:5}},type:"if",locations:[{start:{line:42,column:4},end:{line:44,column:5}},{start:{line:42,column:4},end:{line:44,column:5}}],line:42}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0},f:{"0":0,"1":0,"2":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0]},inputSourceMap:{version:3,sources:["../../src/LiveQuery/ParsePubSub.js"],names:["ParsePubSub","useRedis","config","redisURL","createPublisher","RedisPubSub","adapter","pubSubAdapter","EventEmitterPubSub","createSubscriber"],mappings:";;;;;;;AAAA;;AACA;;AAEA;;AAEA,MAAMA,WAAW,GAAG,EAApB;;;AAEA,SAASC,QAAT,CAAkBC,MAAlB,EAAwC;AACtC,QAAMC,QAAQ,GAAGD,MAAM,CAACC,QAAxB;AACA,SAAO,OAAOA,QAAP,KAAoB,WAApB,IAAmCA,QAAQ,KAAK,EAAvD;AACD;;AAEDH,WAAW,CAACI,eAAZ,GAA8B,UAAUF,MAAV,EAA4B;AACxD,MAAID,QAAQ,CAACC,MAAD,CAAZ,EAAsB;AACpB,WAAOG,yBAAYD,eAAZ,CAA4BF,MAA5B,CAAP;AACD,GAFD,MAEO;AACL,UAAMI,OAAO,GAAG,gCAAYJ,MAAM,CAACK,aAAnB,EAAkCC,sCAAlC,EAAsDN,MAAtD,CAAhB;;AACA,QAAI,OAAOI,OAAO,CAACF,eAAf,KAAmC,UAAvC,EAAmD;AACjD,YAAM,6CAAN;AACD;;AACD,WAAOE,OAAO,CAACF,eAAR,CAAwBF,MAAxB,CAAP;AACD;AACF,CAVD;;AAYAF,WAAW,CAACS,gBAAZ,GAA+B,UAAUP,MAAV,EAA6B;AAC1D,MAAID,QAAQ,CAACC,MAAD,CAAZ,EAAsB;AACpB,WAAOG,yBAAYI,gBAAZ,CAA6BP,MAA7B,CAAP;AACD,GAFD,MAEO;AACL,UAAMI,OAAO,GAAG,gCAAYJ,MAAM,CAACK,aAAnB,EAAkCC,sCAAlC,EAAsDN,MAAtD,CAAhB;;AACA,QAAI,OAAOI,OAAO,CAACG,gBAAf,KAAoC,UAAxC,EAAoD;AAClD,YAAM,8CAAN;AACD;;AACD,WAAOH,OAAO,CAACG,gBAAR,CAAyBP,MAAzB,CAAP;AACD;AACF,CAVD",sourcesContent:["import { loadAdapter } from '../Adapters/AdapterLoader';\nimport { EventEmitterPubSub } from '../Adapters/PubSub/EventEmitterPubSub';\n\nimport { RedisPubSub } from '../Adapters/PubSub/RedisPubSub';\n\nconst ParsePubSub = {};\n\nfunction useRedis(config: any): boolean {\n  const redisURL = config.redisURL;\n  return typeof redisURL !== 'undefined' && redisURL !== '';\n}\n\nParsePubSub.createPublisher = function (config: any): any {\n  if (useRedis(config)) {\n    return RedisPubSub.createPublisher(config);\n  } else {\n    const adapter = loadAdapter(config.pubSubAdapter, EventEmitterPubSub, config);\n    if (typeof adapter.createPublisher !== 'function') {\n      throw 'pubSubAdapter should have createPublisher()';\n    }\n    return adapter.createPublisher(config);\n  }\n};\n\nParsePubSub.createSubscriber = function (config: any): void {\n  if (useRedis(config)) {\n    return RedisPubSub.createSubscriber(config);\n  } else {\n    const adapter = loadAdapter(config.pubSubAdapter, EventEmitterPubSub, config);\n    if (typeof adapter.createSubscriber !== 'function') {\n      throw 'pubSubAdapter should have createSubscriber()';\n    }\n    return adapter.createSubscriber(config);\n  }\n};\n\nexport { ParsePubSub };\n"]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"9a21804b3ebe22f363d61da1b1122439590abcac"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_1odpd5nun2=function(){return actualCoverage;};}return actualCoverage;}cov_1odpd5nun2();cov_1odpd5nun2().s[0]++;Object.defineProperty(exports,"__esModule",{value:true});cov_1odpd5nun2().s[1]++;exports.ParsePubSub=void 0;var _AdapterLoader=(cov_1odpd5nun2().s[2]++,require("../Adapters/AdapterLoader"));var _EventEmitterPubSub=(cov_1odpd5nun2().s[3]++,require("../Adapters/PubSub/EventEmitterPubSub"));var _RedisPubSub=(cov_1odpd5nun2().s[4]++,require("../Adapters/PubSub/RedisPubSub"));const ParsePubSub=(cov_1odpd5nun2().s[5]++,{});cov_1odpd5nun2().s[6]++;exports.ParsePubSub=ParsePubSub;function useRedis(config){cov_1odpd5nun2().f[0]++;const redisURL=(cov_1odpd5nun2().s[7]++,config.redisURL);cov_1odpd5nun2().s[8]++;return(cov_1odpd5nun2().b[0][0]++,typeof redisURL!=='undefined')&&(cov_1odpd5nun2().b[0][1]++,redisURL!=='');}cov_1odpd5nun2().s[9]++;ParsePubSub.createPublisher=function(config){cov_1odpd5nun2().f[1]++;cov_1odpd5nun2().s[10]++;if(useRedis(config)){cov_1odpd5nun2().b[1][0]++;cov_1odpd5nun2().s[11]++;return _RedisPubSub.RedisPubSub.createPublisher(config);}else{cov_1odpd5nun2().b[1][1]++;const adapter=(cov_1odpd5nun2().s[12]++,(0,_AdapterLoader.loadAdapter)(config.pubSubAdapter,_EventEmitterPubSub.EventEmitterPubSub,config));cov_1odpd5nun2().s[13]++;if(typeof adapter.createPublisher!=='function'){cov_1odpd5nun2().b[2][0]++;cov_1odpd5nun2().s[14]++;throw'pubSubAdapter should have createPublisher()';}else{cov_1odpd5nun2().b[2][1]++;}cov_1odpd5nun2().s[15]++;return adapter.createPublisher(config);}};cov_1odpd5nun2().s[16]++;ParsePubSub.createSubscriber=function(config){cov_1odpd5nun2().f[2]++;cov_1odpd5nun2().s[17]++;if(useRedis(config)){cov_1odpd5nun2().b[3][0]++;cov_1odpd5nun2().s[18]++;return _RedisPubSub.RedisPubSub.createSubscriber(config);}else{cov_1odpd5nun2().b[3][1]++;const adapter=(cov_1odpd5nun2().s[19]++,(0,_AdapterLoader.loadAdapter)(config.pubSubAdapter,_EventEmitterPubSub.EventEmitterPubSub,config));cov_1odpd5nun2().s[20]++;if(typeof adapter.createSubscriber!=='function'){cov_1odpd5nun2().b[4][0]++;cov_1odpd5nun2().s[21]++;throw'pubSubAdapter should have createSubscriber()';}else{cov_1odpd5nun2().b[4][1]++;}cov_1odpd5nun2().s[22]++;return adapter.createSubscriber(config);}};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9MaXZlUXVlcnkvUGFyc2VQdWJTdWIuanMiXSwibmFtZXMiOlsiUGFyc2VQdWJTdWIiLCJ1c2VSZWRpcyIsImNvbmZpZyIsInJlZGlzVVJMIiwiY3JlYXRlUHVibGlzaGVyIiwiUmVkaXNQdWJTdWIiLCJhZGFwdGVyIiwicHViU3ViQWRhcHRlciIsIkV2ZW50RW1pdHRlclB1YlN1YiIsImNyZWF0ZVN1YnNjcmliZXIiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBQTs7QUFDQTs7QUFFQTs7QUFFQSxNQUFNQSxXQUFXLEdBQUcsRUFBcEI7OztBQUVBLFNBQVNDLFFBQVQsQ0FBa0JDLE1BQWxCLEVBQXdDO0FBQ3RDLFFBQU1DLFFBQVEsR0FBR0QsTUFBTSxDQUFDQyxRQUF4QjtBQUNBLFNBQU8sT0FBT0EsUUFBUCxLQUFvQixXQUFwQixJQUFtQ0EsUUFBUSxLQUFLLEVBQXZEO0FBQ0Q7O0FBRURILFdBQVcsQ0FBQ0ksZUFBWixHQUE4QixVQUFVRixNQUFWLEVBQTRCO0FBQ3hELE1BQUlELFFBQVEsQ0FBQ0MsTUFBRCxDQUFaLEVBQXNCO0FBQ3BCLFdBQU9HLHlCQUFZRCxlQUFaLENBQTRCRixNQUE1QixDQUFQO0FBQ0QsR0FGRCxNQUVPO0FBQ0wsVUFBTUksT0FBTyxHQUFHLGdDQUFZSixNQUFNLENBQUNLLGFBQW5CLEVBQWtDQyxzQ0FBbEMsRUFBc0ROLE1BQXRELENBQWhCOztBQUNBLFFBQUksT0FBT0ksT0FBTyxDQUFDRixlQUFmLEtBQW1DLFVBQXZDLEVBQW1EO0FBQ2pELFlBQU0sNkNBQU47QUFDRDs7QUFDRCxXQUFPRSxPQUFPLENBQUNGLGVBQVIsQ0FBd0JGLE1BQXhCLENBQVA7QUFDRDtBQUNGLENBVkQ7O0FBWUFGLFdBQVcsQ0FBQ1MsZ0JBQVosR0FBK0IsVUFBVVAsTUFBVixFQUE2QjtBQUMxRCxNQUFJRCxRQUFRLENBQUNDLE1BQUQsQ0FBWixFQUFzQjtBQUNwQixXQUFPRyx5QkFBWUksZ0JBQVosQ0FBNkJQLE1BQTdCLENBQVA7QUFDRCxHQUZELE1BRU87QUFDTCxVQUFNSSxPQUFPLEdBQUcsZ0NBQVlKLE1BQU0sQ0FBQ0ssYUFBbkIsRUFBa0NDLHNDQUFsQyxFQUFzRE4sTUFBdEQsQ0FBaEI7O0FBQ0EsUUFBSSxPQUFPSSxPQUFPLENBQUNHLGdCQUFmLEtBQW9DLFVBQXhDLEVBQW9EO0FBQ2xELFlBQU0sOENBQU47QUFDRDs7QUFDRCxXQUFPSCxPQUFPLENBQUNHLGdCQUFSLENBQXlCUCxNQUF6QixDQUFQO0FBQ0Q7QUFDRixDQVZEIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgbG9hZEFkYXB0ZXIgfSBmcm9tICcuLi9BZGFwdGVycy9BZGFwdGVyTG9hZGVyJztcbmltcG9ydCB7IEV2ZW50RW1pdHRlclB1YlN1YiB9IGZyb20gJy4uL0FkYXB0ZXJzL1B1YlN1Yi9FdmVudEVtaXR0ZXJQdWJTdWInO1xuXG5pbXBvcnQgeyBSZWRpc1B1YlN1YiB9IGZyb20gJy4uL0FkYXB0ZXJzL1B1YlN1Yi9SZWRpc1B1YlN1Yic7XG5cbmNvbnN0IFBhcnNlUHViU3ViID0ge307XG5cbmZ1bmN0aW9uIHVzZVJlZGlzKGNvbmZpZzogYW55KTogYm9vbGVhbiB7XG4gIGNvbnN0IHJlZGlzVVJMID0gY29uZmlnLnJlZGlzVVJMO1xuICByZXR1cm4gdHlwZW9mIHJlZGlzVVJMICE9PSAndW5kZWZpbmVkJyAmJiByZWRpc1VSTCAhPT0gJyc7XG59XG5cblBhcnNlUHViU3ViLmNyZWF0ZVB1Ymxpc2hlciA9IGZ1bmN0aW9uIChjb25maWc6IGFueSk6IGFueSB7XG4gIGlmICh1c2VSZWRpcyhjb25maWcpKSB7XG4gICAgcmV0dXJuIFJlZGlzUHViU3ViLmNyZWF0ZVB1Ymxpc2hlcihjb25maWcpO1xuICB9IGVsc2Uge1xuICAgIGNvbnN0IGFkYXB0ZXIgPSBsb2FkQWRhcHRlcihjb25maWcucHViU3ViQWRhcHRlciwgRXZlbnRFbWl0dGVyUHViU3ViLCBjb25maWcpO1xuICAgIGlmICh0eXBlb2YgYWRhcHRlci5jcmVhdGVQdWJsaXNoZXIgIT09ICdmdW5jdGlvbicpIHtcbiAgICAgIHRocm93ICdwdWJTdWJBZGFwdGVyIHNob3VsZCBoYXZlIGNyZWF0ZVB1Ymxpc2hlcigpJztcbiAgICB9XG4gICAgcmV0dXJuIGFkYXB0ZXIuY3JlYXRlUHVibGlzaGVyKGNvbmZpZyk7XG4gIH1cbn07XG5cblBhcnNlUHViU3ViLmNyZWF0ZVN1YnNjcmliZXIgPSBmdW5jdGlvbiAoY29uZmlnOiBhbnkpOiB2b2lkIHtcbiAgaWYgKHVzZVJlZGlzKGNvbmZpZykpIHtcbiAgICByZXR1cm4gUmVkaXNQdWJTdWIuY3JlYXRlU3Vic2NyaWJlcihjb25maWcpO1xuICB9IGVsc2Uge1xuICAgIGNvbnN0IGFkYXB0ZXIgPSBsb2FkQWRhcHRlcihjb25maWcucHViU3ViQWRhcHRlciwgRXZlbnRFbWl0dGVyUHViU3ViLCBjb25maWcpO1xuICAgIGlmICh0eXBlb2YgYWRhcHRlci5jcmVhdGVTdWJzY3JpYmVyICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgICB0aHJvdyAncHViU3ViQWRhcHRlciBzaG91bGQgaGF2ZSBjcmVhdGVTdWJzY3JpYmVyKCknO1xuICAgIH1cbiAgICByZXR1cm4gYWRhcHRlci5jcmVhdGVTdWJzY3JpYmVyKGNvbmZpZyk7XG4gIH1cbn07XG5cbmV4cG9ydCB7IFBhcnNlUHViU3ViIH07XG4iXX0=
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9MaXZlUXVlcnkvUGFyc2VQdWJTdWIuanMiXSwibmFtZXMiOlsiUGFyc2VQdWJTdWIiLCJyZWRpc1VSTCIsImNvbmZpZyIsInVzZVJlZGlzIiwiUmVkaXNQdWJTdWIiLCJhZGFwdGVyIiwiRXZlbnRFbWl0dGVyUHViU3ViIl0sIm1hcHBpbmdzIjoiOytOQUFBLEdBQUEsQ0FBQSxjQUFBLDBCQUFBLE9BQUEsQ0FBQSwyQkFBQSxDQUFBLENBQUEsQ0FDQSxHQUFBLENBQUEsbUJBQUEsMEJBQUEsT0FBQSxDQUFBLHVDQUFBLENBQUEsQ0FBQSxDQUVBLEdBQUEsQ0FBQSxZQUFBLDBCQUFBLE9BQUEsQ0FBQSxnQ0FBQSxDQUFBLENBQUEsQ0FFQSxLQUFNQSxDQUFBQSxXQUFXLDBCQUFqQixFQUFpQixDQUFqQixDLHdEQUVBLFFBQUEsQ0FBQSxRQUFBLENBQUEsTUFBQSxDQUF3Qyx5QkFDdEMsS0FBTUMsQ0FBQUEsUUFBUSwwQkFBR0MsTUFBTSxDQUF2QixRQUFjLENBQWQsQ0FEc0Msd0JBRXRDLE1BQU8sa0NBQUEsQ0FBQSxRQUFBLEdBQUEsV0FBQSwrQkFBbUNELFFBQVEsR0FBbEQsRUFBTyxDQUFQLENBQ0QsQyx3QkFFREQsV0FBVyxDQUFYQSxlQUFBQSxDQUE4QixTQUFBLE1BQUEsQ0FBNEIsa0RBQ3hELEdBQUlHLFFBQVEsQ0FBWixNQUFZLENBQVosQ0FBc0IscURBQ3BCLE1BQU9DLENBQUFBLFlBQUFBLENBQUFBLFdBQUFBLENBQUFBLGVBQUFBLENBQVAsTUFBT0EsQ0FBUCxDQURGLENBQUEsSUFFTyw0QkFDTCxLQUFNQyxDQUFBQSxPQUFPLDJCQUFHLENBQUEsRUFBQSxjQUFBLENBQUEsV0FBQSxFQUFZSCxNQUFNLENBQWxCLGFBQUEsQ0FBa0NJLG1CQUFBQSxDQUFsQyxrQkFBQSxDQUFoQixNQUFnQixDQUFILENBQWIsQ0FESyx5QkFFTCxHQUFJLE1BQU9ELENBQUFBLE9BQU8sQ0FBZCxlQUFBLEdBQUosVUFBQSxDQUFtRCxxREFDakQsS0FBQSw2Q0FBQSxDQUNELENBRkQsaUNBRksseUJBS0wsTUFBT0EsQ0FBQUEsT0FBTyxDQUFQQSxlQUFBQSxDQUFQLE1BQU9BLENBQVAsQ0FDRCxDQVRITCxDQUFBQSxDLHlCQVlBQSxXQUFXLENBQVhBLGdCQUFBQSxDQUErQixTQUFBLE1BQUEsQ0FBNkIsa0RBQzFELEdBQUlHLFFBQVEsQ0FBWixNQUFZLENBQVosQ0FBc0IscURBQ3BCLE1BQU9DLENBQUFBLFlBQUFBLENBQUFBLFdBQUFBLENBQUFBLGdCQUFBQSxDQUFQLE1BQU9BLENBQVAsQ0FERixDQUFBLElBRU8sNEJBQ0wsS0FBTUMsQ0FBQUEsT0FBTywyQkFBRyxDQUFBLEVBQUEsY0FBQSxDQUFBLFdBQUEsRUFBWUgsTUFBTSxDQUFsQixhQUFBLENBQWtDSSxtQkFBQUEsQ0FBbEMsa0JBQUEsQ0FBaEIsTUFBZ0IsQ0FBSCxDQUFiLENBREsseUJBRUwsR0FBSSxNQUFPRCxDQUFBQSxPQUFPLENBQWQsZ0JBQUEsR0FBSixVQUFBLENBQW9ELHFEQUNsRCxLQUFBLDhDQUFBLENBQ0QsQ0FGRCxpQ0FGSyx5QkFLTCxNQUFPQSxDQUFBQSxPQUFPLENBQVBBLGdCQUFBQSxDQUFQLE1BQU9BLENBQVAsQ0FDRCxDQVRITCxDQUFBQSxDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgbG9hZEFkYXB0ZXIgfSBmcm9tICcuLi9BZGFwdGVycy9BZGFwdGVyTG9hZGVyJztcbmltcG9ydCB7IEV2ZW50RW1pdHRlclB1YlN1YiB9IGZyb20gJy4uL0FkYXB0ZXJzL1B1YlN1Yi9FdmVudEVtaXR0ZXJQdWJTdWInO1xuXG5pbXBvcnQgeyBSZWRpc1B1YlN1YiB9IGZyb20gJy4uL0FkYXB0ZXJzL1B1YlN1Yi9SZWRpc1B1YlN1Yic7XG5cbmNvbnN0IFBhcnNlUHViU3ViID0ge307XG5cbmZ1bmN0aW9uIHVzZVJlZGlzKGNvbmZpZzogYW55KTogYm9vbGVhbiB7XG4gIGNvbnN0IHJlZGlzVVJMID0gY29uZmlnLnJlZGlzVVJMO1xuICByZXR1cm4gdHlwZW9mIHJlZGlzVVJMICE9PSAndW5kZWZpbmVkJyAmJiByZWRpc1VSTCAhPT0gJyc7XG59XG5cblBhcnNlUHViU3ViLmNyZWF0ZVB1Ymxpc2hlciA9IGZ1bmN0aW9uIChjb25maWc6IGFueSk6IGFueSB7XG4gIGlmICh1c2VSZWRpcyhjb25maWcpKSB7XG4gICAgcmV0dXJuIFJlZGlzUHViU3ViLmNyZWF0ZVB1Ymxpc2hlcihjb25maWcpO1xuICB9IGVsc2Uge1xuICAgIGNvbnN0IGFkYXB0ZXIgPSBsb2FkQWRhcHRlcihjb25maWcucHViU3ViQWRhcHRlciwgRXZlbnRFbWl0dGVyUHViU3ViLCBjb25maWcpO1xuICAgIGlmICh0eXBlb2YgYWRhcHRlci5jcmVhdGVQdWJsaXNoZXIgIT09ICdmdW5jdGlvbicpIHtcbiAgICAgIHRocm93ICdwdWJTdWJBZGFwdGVyIHNob3VsZCBoYXZlIGNyZWF0ZVB1Ymxpc2hlcigpJztcbiAgICB9XG4gICAgcmV0dXJuIGFkYXB0ZXIuY3JlYXRlUHVibGlzaGVyKGNvbmZpZyk7XG4gIH1cbn07XG5cblBhcnNlUHViU3ViLmNyZWF0ZVN1YnNjcmliZXIgPSBmdW5jdGlvbiAoY29uZmlnOiBhbnkpOiB2b2lkIHtcbiAgaWYgKHVzZVJlZGlzKGNvbmZpZykpIHtcbiAgICByZXR1cm4gUmVkaXNQdWJTdWIuY3JlYXRlU3Vic2NyaWJlcihjb25maWcpO1xuICB9IGVsc2Uge1xuICAgIGNvbnN0IGFkYXB0ZXIgPSBsb2FkQWRhcHRlcihjb25maWcucHViU3ViQWRhcHRlciwgRXZlbnRFbWl0dGVyUHViU3ViLCBjb25maWcpO1xuICAgIGlmICh0eXBlb2YgYWRhcHRlci5jcmVhdGVTdWJzY3JpYmVyICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgICB0aHJvdyAncHViU3ViQWRhcHRlciBzaG91bGQgaGF2ZSBjcmVhdGVTdWJzY3JpYmVyKCknO1xuICAgIH1cbiAgICByZXR1cm4gYWRhcHRlci5jcmVhdGVTdWJzY3JpYmVyKGNvbmZpZyk7XG4gIH1cbn07XG5cbmV4cG9ydCB7IFBhcnNlUHViU3ViIH07XG4iXX0=