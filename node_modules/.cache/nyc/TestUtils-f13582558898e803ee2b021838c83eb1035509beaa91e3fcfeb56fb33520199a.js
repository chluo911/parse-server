"use strict";function cov_207dckqi0(){var path="/parse-server/lib/TestUtils.js";var hash="845ccbc21df5d841ca8fcce5bec031dcee11fd95";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/parse-server/lib/TestUtils.js",statementMap:{"0":{start:{line:3,column:0},end:{line:5,column:3}},"1":{start:{line:6,column:0},end:{line:6,column:62}},"2":{start:{line:8,column:13},end:{line:8,column:55}},"3":{start:{line:10,column:39},end:{line:10,column:93}},"4":{start:{line:17,column:2},end:{line:19,column:3}},"5":{start:{line:18,column:4},end:{line:18,column:47}},"6":{start:{line:21,column:2},end:{line:29,column:6}},"7":{start:{line:22,column:16},end:{line:22,column:41}},"8":{start:{line:24,column:4},end:{line:28,column:5}},"9":{start:{line:25,column:6},end:{line:25,column:59}},"10":{start:{line:27,column:6},end:{line:27,column:31}}},fnMap:{"0":{name:"_interopRequireDefault",decl:{start:{line:10,column:9},end:{line:10,column:31}},loc:{start:{line:10,column:37},end:{line:10,column:95}},line:10},"1":{name:"destroyAllDataPermanently",decl:{start:{line:16,column:9},end:{line:16,column:34}},loc:{start:{line:16,column:41},end:{line:30,column:1}},line:16},"2":{name:"(anonymous_2)",decl:{start:{line:21,column:59},end:{line:21,column:60}},loc:{start:{line:21,column:68},end:{line:29,column:3}},line:21}},branchMap:{"0":{loc:{start:{line:10,column:46},end:{line:10,column:92}},type:"cond-expr",locations:[{start:{line:10,column:70},end:{line:10,column:73}},{start:{line:10,column:76},end:{line:10,column:92}}],line:10},"1":{loc:{start:{line:10,column:46},end:{line:10,column:67}},type:"binary-expr",locations:[{start:{line:10,column:46},end:{line:10,column:49}},{start:{line:10,column:53},end:{line:10,column:67}}],line:10},"2":{loc:{start:{line:17,column:2},end:{line:19,column:3}},type:"if",locations:[{start:{line:17,column:2},end:{line:19,column:3}},{start:{line:17,column:2},end:{line:19,column:3}}],line:17},"3":{loc:{start:{line:24,column:4},end:{line:28,column:5}},type:"if",locations:[{start:{line:24,column:4},end:{line:28,column:5}},{start:{line:24,column:4},end:{line:28,column:5}}],line:24}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0},f:{"0":0,"1":0,"2":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0]},inputSourceMap:{version:3,sources:["../src/TestUtils.js"],names:["destroyAllDataPermanently","fast","process","env","TESTING","Promise","all","Object","keys","AppCache","cache","map","appId","app","get","databaseController","deleteEverything","resolve"],mappings:";;;;;;;AAAA;;;;AAEA;AACA;AACA;AACA;AACO,SAASA,yBAAT,CAAmCC,IAAnC,EAAyC;AAC9C,MAAI,CAACC,OAAO,CAACC,GAAR,CAAYC,OAAjB,EAA0B;AACxB,UAAM,oCAAN;AACD;;AACD,SAAOC,OAAO,CAACC,GAAR,CACLC,MAAM,CAACC,IAAP,CAAYC,eAASC,KAArB,EAA4BC,GAA5B,CAAgCC,KAAK,IAAI;AACvC,UAAMC,GAAG,GAAGJ,eAASK,GAAT,CAAaF,KAAb,CAAZ;;AACA,QAAIC,GAAG,CAACE,kBAAR,EAA4B;AAC1B,aAAOF,GAAG,CAACE,kBAAJ,CAAuBC,gBAAvB,CAAwCf,IAAxC,CAAP;AACD,KAFD,MAEO;AACL,aAAOI,OAAO,CAACY,OAAR,EAAP;AACD;AACF,GAPD,CADK,CAAP;AAUD",sourcesContent:["import AppCache from './cache';\n\n/**\n * Destroys all data in the database\n * @param {boolean} fast set to true if it's ok to just drop objects and not indexes.\n */\nexport function destroyAllDataPermanently(fast) {\n  if (!process.env.TESTING) {\n    throw 'Only supported in test environment';\n  }\n  return Promise.all(\n    Object.keys(AppCache.cache).map(appId => {\n      const app = AppCache.get(appId);\n      if (app.databaseController) {\n        return app.databaseController.deleteEverything(fast);\n      } else {\n        return Promise.resolve();\n      }\n    })\n  );\n}\n"]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"845ccbc21df5d841ca8fcce5bec031dcee11fd95"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_207dckqi0=function(){return actualCoverage;};}return actualCoverage;}cov_207dckqi0();cov_207dckqi0().s[0]++;Object.defineProperty(exports,"__esModule",{value:true});cov_207dckqi0().s[1]++;exports.destroyAllDataPermanently=destroyAllDataPermanently;var _cache=(cov_207dckqi0().s[2]++,_interopRequireDefault(require("./cache")));function _interopRequireDefault(obj){cov_207dckqi0().f[0]++;cov_207dckqi0().s[3]++;return(cov_207dckqi0().b[1][0]++,obj)&&(cov_207dckqi0().b[1][1]++,obj.__esModule)?(cov_207dckqi0().b[0][0]++,obj):(cov_207dckqi0().b[0][1]++,{default:obj});}/**
 * Destroys all data in the database
 * @param {boolean} fast set to true if it's ok to just drop objects and not indexes.
 */function destroyAllDataPermanently(fast){cov_207dckqi0().f[1]++;cov_207dckqi0().s[4]++;if(!process.env.TESTING){cov_207dckqi0().b[2][0]++;cov_207dckqi0().s[5]++;throw'Only supported in test environment';}else{cov_207dckqi0().b[2][1]++;}cov_207dckqi0().s[6]++;return Promise.all(Object.keys(_cache.default.cache).map(appId=>{cov_207dckqi0().f[2]++;const app=(cov_207dckqi0().s[7]++,_cache.default.get(appId));cov_207dckqi0().s[8]++;if(app.databaseController){cov_207dckqi0().b[3][0]++;cov_207dckqi0().s[9]++;return app.databaseController.deleteEverything(fast);}else{cov_207dckqi0().b[3][1]++;cov_207dckqi0().s[10]++;return Promise.resolve();}}));}//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9UZXN0VXRpbHMuanMiXSwibmFtZXMiOlsiZGVzdHJveUFsbERhdGFQZXJtYW5lbnRseSIsImZhc3QiLCJwcm9jZXNzIiwiZW52IiwiVEVTVElORyIsIlByb21pc2UiLCJhbGwiLCJPYmplY3QiLCJrZXlzIiwiQXBwQ2FjaGUiLCJjYWNoZSIsIm1hcCIsImFwcElkIiwiYXBwIiwiZ2V0IiwiZGF0YWJhc2VDb250cm9sbGVyIiwiZGVsZXRlRXZlcnl0aGluZyIsInJlc29sdmUiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBQTs7OztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ08sU0FBU0EseUJBQVQsQ0FBbUNDLElBQW5DLEVBQXlDO0FBQzlDLE1BQUksQ0FBQ0MsT0FBTyxDQUFDQyxHQUFSLENBQVlDLE9BQWpCLEVBQTBCO0FBQ3hCLFVBQU0sb0NBQU47QUFDRDs7QUFDRCxTQUFPQyxPQUFPLENBQUNDLEdBQVIsQ0FDTEMsTUFBTSxDQUFDQyxJQUFQLENBQVlDLGVBQVNDLEtBQXJCLEVBQTRCQyxHQUE1QixDQUFnQ0MsS0FBSyxJQUFJO0FBQ3ZDLFVBQU1DLEdBQUcsR0FBR0osZUFBU0ssR0FBVCxDQUFhRixLQUFiLENBQVo7O0FBQ0EsUUFBSUMsR0FBRyxDQUFDRSxrQkFBUixFQUE0QjtBQUMxQixhQUFPRixHQUFHLENBQUNFLGtCQUFKLENBQXVCQyxnQkFBdkIsQ0FBd0NmLElBQXhDLENBQVA7QUFDRCxLQUZELE1BRU87QUFDTCxhQUFPSSxPQUFPLENBQUNZLE9BQVIsRUFBUDtBQUNEO0FBQ0YsR0FQRCxDQURLLENBQVA7QUFVRCIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBBcHBDYWNoZSBmcm9tICcuL2NhY2hlJztcblxuLyoqXG4gKiBEZXN0cm95cyBhbGwgZGF0YSBpbiB0aGUgZGF0YWJhc2VcbiAqIEBwYXJhbSB7Ym9vbGVhbn0gZmFzdCBzZXQgdG8gdHJ1ZSBpZiBpdCdzIG9rIHRvIGp1c3QgZHJvcCBvYmplY3RzIGFuZCBub3QgaW5kZXhlcy5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGRlc3Ryb3lBbGxEYXRhUGVybWFuZW50bHkoZmFzdCkge1xuICBpZiAoIXByb2Nlc3MuZW52LlRFU1RJTkcpIHtcbiAgICB0aHJvdyAnT25seSBzdXBwb3J0ZWQgaW4gdGVzdCBlbnZpcm9ubWVudCc7XG4gIH1cbiAgcmV0dXJuIFByb21pc2UuYWxsKFxuICAgIE9iamVjdC5rZXlzKEFwcENhY2hlLmNhY2hlKS5tYXAoYXBwSWQgPT4ge1xuICAgICAgY29uc3QgYXBwID0gQXBwQ2FjaGUuZ2V0KGFwcElkKTtcbiAgICAgIGlmIChhcHAuZGF0YWJhc2VDb250cm9sbGVyKSB7XG4gICAgICAgIHJldHVybiBhcHAuZGF0YWJhc2VDb250cm9sbGVyLmRlbGV0ZUV2ZXJ5dGhpbmcoZmFzdCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgICB9XG4gICAgfSlcbiAgKTtcbn1cbiJdfQ==
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9UZXN0VXRpbHMuanMiXSwibmFtZXMiOlsiZGVzdHJveUFsbERhdGFQZXJtYW5lbnRseSIsInByb2Nlc3MiLCJBcHBDYWNoZSIsImFwcElkIiwiYXBwIiwiUHJvbWlzZSJdLCJtYXBwaW5ncyI6Ind5SEFNTzs0UEFOUCxHQUFBLENBQUEsTUFBQSx5QkFBQSxzQkFBQSxDQUFBLE9BQUEsQ0FBQSxTQUFBLENBQUEsQ0FBQSxDQUFBLEMsZ1BBRUE7QUFDQTtBQUNBO0FBQ0EsR0FDTyxRQUFTQSxDQUFBQSx5QkFBVCxDQUFBLElBQUEsQ0FBeUMsK0NBQzlDLEdBQUksQ0FBQ0MsT0FBTyxDQUFQQSxHQUFBQSxDQUFMLE9BQUEsQ0FBMEIsa0RBQ3hCLEtBQUEsb0NBQUEsQ0FDRCxDQUZELGdDQUQ4Qyx1QkFJOUMsTUFBTyxDQUFBLE9BQU8sQ0FBUCxHQUFBLENBQ0wsTUFBTSxDQUFOLElBQUEsQ0FBWUMsTUFBQUEsQ0FBQUEsT0FBQUEsQ0FBWixLQUFBLEVBQUEsR0FBQSxDQUFnQ0MsS0FBSyxFQUFJLHdCQUN2QyxLQUFNQyxDQUFBQSxHQUFHLHlCQUFHRixNQUFBQSxDQUFBQSxPQUFBQSxDQUFBQSxHQUFBQSxDQUFaLEtBQVlBLENBQUgsQ0FBVCxDQUR1Qyx1QkFFdkMsR0FBSUUsR0FBRyxDQUFQLGtCQUFBLENBQTRCLGtEQUMxQixNQUFPQSxDQUFBQSxHQUFHLENBQUhBLGtCQUFBQSxDQUFBQSxnQkFBQUEsQ0FBUCxJQUFPQSxDQUFQLENBREYsQ0FBQSxJQUVPLG1EQUNMLE1BQU9DLENBQUFBLE9BQU8sQ0FBZCxPQUFPQSxFQUFQLENBQ0QsQ0FQTCxDQUNFLENBREssQ0FBUCxDQVVELEMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgQXBwQ2FjaGUgZnJvbSAnLi9jYWNoZSc7XG5cbi8qKlxuICogRGVzdHJveXMgYWxsIGRhdGEgaW4gdGhlIGRhdGFiYXNlXG4gKiBAcGFyYW0ge2Jvb2xlYW59IGZhc3Qgc2V0IHRvIHRydWUgaWYgaXQncyBvayB0byBqdXN0IGRyb3Agb2JqZWN0cyBhbmQgbm90IGluZGV4ZXMuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBkZXN0cm95QWxsRGF0YVBlcm1hbmVudGx5KGZhc3QpIHtcbiAgaWYgKCFwcm9jZXNzLmVudi5URVNUSU5HKSB7XG4gICAgdGhyb3cgJ09ubHkgc3VwcG9ydGVkIGluIHRlc3QgZW52aXJvbm1lbnQnO1xuICB9XG4gIHJldHVybiBQcm9taXNlLmFsbChcbiAgICBPYmplY3Qua2V5cyhBcHBDYWNoZS5jYWNoZSkubWFwKGFwcElkID0+IHtcbiAgICAgIGNvbnN0IGFwcCA9IEFwcENhY2hlLmdldChhcHBJZCk7XG4gICAgICBpZiAoYXBwLmRhdGFiYXNlQ29udHJvbGxlcikge1xuICAgICAgICByZXR1cm4gYXBwLmRhdGFiYXNlQ29udHJvbGxlci5kZWxldGVFdmVyeXRoaW5nKGZhc3QpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xuICAgICAgfVxuICAgIH0pXG4gICk7XG59XG4iXX0=