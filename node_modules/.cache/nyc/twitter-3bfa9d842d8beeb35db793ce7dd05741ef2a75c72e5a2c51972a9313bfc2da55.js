"use strict";// Helper functions for accessing the twitter API.
function cov_lfenfquzp(){var path="/parse-server/lib/Adapters/Auth/twitter.js";var hash="5a6b02309c5085d8523c8d169871ea11275ad002";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/parse-server/lib/Adapters/Auth/twitter.js",statementMap:{"0":{start:{line:4,column:12},end:{line:4,column:37}},"1":{start:{line:6,column:12},end:{line:6,column:39}},"2":{start:{line:10,column:2},end:{line:12,column:3}},"3":{start:{line:11,column:4},end:{line:11,column:99}},"4":{start:{line:14,column:2},end:{line:14,column:60}},"5":{start:{line:15,column:15},end:{line:15,column:33}},"6":{start:{line:16,column:2},end:{line:16,column:34}},"7":{start:{line:17,column:2},end:{line:17,column:42}},"8":{start:{line:18,column:2},end:{line:18,column:56}},"9":{start:{line:19,column:2},end:{line:25,column:5}},"10":{start:{line:20,column:4},end:{line:22,column:5}},"11":{start:{line:21,column:6},end:{line:21,column:13}},"12":{start:{line:24,column:4},end:{line:24,column:98}},"13":{start:{line:30,column:2},end:{line:30,column:27}},"14":{start:{line:34,column:2},end:{line:50,column:3}},"15":{start:{line:35,column:25},end:{line:35,column:46}},"16":{start:{line:37,column:4},end:{line:39,column:5}},"17":{start:{line:38,column:6},end:{line:38,column:100}},"18":{start:{line:41,column:4},end:{line:43,column:7}},"19":{start:{line:42,column:6},end:{line:42,column:49}},"20":{start:{line:45,column:4},end:{line:47,column:5}},"21":{start:{line:46,column:6},end:{line:46,column:100}},"22":{start:{line:49,column:4},end:{line:49,column:25}},"23":{start:{line:52,column:2},end:{line:52,column:17}},"24":{start:{line:55,column:0},end:{line:59,column:2}}},fnMap:{"0":{name:"validateAuthData",decl:{start:{line:9,column:9},end:{line:9,column:25}},loc:{start:{line:9,column:45},end:{line:26,column:1}},line:9},"1":{name:"(anonymous_1)",decl:{start:{line:19,column:65},end:{line:19,column:66}},loc:{start:{line:19,column:73},end:{line:25,column:3}},line:19},"2":{name:"validateAppId",decl:{start:{line:29,column:9},end:{line:29,column:22}},loc:{start:{line:29,column:25},end:{line:31,column:1}},line:29},"3":{name:"handleMultipleConfigurations",decl:{start:{line:33,column:9},end:{line:33,column:37}},loc:{start:{line:33,column:57},end:{line:53,column:1}},line:33},"4":{name:"(anonymous_4)",decl:{start:{line:41,column:29},end:{line:41,column:30}},loc:{start:{line:41,column:39},end:{line:43,column:5}},line:41}},branchMap:{"0":{loc:{start:{line:10,column:2},end:{line:12,column:3}},type:"if",locations:[{start:{line:10,column:2},end:{line:12,column:3}},{start:{line:10,column:2},end:{line:12,column:3}}],line:10},"1":{loc:{start:{line:20,column:4},end:{line:22,column:5}},type:"if",locations:[{start:{line:20,column:4},end:{line:22,column:5}},{start:{line:20,column:4},end:{line:22,column:5}}],line:20},"2":{loc:{start:{line:20,column:8},end:{line:20,column:47}},type:"binary-expr",locations:[{start:{line:20,column:8},end:{line:20,column:12}},{start:{line:20,column:16},end:{line:20,column:47}}],line:20},"3":{loc:{start:{line:34,column:2},end:{line:50,column:3}},type:"if",locations:[{start:{line:34,column:2},end:{line:50,column:3}},{start:{line:34,column:2},end:{line:50,column:3}}],line:34},"4":{loc:{start:{line:37,column:4},end:{line:39,column:5}},type:"if",locations:[{start:{line:37,column:4},end:{line:39,column:5}},{start:{line:37,column:4},end:{line:39,column:5}}],line:37},"5":{loc:{start:{line:45,column:4},end:{line:47,column:5}},type:"if",locations:[{start:{line:45,column:4},end:{line:47,column:5}},{start:{line:45,column:4},end:{line:47,column:5}}],line:45}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0]},inputSourceMap:{version:3,sources:["../../../src/Adapters/Auth/twitter.js"],names:["OAuth","require","Parse","validateAuthData","authData","options","Error","INTERNAL_SERVER_ERROR","handleMultipleConfigurations","client","host","auth_token","auth_token_secret","get","then","data","id_str","id","OBJECT_NOT_FOUND","validateAppId","Promise","resolve","Array","isArray","consumer_key","filter","option","length","module","exports"],mappings:";;AAAA;AACA,IAAIA,KAAK,GAAGC,OAAO,CAAC,gBAAD,CAAnB;;AACA,IAAIC,KAAK,GAAGD,OAAO,CAAC,YAAD,CAAP,CAAsBC,KAAlC,C,CAEA;;;AACA,SAASC,gBAAT,CAA0BC,QAA1B,EAAoCC,OAApC,EAA6C;AAC3C,MAAI,CAACA,OAAL,EAAc;AACZ,UAAM,IAAIH,KAAK,CAACI,KAAV,CAAgBJ,KAAK,CAACI,KAAN,CAAYC,qBAA5B,EAAmD,oCAAnD,CAAN;AACD;;AACDF,EAAAA,OAAO,GAAGG,4BAA4B,CAACJ,QAAD,EAAWC,OAAX,CAAtC;AACA,MAAII,MAAM,GAAG,IAAIT,KAAJ,CAAUK,OAAV,CAAb;AACAI,EAAAA,MAAM,CAACC,IAAP,GAAc,iBAAd;AACAD,EAAAA,MAAM,CAACE,UAAP,GAAoBP,QAAQ,CAACO,UAA7B;AACAF,EAAAA,MAAM,CAACG,iBAAP,GAA2BR,QAAQ,CAACQ,iBAApC;AAEA,SAAOH,MAAM,CAACI,GAAP,CAAW,sCAAX,EAAmDC,IAAnD,CAAwDC,IAAI,IAAI;AACrE,QAAIA,IAAI,IAAIA,IAAI,CAACC,MAAL,IAAe,KAAKZ,QAAQ,CAACa,EAAzC,EAA6C;AAC3C;AACD;;AACD,UAAM,IAAIf,KAAK,CAACI,KAAV,CAAgBJ,KAAK,CAACI,KAAN,CAAYY,gBAA5B,EAA8C,wCAA9C,CAAN;AACD,GALM,CAAP;AAMD,C,CAED;;;AACA,SAASC,aAAT,GAAyB;AACvB,SAAOC,OAAO,CAACC,OAAR,EAAP;AACD;;AAED,SAASb,4BAAT,CAAsCJ,QAAtC,EAAgDC,OAAhD,EAAyD;AACvD,MAAIiB,KAAK,CAACC,OAAN,CAAclB,OAAd,CAAJ,EAA4B;AAC1B,UAAMmB,YAAY,GAAGpB,QAAQ,CAACoB,YAA9B;;AACA,QAAI,CAACA,YAAL,EAAmB;AACjB,YAAM,IAAItB,KAAK,CAACI,KAAV,CAAgBJ,KAAK,CAACI,KAAN,CAAYY,gBAA5B,EAA8C,wCAA9C,CAAN;AACD;;AACDb,IAAAA,OAAO,GAAGA,OAAO,CAACoB,MAAR,CAAeC,MAAM,IAAI;AACjC,aAAOA,MAAM,CAACF,YAAP,IAAuBA,YAA9B;AACD,KAFS,CAAV;;AAIA,QAAInB,OAAO,CAACsB,MAAR,IAAkB,CAAtB,EAAyB;AACvB,YAAM,IAAIzB,KAAK,CAACI,KAAV,CAAgBJ,KAAK,CAACI,KAAN,CAAYY,gBAA5B,EAA8C,wCAA9C,CAAN;AACD;;AACDb,IAAAA,OAAO,GAAGA,OAAO,CAAC,CAAD,CAAjB;AACD;;AACD,SAAOA,OAAP;AACD;;AAEDuB,MAAM,CAACC,OAAP,GAAiB;AACfV,EAAAA,aADe;AAEfhB,EAAAA,gBAFe;AAGfK,EAAAA;AAHe,CAAjB",sourcesContent:["// Helper functions for accessing the twitter API.\nvar OAuth = require('./OAuth1Client');\nvar Parse = require('parse/node').Parse;\n\n// Returns a promise that fulfills iff this user id is valid.\nfunction validateAuthData(authData, options) {\n  if (!options) {\n    throw new Parse.Error(Parse.Error.INTERNAL_SERVER_ERROR, 'Twitter auth configuration missing');\n  }\n  options = handleMultipleConfigurations(authData, options);\n  var client = new OAuth(options);\n  client.host = 'api.twitter.com';\n  client.auth_token = authData.auth_token;\n  client.auth_token_secret = authData.auth_token_secret;\n\n  return client.get('/1.1/account/verify_credentials.json').then(data => {\n    if (data && data.id_str == '' + authData.id) {\n      return;\n    }\n    throw new Parse.Error(Parse.Error.OBJECT_NOT_FOUND, 'Twitter auth is invalid for this user.');\n  });\n}\n\n// Returns a promise that fulfills iff this app id is valid.\nfunction validateAppId() {\n  return Promise.resolve();\n}\n\nfunction handleMultipleConfigurations(authData, options) {\n  if (Array.isArray(options)) {\n    const consumer_key = authData.consumer_key;\n    if (!consumer_key) {\n      throw new Parse.Error(Parse.Error.OBJECT_NOT_FOUND, 'Twitter auth is invalid for this user.');\n    }\n    options = options.filter(option => {\n      return option.consumer_key == consumer_key;\n    });\n\n    if (options.length == 0) {\n      throw new Parse.Error(Parse.Error.OBJECT_NOT_FOUND, 'Twitter auth is invalid for this user.');\n    }\n    options = options[0];\n  }\n  return options;\n}\n\nmodule.exports = {\n  validateAppId,\n  validateAuthData,\n  handleMultipleConfigurations,\n};\n"]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"5a6b02309c5085d8523c8d169871ea11275ad002"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_lfenfquzp=function(){return actualCoverage;};}return actualCoverage;}cov_lfenfquzp();var OAuth=(cov_lfenfquzp().s[0]++,require('./OAuth1Client'));var Parse=(cov_lfenfquzp().s[1]++,require('parse/node').Parse);// Returns a promise that fulfills iff this user id is valid.
function validateAuthData(authData,options){cov_lfenfquzp().f[0]++;cov_lfenfquzp().s[2]++;if(!options){cov_lfenfquzp().b[0][0]++;cov_lfenfquzp().s[3]++;throw new Parse.Error(Parse.Error.INTERNAL_SERVER_ERROR,'Twitter auth configuration missing');}else{cov_lfenfquzp().b[0][1]++;}cov_lfenfquzp().s[4]++;options=handleMultipleConfigurations(authData,options);var client=(cov_lfenfquzp().s[5]++,new OAuth(options));cov_lfenfquzp().s[6]++;client.host='api.twitter.com';cov_lfenfquzp().s[7]++;client.auth_token=authData.auth_token;cov_lfenfquzp().s[8]++;client.auth_token_secret=authData.auth_token_secret;cov_lfenfquzp().s[9]++;return client.get('/1.1/account/verify_credentials.json').then(data=>{cov_lfenfquzp().f[1]++;cov_lfenfquzp().s[10]++;if((cov_lfenfquzp().b[2][0]++,data)&&(cov_lfenfquzp().b[2][1]++,data.id_str==''+authData.id)){cov_lfenfquzp().b[1][0]++;cov_lfenfquzp().s[11]++;return;}else{cov_lfenfquzp().b[1][1]++;}cov_lfenfquzp().s[12]++;throw new Parse.Error(Parse.Error.OBJECT_NOT_FOUND,'Twitter auth is invalid for this user.');});}// Returns a promise that fulfills iff this app id is valid.
function validateAppId(){cov_lfenfquzp().f[2]++;cov_lfenfquzp().s[13]++;return Promise.resolve();}function handleMultipleConfigurations(authData,options){cov_lfenfquzp().f[3]++;cov_lfenfquzp().s[14]++;if(Array.isArray(options)){cov_lfenfquzp().b[3][0]++;const consumer_key=(cov_lfenfquzp().s[15]++,authData.consumer_key);cov_lfenfquzp().s[16]++;if(!consumer_key){cov_lfenfquzp().b[4][0]++;cov_lfenfquzp().s[17]++;throw new Parse.Error(Parse.Error.OBJECT_NOT_FOUND,'Twitter auth is invalid for this user.');}else{cov_lfenfquzp().b[4][1]++;}cov_lfenfquzp().s[18]++;options=options.filter(option=>{cov_lfenfquzp().f[4]++;cov_lfenfquzp().s[19]++;return option.consumer_key==consumer_key;});cov_lfenfquzp().s[20]++;if(options.length==0){cov_lfenfquzp().b[5][0]++;cov_lfenfquzp().s[21]++;throw new Parse.Error(Parse.Error.OBJECT_NOT_FOUND,'Twitter auth is invalid for this user.');}else{cov_lfenfquzp().b[5][1]++;}cov_lfenfquzp().s[22]++;options=options[0];}else{cov_lfenfquzp().b[3][1]++;}cov_lfenfquzp().s[23]++;return options;}cov_lfenfquzp().s[24]++;module.exports={validateAppId,validateAuthData,handleMultipleConfigurations};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9BZGFwdGVycy9BdXRoL3R3aXR0ZXIuanMiXSwibmFtZXMiOlsiT0F1dGgiLCJyZXF1aXJlIiwiUGFyc2UiLCJ2YWxpZGF0ZUF1dGhEYXRhIiwiYXV0aERhdGEiLCJvcHRpb25zIiwiRXJyb3IiLCJJTlRFUk5BTF9TRVJWRVJfRVJST1IiLCJoYW5kbGVNdWx0aXBsZUNvbmZpZ3VyYXRpb25zIiwiY2xpZW50IiwiaG9zdCIsImF1dGhfdG9rZW4iLCJhdXRoX3Rva2VuX3NlY3JldCIsImdldCIsInRoZW4iLCJkYXRhIiwiaWRfc3RyIiwiaWQiLCJPQkpFQ1RfTk9UX0ZPVU5EIiwidmFsaWRhdGVBcHBJZCIsIlByb21pc2UiLCJyZXNvbHZlIiwiQXJyYXkiLCJpc0FycmF5IiwiY29uc3VtZXJfa2V5IiwiZmlsdGVyIiwib3B0aW9uIiwibGVuZ3RoIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Ijs7QUFBQTtBQUNBLElBQUlBLEtBQUssR0FBR0MsT0FBTyxDQUFDLGdCQUFELENBQW5COztBQUNBLElBQUlDLEtBQUssR0FBR0QsT0FBTyxDQUFDLFlBQUQsQ0FBUCxDQUFzQkMsS0FBbEMsQyxDQUVBOzs7QUFDQSxTQUFTQyxnQkFBVCxDQUEwQkMsUUFBMUIsRUFBb0NDLE9BQXBDLEVBQTZDO0FBQzNDLE1BQUksQ0FBQ0EsT0FBTCxFQUFjO0FBQ1osVUFBTSxJQUFJSCxLQUFLLENBQUNJLEtBQVYsQ0FBZ0JKLEtBQUssQ0FBQ0ksS0FBTixDQUFZQyxxQkFBNUIsRUFBbUQsb0NBQW5ELENBQU47QUFDRDs7QUFDREYsRUFBQUEsT0FBTyxHQUFHRyw0QkFBNEIsQ0FBQ0osUUFBRCxFQUFXQyxPQUFYLENBQXRDO0FBQ0EsTUFBSUksTUFBTSxHQUFHLElBQUlULEtBQUosQ0FBVUssT0FBVixDQUFiO0FBQ0FJLEVBQUFBLE1BQU0sQ0FBQ0MsSUFBUCxHQUFjLGlCQUFkO0FBQ0FELEVBQUFBLE1BQU0sQ0FBQ0UsVUFBUCxHQUFvQlAsUUFBUSxDQUFDTyxVQUE3QjtBQUNBRixFQUFBQSxNQUFNLENBQUNHLGlCQUFQLEdBQTJCUixRQUFRLENBQUNRLGlCQUFwQztBQUVBLFNBQU9ILE1BQU0sQ0FBQ0ksR0FBUCxDQUFXLHNDQUFYLEVBQW1EQyxJQUFuRCxDQUF3REMsSUFBSSxJQUFJO0FBQ3JFLFFBQUlBLElBQUksSUFBSUEsSUFBSSxDQUFDQyxNQUFMLElBQWUsS0FBS1osUUFBUSxDQUFDYSxFQUF6QyxFQUE2QztBQUMzQztBQUNEOztBQUNELFVBQU0sSUFBSWYsS0FBSyxDQUFDSSxLQUFWLENBQWdCSixLQUFLLENBQUNJLEtBQU4sQ0FBWVksZ0JBQTVCLEVBQThDLHdDQUE5QyxDQUFOO0FBQ0QsR0FMTSxDQUFQO0FBTUQsQyxDQUVEOzs7QUFDQSxTQUFTQyxhQUFULEdBQXlCO0FBQ3ZCLFNBQU9DLE9BQU8sQ0FBQ0MsT0FBUixFQUFQO0FBQ0Q7O0FBRUQsU0FBU2IsNEJBQVQsQ0FBc0NKLFFBQXRDLEVBQWdEQyxPQUFoRCxFQUF5RDtBQUN2RCxNQUFJaUIsS0FBSyxDQUFDQyxPQUFOLENBQWNsQixPQUFkLENBQUosRUFBNEI7QUFDMUIsVUFBTW1CLFlBQVksR0FBR3BCLFFBQVEsQ0FBQ29CLFlBQTlCOztBQUNBLFFBQUksQ0FBQ0EsWUFBTCxFQUFtQjtBQUNqQixZQUFNLElBQUl0QixLQUFLLENBQUNJLEtBQVYsQ0FBZ0JKLEtBQUssQ0FBQ0ksS0FBTixDQUFZWSxnQkFBNUIsRUFBOEMsd0NBQTlDLENBQU47QUFDRDs7QUFDRGIsSUFBQUEsT0FBTyxHQUFHQSxPQUFPLENBQUNvQixNQUFSLENBQWVDLE1BQU0sSUFBSTtBQUNqQyxhQUFPQSxNQUFNLENBQUNGLFlBQVAsSUFBdUJBLFlBQTlCO0FBQ0QsS0FGUyxDQUFWOztBQUlBLFFBQUluQixPQUFPLENBQUNzQixNQUFSLElBQWtCLENBQXRCLEVBQXlCO0FBQ3ZCLFlBQU0sSUFBSXpCLEtBQUssQ0FBQ0ksS0FBVixDQUFnQkosS0FBSyxDQUFDSSxLQUFOLENBQVlZLGdCQUE1QixFQUE4Qyx3Q0FBOUMsQ0FBTjtBQUNEOztBQUNEYixJQUFBQSxPQUFPLEdBQUdBLE9BQU8sQ0FBQyxDQUFELENBQWpCO0FBQ0Q7O0FBQ0QsU0FBT0EsT0FBUDtBQUNEOztBQUVEdUIsTUFBTSxDQUFDQyxPQUFQLEdBQWlCO0FBQ2ZWLEVBQUFBLGFBRGU7QUFFZmhCLEVBQUFBLGdCQUZlO0FBR2ZLLEVBQUFBO0FBSGUsQ0FBakIiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBIZWxwZXIgZnVuY3Rpb25zIGZvciBhY2Nlc3NpbmcgdGhlIHR3aXR0ZXIgQVBJLlxudmFyIE9BdXRoID0gcmVxdWlyZSgnLi9PQXV0aDFDbGllbnQnKTtcbnZhciBQYXJzZSA9IHJlcXVpcmUoJ3BhcnNlL25vZGUnKS5QYXJzZTtcblxuLy8gUmV0dXJucyBhIHByb21pc2UgdGhhdCBmdWxmaWxscyBpZmYgdGhpcyB1c2VyIGlkIGlzIHZhbGlkLlxuZnVuY3Rpb24gdmFsaWRhdGVBdXRoRGF0YShhdXRoRGF0YSwgb3B0aW9ucykge1xuICBpZiAoIW9wdGlvbnMpIHtcbiAgICB0aHJvdyBuZXcgUGFyc2UuRXJyb3IoUGFyc2UuRXJyb3IuSU5URVJOQUxfU0VSVkVSX0VSUk9SLCAnVHdpdHRlciBhdXRoIGNvbmZpZ3VyYXRpb24gbWlzc2luZycpO1xuICB9XG4gIG9wdGlvbnMgPSBoYW5kbGVNdWx0aXBsZUNvbmZpZ3VyYXRpb25zKGF1dGhEYXRhLCBvcHRpb25zKTtcbiAgdmFyIGNsaWVudCA9IG5ldyBPQXV0aChvcHRpb25zKTtcbiAgY2xpZW50Lmhvc3QgPSAnYXBpLnR3aXR0ZXIuY29tJztcbiAgY2xpZW50LmF1dGhfdG9rZW4gPSBhdXRoRGF0YS5hdXRoX3Rva2VuO1xuICBjbGllbnQuYXV0aF90b2tlbl9zZWNyZXQgPSBhdXRoRGF0YS5hdXRoX3Rva2VuX3NlY3JldDtcblxuICByZXR1cm4gY2xpZW50LmdldCgnLzEuMS9hY2NvdW50L3ZlcmlmeV9jcmVkZW50aWFscy5qc29uJykudGhlbihkYXRhID0+IHtcbiAgICBpZiAoZGF0YSAmJiBkYXRhLmlkX3N0ciA9PSAnJyArIGF1dGhEYXRhLmlkKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRocm93IG5ldyBQYXJzZS5FcnJvcihQYXJzZS5FcnJvci5PQkpFQ1RfTk9UX0ZPVU5ELCAnVHdpdHRlciBhdXRoIGlzIGludmFsaWQgZm9yIHRoaXMgdXNlci4nKTtcbiAgfSk7XG59XG5cbi8vIFJldHVybnMgYSBwcm9taXNlIHRoYXQgZnVsZmlsbHMgaWZmIHRoaXMgYXBwIGlkIGlzIHZhbGlkLlxuZnVuY3Rpb24gdmFsaWRhdGVBcHBJZCgpIHtcbiAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVNdWx0aXBsZUNvbmZpZ3VyYXRpb25zKGF1dGhEYXRhLCBvcHRpb25zKSB7XG4gIGlmIChBcnJheS5pc0FycmF5KG9wdGlvbnMpKSB7XG4gICAgY29uc3QgY29uc3VtZXJfa2V5ID0gYXV0aERhdGEuY29uc3VtZXJfa2V5O1xuICAgIGlmICghY29uc3VtZXJfa2V5KSB7XG4gICAgICB0aHJvdyBuZXcgUGFyc2UuRXJyb3IoUGFyc2UuRXJyb3IuT0JKRUNUX05PVF9GT1VORCwgJ1R3aXR0ZXIgYXV0aCBpcyBpbnZhbGlkIGZvciB0aGlzIHVzZXIuJyk7XG4gICAgfVxuICAgIG9wdGlvbnMgPSBvcHRpb25zLmZpbHRlcihvcHRpb24gPT4ge1xuICAgICAgcmV0dXJuIG9wdGlvbi5jb25zdW1lcl9rZXkgPT0gY29uc3VtZXJfa2V5O1xuICAgIH0pO1xuXG4gICAgaWYgKG9wdGlvbnMubGVuZ3RoID09IDApIHtcbiAgICAgIHRocm93IG5ldyBQYXJzZS5FcnJvcihQYXJzZS5FcnJvci5PQkpFQ1RfTk9UX0ZPVU5ELCAnVHdpdHRlciBhdXRoIGlzIGludmFsaWQgZm9yIHRoaXMgdXNlci4nKTtcbiAgICB9XG4gICAgb3B0aW9ucyA9IG9wdGlvbnNbMF07XG4gIH1cbiAgcmV0dXJuIG9wdGlvbnM7XG59XG5cbm1vZHVsZS5leHBvcnRzID0ge1xuICB2YWxpZGF0ZUFwcElkLFxuICB2YWxpZGF0ZUF1dGhEYXRhLFxuICBoYW5kbGVNdWx0aXBsZUNvbmZpZ3VyYXRpb25zLFxufTtcbiJdfQ==
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9BZGFwdGVycy9BdXRoL3R3aXR0ZXIuanMiXSwibmFtZXMiOlsiT0F1dGgiLCJyZXF1aXJlIiwiUGFyc2UiLCJvcHRpb25zIiwiaGFuZGxlTXVsdGlwbGVDb25maWd1cmF0aW9ucyIsImNsaWVudCIsImhvc3QiLCJhdXRoRGF0YSIsImRhdGEiLCJQcm9taXNlIiwiQXJyYXkiLCJjb25zdW1lcl9rZXkiLCJvcHRpb24iLCJtb2R1bGUiXSwibWFwcGluZ3MiOiJhQUFBOzJtUEFXRUs7eUZBVkYsR0FBSUwsQ0FBQUEsS0FBSyx5QkFBR0MsT0FBTyxDQUFuQixnQkFBbUIsQ0FBVixDQUFULENBQ0EsR0FBSUMsQ0FBQUEsS0FBSyx5QkFBR0QsT0FBTyxDQUFQQSxZQUFPLENBQVBBLENBQVosS0FBUyxDQUFULENBRUE7QUFDQSxRQUFBLENBQUEsZ0JBQUEsQ0FBQSxRQUFBLENBQUEsT0FBQSxDQUE2QywrQ0FDM0MsR0FBSSxDQUFKLE9BQUEsQ0FBYyxrREFDWixLQUFNLElBQUlDLENBQUFBLEtBQUssQ0FBVCxLQUFBLENBQWdCQSxLQUFLLENBQUxBLEtBQUFBLENBQWhCLHFCQUFBLENBQU4sb0NBQU0sQ0FBTixDQUNELENBRkQsZ0NBRDJDLHVCQUkzQ0MsT0FBTyxDQUFHQyw0QkFBNEIsQ0FBQSxRQUFBLENBQXRDRCxPQUFzQyxDQUF0Q0EsQ0FDQSxHQUFJRSxDQUFBQSxNQUFNLHlCQUFHLEdBQUEsQ0FBQSxLQUFBLENBQWIsT0FBYSxDQUFILENBQVYsQ0FMMkMsdUJBTTNDQSxNQUFNLENBQUNDLElBQVBELENBQUFBLGlCQUFBQSxDQU4yQyx1QkFPM0NBLE1BQU0sQ0FBTkEsVUFBQUEsQ0FBb0JFLFFBQVEsQ0FBNUJGLFVBQUFBLENBUDJDLHVCQVEzQ0EsTUFBTSxDQUFOQSxpQkFBQUEsQ0FBMkJFLFFBQVEsQ0FBbkNGLGlCQUFBQSxDQVIyQyx1QkFVM0MsTUFBTyxDQUFBLE1BQU0sQ0FBTixHQUFBLENBQUEsc0NBQUEsRUFBQSxJQUFBLENBQXdERyxJQUFJLEVBQUksZ0RBQ3JFLEdBQUlBLDJCQUFBQSxJQUFJLDhCQUFJQSxJQUFJLENBQUpBLE1BQUFBLEVBQWUsR0FBS0QsUUFBUSxDQUF4QyxFQUFRLENBQVIsQ0FBNkMsbURBQzNDLE9BQ0QsQ0FGRCxnQ0FEcUUsd0JBSXJFLEtBQU0sSUFBSUwsQ0FBQUEsS0FBSyxDQUFULEtBQUEsQ0FBZ0JBLEtBQUssQ0FBTEEsS0FBQUEsQ0FBaEIsZ0JBQUEsQ0FBTix3Q0FBTSxDQUFOLENBSkYsQ0FBTyxDQUFQLEMsQ0FRRjtBQUNBLFFBQUEsQ0FBQSxhQUFBLEVBQXlCLGdEQUN2QixNQUFPTyxDQUFBQSxPQUFPLENBQWQsT0FBT0EsRUFBUCxDQUNELENBRUQsUUFBQSxDQUFBLDRCQUFBLENBQUEsUUFBQSxDQUFBLE9BQUEsQ0FBeUQsZ0RBQ3ZELEdBQUlDLEtBQUssQ0FBTEEsT0FBQUEsQ0FBSixPQUFJQSxDQUFKLENBQTRCLDJCQUMxQixLQUFNQyxDQUFBQSxZQUFZLDBCQUFHSixRQUFRLENBQTdCLFlBQWtCLENBQWxCLENBRDBCLHdCQUUxQixHQUFJLENBQUosWUFBQSxDQUFtQixtREFDakIsS0FBTSxJQUFJTCxDQUFBQSxLQUFLLENBQVQsS0FBQSxDQUFnQkEsS0FBSyxDQUFMQSxLQUFBQSxDQUFoQixnQkFBQSxDQUFOLHdDQUFNLENBQU4sQ0FDRCxDQUZELGdDQUYwQix3QkFLMUJDLE9BQU8sQ0FBRyxPQUFPLENBQVAsTUFBQSxDQUFlUyxNQUFNLEVBQUksZ0RBQ2pDLE1BQU9BLENBQUFBLE1BQU0sQ0FBTkEsWUFBQUEsRUFBUCxZQUFBLENBREZULENBQVUsQ0FBVkEsQ0FMMEIsd0JBUzFCLEdBQUlBLE9BQU8sQ0FBUEEsTUFBQUEsRUFBSixDQUFBLENBQXlCLG1EQUN2QixLQUFNLElBQUlELENBQUFBLEtBQUssQ0FBVCxLQUFBLENBQWdCQSxLQUFLLENBQUxBLEtBQUFBLENBQWhCLGdCQUFBLENBQU4sd0NBQU0sQ0FBTixDQUNELENBRkQsZ0NBVDBCLHdCQVkxQkMsT0FBTyxDQUFHQSxPQUFPLENBQWpCQSxDQUFpQixDQUFqQkEsQ0FDRCxDQWJELGdDQUR1RCx3QkFldkQsTUFBQSxDQUFBLE9BQUEsQ0FDRCxDLHdCQUVEVSxNQUFNLENBQU5BLE9BQUFBLENBQWlCLENBQUEsYUFBQSxDQUFBLGdCQUFBLENBR2ZULDRCQUhlLENBQWpCUyxDIiwic291cmNlc0NvbnRlbnQiOlsiLy8gSGVscGVyIGZ1bmN0aW9ucyBmb3IgYWNjZXNzaW5nIHRoZSB0d2l0dGVyIEFQSS5cbnZhciBPQXV0aCA9IHJlcXVpcmUoJy4vT0F1dGgxQ2xpZW50Jyk7XG52YXIgUGFyc2UgPSByZXF1aXJlKCdwYXJzZS9ub2RlJykuUGFyc2U7XG5cbi8vIFJldHVybnMgYSBwcm9taXNlIHRoYXQgZnVsZmlsbHMgaWZmIHRoaXMgdXNlciBpZCBpcyB2YWxpZC5cbmZ1bmN0aW9uIHZhbGlkYXRlQXV0aERhdGEoYXV0aERhdGEsIG9wdGlvbnMpIHtcbiAgaWYgKCFvcHRpb25zKSB7XG4gICAgdGhyb3cgbmV3IFBhcnNlLkVycm9yKFBhcnNlLkVycm9yLklOVEVSTkFMX1NFUlZFUl9FUlJPUiwgJ1R3aXR0ZXIgYXV0aCBjb25maWd1cmF0aW9uIG1pc3NpbmcnKTtcbiAgfVxuICBvcHRpb25zID0gaGFuZGxlTXVsdGlwbGVDb25maWd1cmF0aW9ucyhhdXRoRGF0YSwgb3B0aW9ucyk7XG4gIHZhciBjbGllbnQgPSBuZXcgT0F1dGgob3B0aW9ucyk7XG4gIGNsaWVudC5ob3N0ID0gJ2FwaS50d2l0dGVyLmNvbSc7XG4gIGNsaWVudC5hdXRoX3Rva2VuID0gYXV0aERhdGEuYXV0aF90b2tlbjtcbiAgY2xpZW50LmF1dGhfdG9rZW5fc2VjcmV0ID0gYXV0aERhdGEuYXV0aF90b2tlbl9zZWNyZXQ7XG5cbiAgcmV0dXJuIGNsaWVudC5nZXQoJy8xLjEvYWNjb3VudC92ZXJpZnlfY3JlZGVudGlhbHMuanNvbicpLnRoZW4oZGF0YSA9PiB7XG4gICAgaWYgKGRhdGEgJiYgZGF0YS5pZF9zdHIgPT0gJycgKyBhdXRoRGF0YS5pZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aHJvdyBuZXcgUGFyc2UuRXJyb3IoUGFyc2UuRXJyb3IuT0JKRUNUX05PVF9GT1VORCwgJ1R3aXR0ZXIgYXV0aCBpcyBpbnZhbGlkIGZvciB0aGlzIHVzZXIuJyk7XG4gIH0pO1xufVxuXG4vLyBSZXR1cm5zIGEgcHJvbWlzZSB0aGF0IGZ1bGZpbGxzIGlmZiB0aGlzIGFwcCBpZCBpcyB2YWxpZC5cbmZ1bmN0aW9uIHZhbGlkYXRlQXBwSWQoKSB7XG4gIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlTXVsdGlwbGVDb25maWd1cmF0aW9ucyhhdXRoRGF0YSwgb3B0aW9ucykge1xuICBpZiAoQXJyYXkuaXNBcnJheShvcHRpb25zKSkge1xuICAgIGNvbnN0IGNvbnN1bWVyX2tleSA9IGF1dGhEYXRhLmNvbnN1bWVyX2tleTtcbiAgICBpZiAoIWNvbnN1bWVyX2tleSkge1xuICAgICAgdGhyb3cgbmV3IFBhcnNlLkVycm9yKFBhcnNlLkVycm9yLk9CSkVDVF9OT1RfRk9VTkQsICdUd2l0dGVyIGF1dGggaXMgaW52YWxpZCBmb3IgdGhpcyB1c2VyLicpO1xuICAgIH1cbiAgICBvcHRpb25zID0gb3B0aW9ucy5maWx0ZXIob3B0aW9uID0+IHtcbiAgICAgIHJldHVybiBvcHRpb24uY29uc3VtZXJfa2V5ID09IGNvbnN1bWVyX2tleTtcbiAgICB9KTtcblxuICAgIGlmIChvcHRpb25zLmxlbmd0aCA9PSAwKSB7XG4gICAgICB0aHJvdyBuZXcgUGFyc2UuRXJyb3IoUGFyc2UuRXJyb3IuT0JKRUNUX05PVF9GT1VORCwgJ1R3aXR0ZXIgYXV0aCBpcyBpbnZhbGlkIGZvciB0aGlzIHVzZXIuJyk7XG4gICAgfVxuICAgIG9wdGlvbnMgPSBvcHRpb25zWzBdO1xuICB9XG4gIHJldHVybiBvcHRpb25zO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgdmFsaWRhdGVBcHBJZCxcbiAgdmFsaWRhdGVBdXRoRGF0YSxcbiAgaGFuZGxlTXVsdGlwbGVDb25maWd1cmF0aW9ucyxcbn07XG4iXX0=