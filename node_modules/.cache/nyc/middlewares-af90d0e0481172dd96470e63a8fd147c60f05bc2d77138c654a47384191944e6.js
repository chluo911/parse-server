"use strict";function cov_2mghmeqoe3(){var path="/parse-server/lib/middlewares.js";var hash="4f62cd50b0d8160b90be9a5f8479537a488ff865";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/parse-server/lib/middlewares.js",statementMap:{"0":{start:{line:3,column:0},end:{line:5,column:3}},"1":{start:{line:6,column:0},end:{line:6,column:48}},"2":{start:{line:7,column:0},end:{line:7,column:44}},"3":{start:{line:8,column:0},end:{line:8,column:50}},"4":{start:{line:9,column:0},end:{line:9,column:46}},"5":{start:{line:10,column:0},end:{line:10,column:56}},"6":{start:{line:11,column:0},end:{line:11,column:70}},"7":{start:{line:12,column:0},end:{line:12,column:60}},"8":{start:{line:13,column:0},end:{line:13,column:41}},"9":{start:{line:15,column:13},end:{line:15,column:55}},"10":{start:{line:17,column:12},end:{line:17,column:57}},"11":{start:{line:19,column:12},end:{line:19,column:53}},"12":{start:{line:21,column:14},end:{line:21,column:57}},"13":{start:{line:23,column:17},end:{line:23,column:63}},"14":{start:{line:25,column:14},end:{line:25,column:57}},"15":{start:{line:27,column:12},end:{line:27,column:53}},"16":{start:{line:29,column:27},end:{line:29,column:106}},"17":{start:{line:31,column:39},end:{line:31,column:93}},"18":{start:{line:33,column:32},end:{line:33,column:271}},"19":{start:{line:34,column:0},end:{line:34,column:58}},"20":{start:{line:36,column:27},end:{line:40,column:1}},"21":{start:{line:37,column:26},end:{line:37,column:65}},"22":{start:{line:38,column:20},end:{line:38,column:61}},"23":{start:{line:39,column:2},end:{line:39,column:60}},"24":{start:{line:49,column:14},end:{line:49,column:37}},"25":{start:{line:50,column:16},end:{line:50,column:18}},"26":{start:{line:52,column:2},end:{line:62,column:3}},"27":{start:{line:53,column:4},end:{line:61,column:5}},"28":{start:{line:54,column:6},end:{line:54,column:61}},"29":{start:{line:56,column:6},end:{line:58,column:7}},"30":{start:{line:57,column:8},end:{line:57,column:41}},"31":{start:{line:60,column:6},end:{line:60,column:40}},"32":{start:{line:64,column:13},end:{line:75,column:3}},"33":{start:{line:76,column:18},end:{line:76,column:31}},"34":{start:{line:78,column:2},end:{line:86,column:3}},"35":{start:{line:79,column:25},end:{line:79,column:40}},"36":{start:{line:81,column:4},end:{line:85,column:5}},"37":{start:{line:82,column:6},end:{line:82,column:34}},"38":{start:{line:83,column:6},end:{line:83,column:61}},"39":{start:{line:84,column:6},end:{line:84,column:73}},"40":{start:{line:88,column:2},end:{line:92,column:3}},"41":{start:{line:91,column:4},end:{line:91,column:28}},"42":{start:{line:94,column:20},end:{line:94,column:25}},"43":{start:{line:96,column:2},end:{line:169,column:3}},"44":{start:{line:98,column:4},end:{line:111,column:5}},"45":{start:{line:104,column:6},end:{line:108,column:7}},"46":{start:{line:105,column:8},end:{line:105,column:40}},"47":{start:{line:107,column:8},end:{line:107,column:40}},"48":{start:{line:110,column:6},end:{line:110,column:25}},"49":{start:{line:113,column:4},end:{line:115,column:5}},"50":{start:{line:114,column:6},end:{line:114,column:40}},"51":{start:{line:117,column:4},end:{line:168,column:5}},"52":{start:{line:118,column:6},end:{line:118,column:43}},"53":{start:{line:119,column:6},end:{line:119,column:57}},"54":{start:{line:120,column:6},end:{line:120,column:37}},"55":{start:{line:121,column:6},end:{line:121,column:37}},"56":{start:{line:124,column:6},end:{line:127,column:7}},"57":{start:{line:125,column:8},end:{line:125,column:53}},"58":{start:{line:126,column:8},end:{line:126,column:39}},"59":{start:{line:129,column:6},end:{line:132,column:7}},"60":{start:{line:130,column:8},end:{line:130,column:55}},"61":{start:{line:131,column:8},end:{line:131,column:40}},"62":{start:{line:134,column:6},end:{line:137,column:7}},"63":{start:{line:135,column:8},end:{line:135,column:51}},"64":{start:{line:136,column:8},end:{line:136,column:38}},"65":{start:{line:139,column:6},end:{line:142,column:7}},"66":{start:{line:140,column:8},end:{line:140,column:45}},"67":{start:{line:141,column:8},end:{line:141,column:35}},"68":{start:{line:144,column:6},end:{line:160,column:7}},"69":{start:{line:145,column:8},end:{line:157,column:9}},"70":{start:{line:146,column:10},end:{line:146,column:43}},"71":{start:{line:148,column:10},end:{line:156,column:11}},"72":{start:{line:149,column:12},end:{line:149,column:57}},"73":{start:{line:151,column:12},end:{line:153,column:13}},"74":{start:{line:152,column:14},end:{line:152,column:47}},"75":{start:{line:155,column:12},end:{line:155,column:46}},"76":{start:{line:159,column:8},end:{line:159,column:33}},"77":{start:{line:162,column:6},end:{line:165,column:7}},"78":{start:{line:163,column:8},end:{line:163,column:60}},"79":{start:{line:164,column:8},end:{line:164,column:37}},"80":{start:{line:167,column:6},end:{line:167,column:38}},"81":{start:{line:171,column:2},end:{line:173,column:3}},"82":{start:{line:172,column:4},end:{line:172,column:53}},"83":{start:{line:175,column:2},end:{line:177,column:3}},"84":{start:{line:176,column:4},end:{line:176,column:71}},"85":{start:{line:179,column:2},end:{line:184,column:3}},"86":{start:{line:180,column:4},end:{line:180,column:37}},"87":{start:{line:182,column:17},end:{line:182,column:32}},"88":{start:{line:183,column:4},end:{line:183,column:45}},"89":{start:{line:186,column:19},end:{line:186,column:35}},"90":{start:{line:187,column:2},end:{line:187,column:44}},"91":{start:{line:188,column:2},end:{line:188,column:54}},"92":{start:{line:189,column:2},end:{line:189,column:41}},"93":{start:{line:190,column:2},end:{line:190,column:27}},"94":{start:{line:191,column:2},end:{line:191,column:18}},"95":{start:{line:193,column:2},end:{line:195,column:3}},"96":{start:{line:194,column:4},end:{line:194,column:36}},"97":{start:{line:197,column:17},end:{line:197,column:56}},"98":{start:{line:199,column:2},end:{line:207,column:3}},"99":{start:{line:200,column:4},end:{line:204,column:7}},"100":{start:{line:205,column:4},end:{line:205,column:11}},"101":{start:{line:206,column:4},end:{line:206,column:11}},"102":{start:{line:209,column:25},end:{line:209,column:72}},"103":{start:{line:211,column:2},end:{line:220,column:3}},"104":{start:{line:212,column:4},end:{line:217,column:7}},"105":{start:{line:218,column:4},end:{line:218,column:11}},"106":{start:{line:219,column:4},end:{line:219,column:11}},"107":{start:{line:224,column:15},end:{line:224,column:72}},"108":{start:{line:225,column:27},end:{line:227,column:4}},"109":{start:{line:226,column:4},end:{line:226,column:41}},"110":{start:{line:228,column:24},end:{line:230,column:4}},"111":{start:{line:229,column:4},end:{line:229,column:74}},"112":{start:{line:232,column:2},end:{line:234,column:3}},"113":{start:{line:233,column:4},end:{line:233,column:36}},"114":{start:{line:236,column:2},end:{line:238,column:3}},"115":{start:{line:237,column:4},end:{line:237,column:29}},"116":{start:{line:240,column:2},end:{line:249,column:3}},"117":{start:{line:241,column:4},end:{line:246,column:7}},"118":{start:{line:247,column:4},end:{line:247,column:11}},"119":{start:{line:248,column:4},end:{line:248,column:11}},"120":{start:{line:251,column:2},end:{line:259,column:3}},"121":{start:{line:252,column:4},end:{line:256,column:7}},"122":{start:{line:257,column:4},end:{line:257,column:11}},"123":{start:{line:258,column:4},end:{line:258,column:11}},"124":{start:{line:261,column:2},end:{line:290,column:5}},"125":{start:{line:263,column:4},end:{line:275,column:5}},"126":{start:{line:264,column:6},end:{line:268,column:9}},"127":{start:{line:270,column:6},end:{line:274,column:9}},"128":{start:{line:277,column:4},end:{line:280,column:5}},"129":{start:{line:278,column:6},end:{line:278,column:22}},"130":{start:{line:279,column:6},end:{line:279,column:13}},"131":{start:{line:282,column:4},end:{line:289,column:5}},"132":{start:{line:283,column:6},end:{line:283,column:18}},"133":{start:{line:284,column:6},end:{line:284,column:13}},"134":{start:{line:287,column:6},end:{line:287,column:86}},"135":{start:{line:288,column:6},end:{line:288,column:78}},"136":{start:{line:294,column:2},end:{line:309,column:3}},"137":{start:{line:296,column:4},end:{line:296,column:56}},"138":{start:{line:297,column:9},end:{line:309,column:3}},"139":{start:{line:299,column:4},end:{line:299,column:40}},"140":{start:{line:300,column:9},end:{line:309,column:3}},"141":{start:{line:302,column:4},end:{line:302,column:36}},"142":{start:{line:303,column:9},end:{line:309,column:3}},"143":{start:{line:305,column:4},end:{line:305,column:47}},"144":{start:{line:308,column:4},end:{line:308,column:18}},"145":{start:{line:313,column:2},end:{line:313,column:54}},"146":{start:{line:313,column:47},end:{line:313,column:54}},"147":{start:{line:314,column:15},end:{line:314,column:53}},"148":{start:{line:317,column:19},end:{line:317,column:27}},"149":{start:{line:318,column:14},end:{line:318,column:54}},"150":{start:{line:320,column:2},end:{line:336,column:3}},"151":{start:{line:321,column:22},end:{line:321,column:72}},"152":{start:{line:322,column:22},end:{line:322,column:58}},"153":{start:{line:324,column:4},end:{line:335,column:5}},"154":{start:{line:325,column:6},end:{line:325,column:29}},"155":{start:{line:326,column:16},end:{line:326,column:30}},"156":{start:{line:327,column:24},end:{line:327,column:41}},"157":{start:{line:328,column:21},end:{line:328,column:45}},"158":{start:{line:330,column:6},end:{line:334,column:7}},"159":{start:{line:331,column:8},end:{line:331,column:70}},"160":{start:{line:333,column:8},end:{line:333,column:24}},"161":{start:{line:338,column:2},end:{line:342,column:4}},"162":{start:{line:346,column:2},end:{line:346,column:47}},"163":{start:{line:350,column:2},end:{line:370,column:4}},"164":{start:{line:351,column:19},end:{line:351,column:70}},"165":{start:{line:353,column:23},end:{line:353,column:46}},"166":{start:{line:355,column:4},end:{line:357,column:5}},"167":{start:{line:356,column:6},end:{line:356,column:60}},"168":{start:{line:359,column:24},end:{line:359,column:59}},"169":{start:{line:360,column:4},end:{line:360,column:59}},"170":{start:{line:361,column:4},end:{line:361,column:78}},"171":{start:{line:362,column:4},end:{line:362,column:61}},"172":{start:{line:363,column:4},end:{line:363,column:97}},"173":{start:{line:365,column:4},end:{line:369,column:5}},"174":{start:{line:366,column:6},end:{line:366,column:26}},"175":{start:{line:368,column:6},end:{line:368,column:13}},"176":{start:{line:374,column:2},end:{line:378,column:3}},"177":{start:{line:375,column:4},end:{line:375,column:36}},"178":{start:{line:376,column:4},end:{line:376,column:34}},"179":{start:{line:377,column:4},end:{line:377,column:28}},"180":{start:{line:380,column:2},end:{line:380,column:9}},"181":{start:{line:384,column:14},end:{line:384,column:74}},"182":{start:{line:386,column:2},end:{line:432,column:3}},"183":{start:{line:387,column:4},end:{line:389,column:5}},"184":{start:{line:388,column:6},end:{line:388,column:23}},"185":{start:{line:393,column:4},end:{line:404,column:5}},"186":{start:{line:395,column:8},end:{line:395,column:25}},"187":{start:{line:396,column:8},end:{line:396,column:14}},"188":{start:{line:399,column:8},end:{line:399,column:25}},"189":{start:{line:400,column:8},end:{line:400,column:14}},"190":{start:{line:403,column:8},end:{line:403,column:25}},"191":{start:{line:406,column:4},end:{line:406,column:27}},"192":{start:{line:407,column:4},end:{line:410,column:7}},"193":{start:{line:411,column:4},end:{line:411,column:36}},"194":{start:{line:412,column:9},end:{line:432,column:3}},"195":{start:{line:413,column:4},end:{line:413,column:27}},"196":{start:{line:414,column:4},end:{line:416,column:7}},"197":{start:{line:418,column:4},end:{line:420,column:5}},"198":{start:{line:419,column:6},end:{line:419,column:16}},"199":{start:{line:422,column:4},end:{line:422,column:65}},"200":{start:{line:423,column:4},end:{line:423,column:20}},"201":{start:{line:424,column:4},end:{line:427,column:7}},"202":{start:{line:429,column:4},end:{line:431,column:5}},"203":{start:{line:430,column:6},end:{line:430,column:16}},"204":{start:{line:436,column:2},end:{line:440,column:3}},"205":{start:{line:437,column:4},end:{line:437,column:20}},"206":{start:{line:438,column:4},end:{line:438,column:64}},"207":{start:{line:439,column:4},end:{line:439,column:11}},"208":{start:{line:442,column:2},end:{line:442,column:9}},"209":{start:{line:446,column:2},end:{line:451,column:3}},"210":{start:{line:447,column:18},end:{line:447,column:29}},"211":{start:{line:448,column:4},end:{line:448,column:23}},"212":{start:{line:449,column:4},end:{line:449,column:59}},"213":{start:{line:450,column:4},end:{line:450,column:16}},"214":{start:{line:453,column:2},end:{line:453,column:27}},"215":{start:{line:465,column:2},end:{line:467,column:3}},"216":{start:{line:466,column:4},end:{line:466,column:29}},"217":{start:{line:470,column:17},end:{line:470,column:27}},"218":{start:{line:471,column:20},end:{line:471,column:69}},"219":{start:{line:475,column:6},end:{line:475,column:31}},"220":{start:{line:477,column:2},end:{line:479,column:3}},"221":{start:{line:478,column:4},end:{line:478,column:29}},"222":{start:{line:483,column:18},end:{line:483,column:49}},"223":{start:{line:485,column:14},end:{line:485,column:19}},"224":{start:{line:487,column:2},end:{line:495,column:3}},"225":{start:{line:489,column:18},end:{line:489,column:72}},"226":{start:{line:491,column:4},end:{line:494,column:5}},"227":{start:{line:492,column:6},end:{line:492,column:19}},"228":{start:{line:493,column:6},end:{line:493,column:12}},"229":{start:{line:497,column:2},end:{line:499,column:3}},"230":{start:{line:498,column:4},end:{line:498,column:29}},"231":{start:{line:502,column:21},end:{line:502,column:83}},"232":{start:{line:503,column:2},end:{line:512,column:5}},"233":{start:{line:507,column:4},end:{line:509,column:5}},"234":{start:{line:508,column:6},end:{line:508,column:96}},"235":{start:{line:511,column:4},end:{line:511,column:12}},"236":{start:{line:516,column:2},end:{line:516,column:18}},"237":{start:{line:517,column:2},end:{line:517,column:38}},"238":{start:{line:521,column:2},end:{line:521,column:18}},"239":{start:{line:522,column:2},end:{line:525,column:5}}},fnMap:{"0":{name:"_interopRequireDefault",decl:{start:{line:31,column:9},end:{line:31,column:31}},loc:{start:{line:31,column:37},end:{line:31,column:95}},line:31},"1":{name:"(anonymous_1)",decl:{start:{line:36,column:27},end:{line:36,column:28}},loc:{start:{line:36,column:42},end:{line:40,column:1}},line:36},"2":{name:"handleParseHeaders",decl:{start:{line:48,column:9},end:{line:48,column:27}},loc:{start:{line:48,column:44},end:{line:291,column:1}},line:48},"3":{name:"(anonymous_3)",decl:{start:{line:225,column:37},end:{line:225,column:38}},loc:{start:{line:225,column:52},end:{line:227,column:3}},line:225},"4":{name:"(anonymous_4)",decl:{start:{line:228,column:34},end:{line:228,column:35}},loc:{start:{line:228,column:49},end:{line:230,column:3}},line:228},"5":{name:"(anonymous_5)",decl:{start:{line:261,column:32},end:{line:261,column:33}},loc:{start:{line:261,column:38},end:{line:276,column:3}},line:261},"6":{name:"(anonymous_6)",decl:{start:{line:276,column:10},end:{line:276,column:11}},loc:{start:{line:276,column:18},end:{line:281,column:3}},line:276},"7":{name:"(anonymous_7)",decl:{start:{line:281,column:11},end:{line:281,column:12}},loc:{start:{line:281,column:20},end:{line:290,column:3}},line:281},"8":{name:"getClientIp",decl:{start:{line:293,column:9},end:{line:293,column:20}},loc:{start:{line:293,column:26},end:{line:310,column:1}},line:293},"9":{name:"httpAuth",decl:{start:{line:312,column:9},end:{line:312,column:17}},loc:{start:{line:312,column:23},end:{line:343,column:1}},line:312},"10":{name:"decodeBase64",decl:{start:{line:345,column:9},end:{line:345,column:21}},loc:{start:{line:345,column:27},end:{line:347,column:1}},line:345},"11":{name:"allowCrossDomain",decl:{start:{line:349,column:9},end:{line:349,column:25}},loc:{start:{line:349,column:33},end:{line:371,column:1}},line:349},"12":{name:"(anonymous_12)",decl:{start:{line:350,column:9},end:{line:350,column:10}},loc:{start:{line:350,column:29},end:{line:370,column:3}},line:350},"13":{name:"allowMethodOverride",decl:{start:{line:373,column:9},end:{line:373,column:28}},loc:{start:{line:373,column:45},end:{line:381,column:1}},line:373},"14":{name:"handleParseErrors",decl:{start:{line:383,column:9},end:{line:383,column:26}},loc:{start:{line:383,column:48},end:{line:433,column:1}},line:383},"15":{name:"enforceMasterKeyAccess",decl:{start:{line:435,column:9},end:{line:435,column:31}},loc:{start:{line:435,column:48},end:{line:443,column:1}},line:435},"16":{name:"promiseEnforceMasterKeyAccess",decl:{start:{line:445,column:9},end:{line:445,column:38}},loc:{start:{line:445,column:48},end:{line:454,column:1}},line:445},"17":{name:"promiseEnsureIdempotency",decl:{start:{line:463,column:9},end:{line:463,column:33}},loc:{start:{line:463,column:39},end:{line:513,column:1}},line:463},"18":{name:"(anonymous_18)",decl:{start:{line:506,column:11},end:{line:506,column:12}},loc:{start:{line:506,column:16},end:{line:512,column:3}},line:506},"19":{name:"invalidRequest",decl:{start:{line:515,column:9},end:{line:515,column:23}},loc:{start:{line:515,column:34},end:{line:518,column:1}},line:515},"20":{name:"malformedContext",decl:{start:{line:520,column:9},end:{line:520,column:25}},loc:{start:{line:520,column:36},end:{line:526,column:1}},line:520}},branchMap:{"0":{loc:{start:{line:31,column:46},end:{line:31,column:92}},type:"cond-expr",locations:[{start:{line:31,column:70},end:{line:31,column:73}},{start:{line:31,column:76},end:{line:31,column:92}}],line:31},"1":{loc:{start:{line:31,column:46},end:{line:31,column:67}},type:"binary-expr",locations:[{start:{line:31,column:46},end:{line:31,column:49}},{start:{line:31,column:53},end:{line:31,column:67}}],line:31},"2":{loc:{start:{line:52,column:2},end:{line:62,column:3}},type:"if",locations:[{start:{line:52,column:2},end:{line:62,column:3}},{start:{line:52,column:2},end:{line:62,column:3}}],line:52},"3":{loc:{start:{line:56,column:6},end:{line:58,column:7}},type:"if",locations:[{start:{line:56,column:6},end:{line:58,column:7}},{start:{line:56,column:6},end:{line:58,column:7}}],line:56},"4":{loc:{start:{line:78,column:2},end:{line:86,column:3}},type:"if",locations:[{start:{line:78,column:2},end:{line:86,column:3}},{start:{line:78,column:2},end:{line:86,column:3}}],line:78},"5":{loc:{start:{line:81,column:4},end:{line:85,column:5}},type:"if",locations:[{start:{line:81,column:4},end:{line:85,column:5}},{start:{line:81,column:4},end:{line:85,column:5}}],line:81},"6":{loc:{start:{line:83,column:23},end:{line:83,column:60}},type:"binary-expr",locations:[{start:{line:83,column:23},end:{line:83,column:42}},{start:{line:83,column:46},end:{line:83,column:60}}],line:83},"7":{loc:{start:{line:84,column:27},end:{line:84,column:72}},type:"binary-expr",locations:[{start:{line:84,column:27},end:{line:84,column:50}},{start:{line:84,column:54},end:{line:84,column:72}}],line:84},"8":{loc:{start:{line:88,column:2},end:{line:92,column:3}},type:"if",locations:[{start:{line:88,column:2},end:{line:92,column:3}},{start:{line:88,column:2},end:{line:92,column:3}}],line:88},"9":{loc:{start:{line:96,column:2},end:{line:169,column:3}},type:"if",locations:[{start:{line:96,column:2},end:{line:169,column:3}},{start:{line:96,column:2},end:{line:169,column:3}}],line:96},"10":{loc:{start:{line:96,column:6},end:{line:96,column:52}},type:"binary-expr",locations:[{start:{line:96,column:6},end:{line:96,column:17}},{start:{line:96,column:21},end:{line:96,column:52}}],line:96},"11":{loc:{start:{line:98,column:4},end:{line:111,column:5}},type:"if",locations:[{start:{line:98,column:4},end:{line:111,column:5}},{start:{line:98,column:4},end:{line:111,column:5}}],line:98},"12":{loc:{start:{line:113,column:4},end:{line:115,column:5}},type:"if",locations:[{start:{line:113,column:4},end:{line:115,column:5}},{start:{line:113,column:4},end:{line:115,column:5}}],line:113},"13":{loc:{start:{line:117,column:4},end:{line:168,column:5}},type:"if",locations:[{start:{line:117,column:4},end:{line:168,column:5}},{start:{line:117,column:4},end:{line:168,column:5}}],line:117},"14":{loc:{start:{line:117,column:8},end:{line:117,column:187}},type:"binary-expr",locations:[{start:{line:117,column:8},end:{line:117,column:16}},{start:{line:117,column:20},end:{line:117,column:43}},{start:{line:117,column:47},end:{line:117,column:90}},{start:{line:117,column:95},end:{line:117,column:110}},{start:{line:117,column:114},end:{line:117,column:186}}],line:117},"15":{loc:{start:{line:119,column:27},end:{line:119,column:56}},type:"binary-expr",locations:[{start:{line:119,column:27},end:{line:119,column:50}},{start:{line:119,column:54},end:{line:119,column:56}}],line:119},"16":{loc:{start:{line:124,column:6},end:{line:127,column:7}},type:"if",locations:[{start:{line:124,column:6},end:{line:127,column:7}},{start:{line:124,column:6},end:{line:127,column:7}}],line:124},"17":{loc:{start:{line:129,column:6},end:{line:132,column:7}},type:"if",locations:[{start:{line:129,column:6},end:{line:132,column:7}},{start:{line:129,column:6},end:{line:132,column:7}}],line:129},"18":{loc:{start:{line:134,column:6},end:{line:137,column:7}},type:"if",locations:[{start:{line:134,column:6},end:{line:137,column:7}},{start:{line:134,column:6},end:{line:137,column:7}}],line:134},"19":{loc:{start:{line:139,column:6},end:{line:142,column:7}},type:"if",locations:[{start:{line:139,column:6},end:{line:142,column:7}},{start:{line:139,column:6},end:{line:142,column:7}}],line:139},"20":{loc:{start:{line:144,column:6},end:{line:160,column:7}},type:"if",locations:[{start:{line:144,column:6},end:{line:160,column:7}},{start:{line:144,column:6},end:{line:160,column:7}}],line:144},"21":{loc:{start:{line:145,column:8},end:{line:157,column:9}},type:"if",locations:[{start:{line:145,column:8},end:{line:157,column:9}},{start:{line:145,column:8},end:{line:157,column:9}}],line:145},"22":{loc:{start:{line:151,column:12},end:{line:153,column:13}},type:"if",locations:[{start:{line:151,column:12},end:{line:153,column:13}},{start:{line:151,column:12},end:{line:153,column:13}}],line:151},"23":{loc:{start:{line:162,column:6},end:{line:165,column:7}},type:"if",locations:[{start:{line:162,column:6},end:{line:165,column:7}},{start:{line:162,column:6},end:{line:165,column:7}}],line:162},"24":{loc:{start:{line:171,column:2},end:{line:173,column:3}},type:"if",locations:[{start:{line:171,column:2},end:{line:173,column:3}},{start:{line:171,column:2},end:{line:173,column:3}}],line:171},"25":{loc:{start:{line:171,column:6},end:{line:171,column:64}},type:"binary-expr",locations:[{start:{line:171,column:6},end:{line:171,column:23}},{start:{line:171,column:27},end:{line:171,column:64}}],line:171},"26":{loc:{start:{line:175,column:2},end:{line:177,column:3}},type:"if",locations:[{start:{line:175,column:2},end:{line:177,column:3}},{start:{line:175,column:2},end:{line:177,column:3}}],line:175},"27":{loc:{start:{line:179,column:2},end:{line:184,column:3}},type:"if",locations:[{start:{line:179,column:2},end:{line:184,column:3}},{start:{line:179,column:2},end:{line:184,column:3}}],line:179},"28":{loc:{start:{line:189,column:23},end:{line:189,column:40}},type:"binary-expr",locations:[{start:{line:189,column:23},end:{line:189,column:34}},{start:{line:189,column:38},end:{line:189,column:40}}],line:189},"29":{loc:{start:{line:193,column:2},end:{line:195,column:3}},type:"if",locations:[{start:{line:193,column:2},end:{line:195,column:3}},{start:{line:193,column:2},end:{line:195,column:3}}],line:193},"30":{loc:{start:{line:193,column:6},end:{line:193,column:139}},type:"binary-expr",locations:[{start:{line:193,column:6},end:{line:193,column:20}},{start:{line:193,column:24},end:{line:193,column:47}},{start:{line:193,column:51},end:{line:193,column:87}},{start:{line:193,column:91},end:{line:193,column:139}}],line:193},"31":{loc:{start:{line:199,column:2},end:{line:207,column:3}},type:"if",locations:[{start:{line:199,column:2},end:{line:207,column:3}},{start:{line:199,column:2},end:{line:207,column:3}}],line:199},"32":{loc:{start:{line:211,column:2},end:{line:220,column:3}},type:"if",locations:[{start:{line:211,column:2},end:{line:220,column:3}},{start:{line:211,column:2},end:{line:220,column:3}}],line:211},"33":{loc:{start:{line:211,column:6},end:{line:211,column:108}},type:"binary-expr",locations:[{start:{line:211,column:6},end:{line:211,column:56}},{start:{line:211,column:60},end:{line:211,column:88}},{start:{line:211,column:92},end:{line:211,column:108}}],line:211},"34":{loc:{start:{line:229,column:11},end:{line:229,column:73}},type:"binary-expr",locations:[{start:{line:229,column:11},end:{line:229,column:40}},{start:{line:229,column:44},end:{line:229,column:73}}],line:229},"35":{loc:{start:{line:232,column:2},end:{line:234,column:3}},type:"if",locations:[{start:{line:232,column:2},end:{line:234,column:3}},{start:{line:232,column:2},end:{line:234,column:3}}],line:232},"36":{loc:{start:{line:232,column:6},end:{line:232,column:40}},type:"binary-expr",locations:[{start:{line:232,column:6},end:{line:232,column:22}},{start:{line:232,column:26},end:{line:232,column:40}}],line:232},"37":{loc:{start:{line:236,column:2},end:{line:238,column:3}},type:"if",locations:[{start:{line:236,column:2},end:{line:238,column:3}},{start:{line:236,column:2},end:{line:238,column:3}}],line:236},"38":{loc:{start:{line:240,column:2},end:{line:249,column:3}},type:"if",locations:[{start:{line:240,column:2},end:{line:249,column:3}},{start:{line:240,column:2},end:{line:249,column:3}}],line:240},"39":{loc:{start:{line:251,column:2},end:{line:259,column:3}},type:"if",locations:[{start:{line:251,column:2},end:{line:259,column:3}},{start:{line:251,column:2},end:{line:259,column:3}}],line:251},"40":{loc:{start:{line:263,column:4},end:{line:275,column:5}},type:"if",locations:[{start:{line:263,column:4},end:{line:275,column:5}},{start:{line:263,column:4},end:{line:275,column:5}}],line:263},"41":{loc:{start:{line:263,column:8},end:{line:263,column:109}},type:"binary-expr",locations:[{start:{line:263,column:8},end:{line:263,column:25}},{start:{line:263,column:29},end:{line:263,column:69}},{start:{line:263,column:73},end:{line:263,column:109}}],line:263},"42":{loc:{start:{line:277,column:4},end:{line:280,column:5}},type:"if",locations:[{start:{line:277,column:4},end:{line:280,column:5}},{start:{line:277,column:4},end:{line:280,column:5}}],line:277},"43":{loc:{start:{line:282,column:4},end:{line:289,column:5}},type:"if",locations:[{start:{line:282,column:4},end:{line:289,column:5}},{start:{line:282,column:4},end:{line:289,column:5}}],line:282},"44":{loc:{start:{line:294,column:2},end:{line:309,column:3}},type:"if",locations:[{start:{line:294,column:2},end:{line:309,column:3}},{start:{line:294,column:2},end:{line:309,column:3}}],line:294},"45":{loc:{start:{line:297,column:9},end:{line:309,column:3}},type:"if",locations:[{start:{line:297,column:9},end:{line:309,column:3}},{start:{line:297,column:9},end:{line:309,column:3}}],line:297},"46":{loc:{start:{line:297,column:13},end:{line:297,column:59}},type:"binary-expr",locations:[{start:{line:297,column:13},end:{line:297,column:27}},{start:{line:297,column:31},end:{line:297,column:59}}],line:297},"47":{loc:{start:{line:300,column:9},end:{line:309,column:3}},type:"if",locations:[{start:{line:300,column:9},end:{line:309,column:3}},{start:{line:300,column:9},end:{line:309,column:3}}],line:300},"48":{loc:{start:{line:303,column:9},end:{line:309,column:3}},type:"if",locations:[{start:{line:303,column:9},end:{line:309,column:3}},{start:{line:303,column:9},end:{line:309,column:3}}],line:303},"49":{loc:{start:{line:303,column:13},end:{line:303,column:52}},type:"binary-expr",locations:[{start:{line:303,column:13},end:{line:303,column:27}},{start:{line:303,column:31},end:{line:303,column:52}}],line:303},"50":{loc:{start:{line:313,column:2},end:{line:313,column:54}},type:"if",locations:[{start:{line:313,column:2},end:{line:313,column:54}},{start:{line:313,column:2},end:{line:313,column:54}}],line:313},"51":{loc:{start:{line:313,column:8},end:{line:313,column:22}},type:"binary-expr",locations:[{start:{line:313,column:8},end:{line:313,column:15}},{start:{line:313,column:19},end:{line:313,column:22}}],line:313},"52":{loc:{start:{line:314,column:16},end:{line:314,column:30}},type:"binary-expr",locations:[{start:{line:314,column:16},end:{line:314,column:23}},{start:{line:314,column:27},end:{line:314,column:30}}],line:314},"53":{loc:{start:{line:320,column:2},end:{line:336,column:3}},type:"if",locations:[{start:{line:320,column:2},end:{line:336,column:3}},{start:{line:320,column:2},end:{line:336,column:3}}],line:320},"54":{loc:{start:{line:324,column:4},end:{line:335,column:5}},type:"if",locations:[{start:{line:324,column:4},end:{line:335,column:5}},{start:{line:324,column:4},end:{line:335,column:5}}],line:324},"55":{loc:{start:{line:330,column:6},end:{line:334,column:7}},type:"if",locations:[{start:{line:330,column:6},end:{line:334,column:7}},{start:{line:330,column:6},end:{line:334,column:7}}],line:330},"56":{loc:{start:{line:355,column:4},end:{line:357,column:5}},type:"if",locations:[{start:{line:355,column:4},end:{line:357,column:5}},{start:{line:355,column:4},end:{line:357,column:5}}],line:355},"57":{loc:{start:{line:355,column:8},end:{line:355,column:37}},type:"binary-expr",locations:[{start:{line:355,column:8},end:{line:355,column:14}},{start:{line:355,column:18},end:{line:355,column:37}}],line:355},"58":{loc:{start:{line:359,column:24},end:{line:359,column:59}},type:"binary-expr",locations:[{start:{line:359,column:24},end:{line:359,column:30}},{start:{line:359,column:34},end:{line:359,column:52}},{start:{line:359,column:56},end:{line:359,column:59}}],line:359},"59":{loc:{start:{line:365,column:4},end:{line:369,column:5}},type:"if",locations:[{start:{line:365,column:4},end:{line:369,column:5}},{start:{line:365,column:4},end:{line:369,column:5}}],line:365},"60":{loc:{start:{line:374,column:2},end:{line:378,column:3}},type:"if",locations:[{start:{line:374,column:2},end:{line:378,column:3}},{start:{line:374,column:2},end:{line:378,column:3}}],line:374},"61":{loc:{start:{line:374,column:6},end:{line:374,column:47}},type:"binary-expr",locations:[{start:{line:374,column:6},end:{line:374,column:27}},{start:{line:374,column:31},end:{line:374,column:47}}],line:374},"62":{loc:{start:{line:384,column:14},end:{line:384,column:74}},type:"binary-expr",locations:[{start:{line:384,column:14},end:{line:384,column:24}},{start:{line:384,column:28},end:{line:384,column:55}},{start:{line:384,column:59},end:{line:384,column:74}}],line:384},"63":{loc:{start:{line:386,column:2},end:{line:432,column:3}},type:"if",locations:[{start:{line:386,column:2},end:{line:432,column:3}},{start:{line:386,column:2},end:{line:432,column:3}}],line:386},"64":{loc:{start:{line:387,column:4},end:{line:389,column:5}},type:"if",locations:[{start:{line:387,column:4},end:{line:389,column:5}},{start:{line:387,column:4},end:{line:389,column:5}}],line:387},"65":{loc:{start:{line:387,column:8},end:{line:387,column:58}},type:"binary-expr",locations:[{start:{line:387,column:8},end:{line:387,column:18}},{start:{line:387,column:22},end:{line:387,column:58}}],line:387},"66":{loc:{start:{line:393,column:4},end:{line:404,column:5}},type:"switch",locations:[{start:{line:394,column:6},end:{line:396,column:14}},{start:{line:398,column:6},end:{line:400,column:14}},{start:{line:402,column:6},end:{line:403,column:25}}],line:393},"67":{loc:{start:{line:412,column:9},end:{line:432,column:3}},type:"if",locations:[{start:{line:412,column:9},end:{line:432,column:3}},{start:{line:412,column:9},end:{line:432,column:3}}],line:412},"68":{loc:{start:{line:412,column:13},end:{line:412,column:38}},type:"binary-expr",locations:[{start:{line:412,column:13},end:{line:412,column:23}},{start:{line:412,column:27},end:{line:412,column:38}}],line:412},"69":{loc:{start:{line:418,column:4},end:{line:420,column:5}},type:"if",locations:[{start:{line:418,column:4},end:{line:420,column:5}},{start:{line:418,column:4},end:{line:420,column:5}}],line:418},"70":{loc:{start:{line:418,column:10},end:{line:418,column:40}},type:"binary-expr",locations:[{start:{line:418,column:10},end:{line:418,column:17}},{start:{line:418,column:21},end:{line:418,column:40}}],line:418},"71":{loc:{start:{line:429,column:4},end:{line:431,column:5}},type:"if",locations:[{start:{line:429,column:4},end:{line:431,column:5}},{start:{line:429,column:4},end:{line:431,column:5}}],line:429},"72":{loc:{start:{line:429,column:10},end:{line:429,column:40}},type:"binary-expr",locations:[{start:{line:429,column:10},end:{line:429,column:17}},{start:{line:429,column:21},end:{line:429,column:40}}],line:429},"73":{loc:{start:{line:436,column:2},end:{line:440,column:3}},type:"if",locations:[{start:{line:436,column:2},end:{line:440,column:3}},{start:{line:436,column:2},end:{line:440,column:3}}],line:436},"74":{loc:{start:{line:446,column:2},end:{line:451,column:3}},type:"if",locations:[{start:{line:446,column:2},end:{line:451,column:3}},{start:{line:446,column:2},end:{line:451,column:3}}],line:446},"75":{loc:{start:{line:465,column:2},end:{line:467,column:3}},type:"if",locations:[{start:{line:465,column:2},end:{line:467,column:3}},{start:{line:465,column:2},end:{line:467,column:3}}],line:465},"76":{loc:{start:{line:471,column:21},end:{line:471,column:46}},type:"binary-expr",locations:[{start:{line:471,column:21},end:{line:471,column:40}},{start:{line:471,column:44},end:{line:471,column:46}}],line:471},"77":{loc:{start:{line:471,column:22},end:{line:471,column:31}},type:"binary-expr",locations:[{start:{line:471,column:22},end:{line:471,column:25}},{start:{line:471,column:29},end:{line:471,column:31}}],line:471},"78":{loc:{start:{line:477,column:2},end:{line:479,column:3}},type:"if",locations:[{start:{line:477,column:2},end:{line:479,column:3}},{start:{line:477,column:2},end:{line:479,column:3}}],line:477},"79":{loc:{start:{line:477,column:6},end:{line:477,column:46}},type:"binary-expr",locations:[{start:{line:477,column:6},end:{line:477,column:16}},{start:{line:477,column:20},end:{line:477,column:46}}],line:477},"80":{loc:{start:{line:489,column:29},end:{line:489,column:71}},type:"cond-expr",locations:[{start:{line:489,column:54},end:{line:489,column:58}},{start:{line:489,column:61},end:{line:489,column:71}}],line:489},"81":{loc:{start:{line:491,column:4},end:{line:494,column:5}},type:"if",locations:[{start:{line:491,column:4},end:{line:494,column:5}},{start:{line:491,column:4},end:{line:494,column:5}}],line:491},"82":{loc:{start:{line:497,column:2},end:{line:499,column:3}},type:"if",locations:[{start:{line:497,column:2},end:{line:499,column:3}},{start:{line:497,column:2},end:{line:499,column:3}}],line:497},"83":{loc:{start:{line:507,column:4},end:{line:509,column:5}},type:"if",locations:[{start:{line:507,column:4},end:{line:509,column:5}},{start:{line:507,column:4},end:{line:509,column:5}}],line:507}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":0,"114":0,"115":0,"116":0,"117":0,"118":0,"119":0,"120":0,"121":0,"122":0,"123":0,"124":0,"125":0,"126":0,"127":0,"128":0,"129":0,"130":0,"131":0,"132":0,"133":0,"134":0,"135":0,"136":0,"137":0,"138":0,"139":0,"140":0,"141":0,"142":0,"143":0,"144":0,"145":0,"146":0,"147":0,"148":0,"149":0,"150":0,"151":0,"152":0,"153":0,"154":0,"155":0,"156":0,"157":0,"158":0,"159":0,"160":0,"161":0,"162":0,"163":0,"164":0,"165":0,"166":0,"167":0,"168":0,"169":0,"170":0,"171":0,"172":0,"173":0,"174":0,"175":0,"176":0,"177":0,"178":0,"179":0,"180":0,"181":0,"182":0,"183":0,"184":0,"185":0,"186":0,"187":0,"188":0,"189":0,"190":0,"191":0,"192":0,"193":0,"194":0,"195":0,"196":0,"197":0,"198":0,"199":0,"200":0,"201":0,"202":0,"203":0,"204":0,"205":0,"206":0,"207":0,"208":0,"209":0,"210":0,"211":0,"212":0,"213":0,"214":0,"215":0,"216":0,"217":0,"218":0,"219":0,"220":0,"221":0,"222":0,"223":0,"224":0,"225":0,"226":0,"227":0,"228":0,"229":0,"230":0,"231":0,"232":0,"233":0,"234":0,"235":0,"236":0,"237":0,"238":0,"239":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0,0,0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0],"29":[0,0],"30":[0,0,0,0],"31":[0,0],"32":[0,0],"33":[0,0,0],"34":[0,0],"35":[0,0],"36":[0,0],"37":[0,0],"38":[0,0],"39":[0,0],"40":[0,0],"41":[0,0,0],"42":[0,0],"43":[0,0],"44":[0,0],"45":[0,0],"46":[0,0],"47":[0,0],"48":[0,0],"49":[0,0],"50":[0,0],"51":[0,0],"52":[0,0],"53":[0,0],"54":[0,0],"55":[0,0],"56":[0,0],"57":[0,0],"58":[0,0,0],"59":[0,0],"60":[0,0],"61":[0,0],"62":[0,0,0],"63":[0,0],"64":[0,0],"65":[0,0],"66":[0,0,0],"67":[0,0],"68":[0,0],"69":[0,0],"70":[0,0],"71":[0,0],"72":[0,0],"73":[0,0],"74":[0,0],"75":[0,0],"76":[0,0],"77":[0,0],"78":[0,0],"79":[0,0],"80":[0,0],"81":[0,0],"82":[0,0],"83":[0,0]},inputSourceMap:{version:3,sources:["../src/middlewares.js"],names:["DEFAULT_ALLOWED_HEADERS","getMountForRequest","req","mountPathLength","originalUrl","length","url","mountPath","slice","protocol","get","handleParseHeaders","res","next","mount","context","JSON","parse","Object","prototype","toString","call","e","malformedContext","info","appId","sessionToken","masterKey","installationId","clientKey","javascriptKey","dotNetKey","restAPIKey","clientVersion","basicAuth","httpAuth","basicAuthAppId","AppCache","body","_noBody","fileViaJSON","Buffer","invalidRequest","_RevocableSession","_ApplicationId","_JavaScriptKey","_ClientVersion","_InstallationId","_SessionToken","_MasterKey","_context","_ContentType","headers","clientSDK","ClientSDK","fromString","fileData","base64","from","clientIp","getClientIp","app","config","Config","ip","masterKeyIps","indexOf","isMaster","auth","Auth","isReadOnlyMaster","readOnlyMasterKey","isReadOnly","keys","oneKeyConfigured","some","key","undefined","oneKeyMatches","userFromJWT","user","Promise","resolve","then","getAuthForLegacySessionToken","getAuthForSessionToken","catch","error","Parse","Error","loggerController","UNKNOWN_ERROR","split","connection","remoteAddress","socket","authorization","header","authPrefix","match","toLowerCase","encodedAuth","substring","credentials","decodeBase64","jsKeyPrefix","matchKey","str","allowCrossDomain","allowHeaders","join","allowOrigin","method","sendStatus","allowMethodOverride","_method","originalMethod","handleParseErrors","err","log","defaultLogger","enableExpressErrorHandler","httpStatus","code","INTERNAL_SERVER_ERROR","OBJECT_NOT_FOUND","status","json","message","process","env","TESTING","stack","enforceMasterKeyAccess","end","promiseEnforceMasterKeyAccess","request","promiseEnsureIdempotency","database","adapter","MongoStorageAdapter","requestId","paths","ttl","idempotencyOptions","reqPath","path","replace","regex","RegExp","charAt","expiryDate","Date","setSeconds","getSeconds","rest","create","master","reqId","expire","_encode","DUPLICATE_VALUE","DUPLICATE_REQUEST","INVALID_JSON"],mappings:"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",sourcesContent:["import AppCache from './cache';\nimport Parse from 'parse/node';\nimport auth from './Auth';\nimport Config from './Config';\nimport ClientSDK from './ClientSDK';\nimport defaultLogger from './logger';\nimport rest from './rest';\nimport MongoStorageAdapter from './Adapters/Storage/Mongo/MongoStorageAdapter';\n\nexport const DEFAULT_ALLOWED_HEADERS =\n  'X-Parse-Master-Key, X-Parse-REST-API-Key, X-Parse-Javascript-Key, X-Parse-Application-Id, X-Parse-Client-Version, X-Parse-Session-Token, X-Requested-With, X-Parse-Revocable-Session, X-Parse-Request-Id, Content-Type, Pragma, Cache-Control';\n\nconst getMountForRequest = function (req) {\n  const mountPathLength = req.originalUrl.length - req.url.length;\n  const mountPath = req.originalUrl.slice(0, mountPathLength);\n  return req.protocol + '://' + req.get('host') + mountPath;\n};\n\n// Checks that the request is authorized for this app and checks user\n// auth too.\n// The bodyparser should run before this middleware.\n// Adds info to the request:\n// req.config - the Config for this app\n// req.auth - the Auth for this request\nexport function handleParseHeaders(req, res, next) {\n  var mount = getMountForRequest(req);\n\n  let context = {};\n  if (req.get('X-Parse-Cloud-Context') != null) {\n    try {\n      context = JSON.parse(req.get('X-Parse-Cloud-Context'));\n      if (Object.prototype.toString.call(context) !== '[object Object]') {\n        throw 'Context is not an object';\n      }\n    } catch (e) {\n      return malformedContext(req, res);\n    }\n  }\n  var info = {\n    appId: req.get('X-Parse-Application-Id'),\n    sessionToken: req.get('X-Parse-Session-Token'),\n    masterKey: req.get('X-Parse-Master-Key'),\n    installationId: req.get('X-Parse-Installation-Id'),\n    clientKey: req.get('X-Parse-Client-Key'),\n    javascriptKey: req.get('X-Parse-Javascript-Key'),\n    dotNetKey: req.get('X-Parse-Windows-Key'),\n    restAPIKey: req.get('X-Parse-REST-API-Key'),\n    clientVersion: req.get('X-Parse-Client-Version'),\n    context: context,\n  };\n\n  var basicAuth = httpAuth(req);\n\n  if (basicAuth) {\n    var basicAuthAppId = basicAuth.appId;\n    if (AppCache.get(basicAuthAppId)) {\n      info.appId = basicAuthAppId;\n      info.masterKey = basicAuth.masterKey || info.masterKey;\n      info.javascriptKey = basicAuth.javascriptKey || info.javascriptKey;\n    }\n  }\n\n  if (req.body) {\n    // Unity SDK sends a _noBody key which needs to be removed.\n    // Unclear at this point if action needs to be taken.\n    delete req.body._noBody;\n  }\n\n  var fileViaJSON = false;\n\n  if (!info.appId || !AppCache.get(info.appId)) {\n    // See if we can find the app id on the body.\n    if (req.body instanceof Buffer) {\n      // The only chance to find the app id is if this is a file\n      // upload that actually is a JSON body. So try to parse it.\n      // https://github.com/parse-community/parse-server/issues/6589\n      // It is also possible that the client is trying to upload a file but forgot\n      // to provide x-parse-app-id in header and parse a binary file will fail\n      try {\n        req.body = JSON.parse(req.body);\n      } catch (e) {\n        return invalidRequest(req, res);\n      }\n      fileViaJSON = true;\n    }\n\n    if (req.body) {\n      delete req.body._RevocableSession;\n    }\n\n    if (\n      req.body &&\n      req.body._ApplicationId &&\n      AppCache.get(req.body._ApplicationId) &&\n      (!info.masterKey || AppCache.get(req.body._ApplicationId).masterKey === info.masterKey)\n    ) {\n      info.appId = req.body._ApplicationId;\n      info.javascriptKey = req.body._JavaScriptKey || '';\n      delete req.body._ApplicationId;\n      delete req.body._JavaScriptKey;\n      // TODO: test that the REST API formats generated by the other\n      // SDKs are handled ok\n      if (req.body._ClientVersion) {\n        info.clientVersion = req.body._ClientVersion;\n        delete req.body._ClientVersion;\n      }\n      if (req.body._InstallationId) {\n        info.installationId = req.body._InstallationId;\n        delete req.body._InstallationId;\n      }\n      if (req.body._SessionToken) {\n        info.sessionToken = req.body._SessionToken;\n        delete req.body._SessionToken;\n      }\n      if (req.body._MasterKey) {\n        info.masterKey = req.body._MasterKey;\n        delete req.body._MasterKey;\n      }\n      if (req.body._context) {\n        if (req.body._context instanceof Object) {\n          info.context = req.body._context;\n        } else {\n          try {\n            info.context = JSON.parse(req.body._context);\n            if (Object.prototype.toString.call(info.context) !== '[object Object]') {\n              throw 'Context is not an object';\n            }\n          } catch (e) {\n            return malformedContext(req, res);\n          }\n        }\n        delete req.body._context;\n      }\n      if (req.body._ContentType) {\n        req.headers['content-type'] = req.body._ContentType;\n        delete req.body._ContentType;\n      }\n    } else {\n      return invalidRequest(req, res);\n    }\n  }\n\n  if (info.sessionToken && typeof info.sessionToken !== 'string') {\n    info.sessionToken = info.sessionToken.toString();\n  }\n\n  if (info.clientVersion) {\n    info.clientSDK = ClientSDK.fromString(info.clientVersion);\n  }\n\n  if (fileViaJSON) {\n    req.fileData = req.body.fileData;\n    // We need to repopulate req.body with a buffer\n    var base64 = req.body.base64;\n    req.body = Buffer.from(base64, 'base64');\n  }\n\n  const clientIp = getClientIp(req);\n\n  info.app = AppCache.get(info.appId);\n  req.config = Config.get(info.appId, mount);\n  req.config.headers = req.headers || {};\n  req.config.ip = clientIp;\n  req.info = info;\n\n  if (\n    info.masterKey &&\n    req.config.masterKeyIps &&\n    req.config.masterKeyIps.length !== 0 &&\n    req.config.masterKeyIps.indexOf(clientIp) === -1\n  ) {\n    return invalidRequest(req, res);\n  }\n\n  var isMaster = info.masterKey === req.config.masterKey;\n\n  if (isMaster) {\n    req.auth = new auth.Auth({\n      config: req.config,\n      installationId: info.installationId,\n      isMaster: true,\n    });\n    next();\n    return;\n  }\n\n  var isReadOnlyMaster = info.masterKey === req.config.readOnlyMasterKey;\n  if (\n    typeof req.config.readOnlyMasterKey != 'undefined' &&\n    req.config.readOnlyMasterKey &&\n    isReadOnlyMaster\n  ) {\n    req.auth = new auth.Auth({\n      config: req.config,\n      installationId: info.installationId,\n      isMaster: true,\n      isReadOnly: true,\n    });\n    next();\n    return;\n  }\n\n  // Client keys are not required in parse-server, but if any have been configured in the server, validate them\n  //  to preserve original behavior.\n  const keys = ['clientKey', 'javascriptKey', 'dotNetKey', 'restAPIKey'];\n  const oneKeyConfigured = keys.some(function (key) {\n    return req.config[key] !== undefined;\n  });\n  const oneKeyMatches = keys.some(function (key) {\n    return req.config[key] !== undefined && info[key] === req.config[key];\n  });\n\n  if (oneKeyConfigured && !oneKeyMatches) {\n    return invalidRequest(req, res);\n  }\n\n  if (req.url == '/login') {\n    delete info.sessionToken;\n  }\n\n  if (req.userFromJWT) {\n    req.auth = new auth.Auth({\n      config: req.config,\n      installationId: info.installationId,\n      isMaster: false,\n      user: req.userFromJWT,\n    });\n    next();\n    return;\n  }\n\n  if (!info.sessionToken) {\n    req.auth = new auth.Auth({\n      config: req.config,\n      installationId: info.installationId,\n      isMaster: false,\n    });\n    next();\n    return;\n  }\n\n  return Promise.resolve()\n    .then(() => {\n      // handle the upgradeToRevocableSession path on it's own\n      if (\n        info.sessionToken &&\n        req.url === '/upgradeToRevocableSession' &&\n        info.sessionToken.indexOf('r:') != 0\n      ) {\n        return auth.getAuthForLegacySessionToken({\n          config: req.config,\n          installationId: info.installationId,\n          sessionToken: info.sessionToken,\n        });\n      } else {\n        return auth.getAuthForSessionToken({\n          config: req.config,\n          installationId: info.installationId,\n          sessionToken: info.sessionToken,\n        });\n      }\n    })\n    .then(auth => {\n      if (auth) {\n        req.auth = auth;\n        next();\n      }\n    })\n    .catch(error => {\n      if (error instanceof Parse.Error) {\n        next(error);\n        return;\n      } else {\n        // TODO: Determine the correct error scenario.\n        req.config.loggerController.error('error getting auth for sessionToken', error);\n        throw new Parse.Error(Parse.Error.UNKNOWN_ERROR, error);\n      }\n    });\n}\n\nfunction getClientIp(req) {\n  if (req.headers['x-forwarded-for']) {\n    // try to get from x-forwared-for if it set (behind reverse proxy)\n    return req.headers['x-forwarded-for'].split(',')[0];\n  } else if (req.connection && req.connection.remoteAddress) {\n    // no proxy, try getting from connection.remoteAddress\n    return req.connection.remoteAddress;\n  } else if (req.socket) {\n    // try to get it from req.socket\n    return req.socket.remoteAddress;\n  } else if (req.connection && req.connection.socket) {\n    // try to get it form the connection.socket\n    return req.connection.socket.remoteAddress;\n  } else {\n    // if non above, fallback.\n    return req.ip;\n  }\n}\n\nfunction httpAuth(req) {\n  if (!(req.req || req).headers.authorization) return;\n\n  var header = (req.req || req).headers.authorization;\n  var appId, masterKey, javascriptKey;\n\n  // parse header\n  var authPrefix = 'basic ';\n\n  var match = header.toLowerCase().indexOf(authPrefix);\n\n  if (match == 0) {\n    var encodedAuth = header.substring(authPrefix.length, header.length);\n    var credentials = decodeBase64(encodedAuth).split(':');\n\n    if (credentials.length == 2) {\n      appId = credentials[0];\n      var key = credentials[1];\n\n      var jsKeyPrefix = 'javascript-key=';\n\n      var matchKey = key.indexOf(jsKeyPrefix);\n      if (matchKey == 0) {\n        javascriptKey = key.substring(jsKeyPrefix.length, key.length);\n      } else {\n        masterKey = key;\n      }\n    }\n  }\n\n  return { appId: appId, masterKey: masterKey, javascriptKey: javascriptKey };\n}\n\nfunction decodeBase64(str) {\n  return Buffer.from(str, 'base64').toString();\n}\n\nexport function allowCrossDomain(appId) {\n  return (req, res, next) => {\n    const config = Config.get(appId, getMountForRequest(req));\n    let allowHeaders = DEFAULT_ALLOWED_HEADERS;\n    if (config && config.allowHeaders) {\n      allowHeaders += `, ${config.allowHeaders.join(', ')}`;\n    }\n    const allowOrigin = (config && config.allowOrigin) || '*';\n    res.header('Access-Control-Allow-Origin', allowOrigin);\n    res.header('Access-Control-Allow-Methods', 'GET,PUT,POST,DELETE,OPTIONS');\n    res.header('Access-Control-Allow-Headers', allowHeaders);\n    res.header('Access-Control-Expose-Headers', 'X-Parse-Job-Status-Id, X-Parse-Push-Status-Id');\n    // intercept OPTIONS method\n    if ('OPTIONS' == req.method) {\n      res.sendStatus(200);\n    } else {\n      next();\n    }\n  };\n}\n\nexport function allowMethodOverride(req, res, next) {\n  if (req.method === 'POST' && req.body._method) {\n    req.originalMethod = req.method;\n    req.method = req.body._method;\n    delete req.body._method;\n  }\n  next();\n}\n\nexport function handleParseErrors(err, req, res, next) {\n  const log = (req.config && req.config.loggerController) || defaultLogger;\n  if (err instanceof Parse.Error) {\n    if (req.config && req.config.enableExpressErrorHandler) {\n      return next(err);\n    }\n    let httpStatus;\n    // TODO: fill out this mapping\n    switch (err.code) {\n      case Parse.Error.INTERNAL_SERVER_ERROR:\n        httpStatus = 500;\n        break;\n      case Parse.Error.OBJECT_NOT_FOUND:\n        httpStatus = 404;\n        break;\n      default:\n        httpStatus = 400;\n    }\n    res.status(httpStatus);\n    res.json({ code: err.code, error: err.message });\n    log.error('Parse error: ', err);\n  } else if (err.status && err.message) {\n    res.status(err.status);\n    res.json({ error: err.message });\n    if (!(process && process.env.TESTING)) {\n      next(err);\n    }\n  } else {\n    log.error('Uncaught internal server error.', err, err.stack);\n    res.status(500);\n    res.json({\n      code: Parse.Error.INTERNAL_SERVER_ERROR,\n      message: 'Internal server error.',\n    });\n    if (!(process && process.env.TESTING)) {\n      next(err);\n    }\n  }\n}\n\nexport function enforceMasterKeyAccess(req, res, next) {\n  if (!req.auth.isMaster) {\n    res.status(403);\n    res.end('{\"error\":\"unauthorized: master key is required\"}');\n    return;\n  }\n  next();\n}\n\nexport function promiseEnforceMasterKeyAccess(request) {\n  if (!request.auth.isMaster) {\n    const error = new Error();\n    error.status = 403;\n    error.message = 'unauthorized: master key is required';\n    throw error;\n  }\n  return Promise.resolve();\n}\n\n/**\n * Deduplicates a request to ensure idempotency. Duplicates are determined by the request ID\n * in the request header. If a request has no request ID, it is executed anyway.\n * @param {*} req The request to evaluate.\n * @returns Promise<{}>\n */\nexport function promiseEnsureIdempotency(req) {\n  // Enable feature only for MongoDB\n  if (!(req.config.database.adapter instanceof MongoStorageAdapter)) {\n    return Promise.resolve();\n  }\n  // Get parameters\n  const config = req.config;\n  const requestId = ((req || {}).headers || {})['x-parse-request-id'];\n  const { paths, ttl } = config.idempotencyOptions;\n  if (!requestId || !config.idempotencyOptions) {\n    return Promise.resolve();\n  }\n  // Request path may contain trailing slashes, depending on the original request, so remove\n  // leading and trailing slashes to make it easier to specify paths in the configuration\n  const reqPath = req.path.replace(/^\\/|\\/$/, '');\n  // Determine whether idempotency is enabled for current request path\n  let match = false;\n  for (const path of paths) {\n    // Assume one wants a path to always match from the beginning to prevent any mistakes\n    const regex = new RegExp(path.charAt(0) === '^' ? path : '^' + path);\n    if (reqPath.match(regex)) {\n      match = true;\n      break;\n    }\n  }\n  if (!match) {\n    return Promise.resolve();\n  }\n  // Try to store request\n  const expiryDate = new Date(new Date().setSeconds(new Date().getSeconds() + ttl));\n  return rest\n    .create(config, auth.master(config), '_Idempotency', {\n      reqId: requestId,\n      expire: Parse._encode(expiryDate),\n    })\n    .catch(e => {\n      if (e.code == Parse.Error.DUPLICATE_VALUE) {\n        throw new Parse.Error(Parse.Error.DUPLICATE_REQUEST, 'Duplicate request');\n      }\n      throw e;\n    });\n}\n\nfunction invalidRequest(req, res) {\n  res.status(403);\n  res.end('{\"error\":\"unauthorized\"}');\n}\n\nfunction malformedContext(req, res) {\n  res.status(400);\n  res.json({ code: Parse.Error.INVALID_JSON, error: 'Invalid object for context.' });\n}\n"]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"4f62cd50b0d8160b90be9a5f8479537a488ff865"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_2mghmeqoe3=function(){return actualCoverage;};}return actualCoverage;}cov_2mghmeqoe3();cov_2mghmeqoe3().s[0]++;Object.defineProperty(exports,"__esModule",{value:true});cov_2mghmeqoe3().s[1]++;exports.handleParseHeaders=handleParseHeaders;cov_2mghmeqoe3().s[2]++;exports.allowCrossDomain=allowCrossDomain;cov_2mghmeqoe3().s[3]++;exports.allowMethodOverride=allowMethodOverride;cov_2mghmeqoe3().s[4]++;exports.handleParseErrors=handleParseErrors;cov_2mghmeqoe3().s[5]++;exports.enforceMasterKeyAccess=enforceMasterKeyAccess;cov_2mghmeqoe3().s[6]++;exports.promiseEnforceMasterKeyAccess=promiseEnforceMasterKeyAccess;cov_2mghmeqoe3().s[7]++;exports.promiseEnsureIdempotency=promiseEnsureIdempotency;cov_2mghmeqoe3().s[8]++;exports.DEFAULT_ALLOWED_HEADERS=void 0;var _cache=(cov_2mghmeqoe3().s[9]++,_interopRequireDefault(require("./cache")));var _node=(cov_2mghmeqoe3().s[10]++,_interopRequireDefault(require("parse/node")));var _Auth=(cov_2mghmeqoe3().s[11]++,_interopRequireDefault(require("./Auth")));var _Config=(cov_2mghmeqoe3().s[12]++,_interopRequireDefault(require("./Config")));var _ClientSDK=(cov_2mghmeqoe3().s[13]++,_interopRequireDefault(require("./ClientSDK")));var _logger=(cov_2mghmeqoe3().s[14]++,_interopRequireDefault(require("./logger")));var _rest=(cov_2mghmeqoe3().s[15]++,_interopRequireDefault(require("./rest")));var _MongoStorageAdapter=(cov_2mghmeqoe3().s[16]++,_interopRequireDefault(require("./Adapters/Storage/Mongo/MongoStorageAdapter")));function _interopRequireDefault(obj){cov_2mghmeqoe3().f[0]++;cov_2mghmeqoe3().s[17]++;return(cov_2mghmeqoe3().b[1][0]++,obj)&&(cov_2mghmeqoe3().b[1][1]++,obj.__esModule)?(cov_2mghmeqoe3().b[0][0]++,obj):(cov_2mghmeqoe3().b[0][1]++,{default:obj});}const DEFAULT_ALLOWED_HEADERS=(cov_2mghmeqoe3().s[18]++,'X-Parse-Master-Key, X-Parse-REST-API-Key, X-Parse-Javascript-Key, X-Parse-Application-Id, X-Parse-Client-Version, X-Parse-Session-Token, X-Requested-With, X-Parse-Revocable-Session, X-Parse-Request-Id, Content-Type, Pragma, Cache-Control');cov_2mghmeqoe3().s[19]++;exports.DEFAULT_ALLOWED_HEADERS=DEFAULT_ALLOWED_HEADERS;cov_2mghmeqoe3().s[20]++;const getMountForRequest=function(req){cov_2mghmeqoe3().f[1]++;const mountPathLength=(cov_2mghmeqoe3().s[21]++,req.originalUrl.length-req.url.length);const mountPath=(cov_2mghmeqoe3().s[22]++,req.originalUrl.slice(0,mountPathLength));cov_2mghmeqoe3().s[23]++;return req.protocol+'://'+req.get('host')+mountPath;};// Checks that the request is authorized for this app and checks user
// auth too.
// The bodyparser should run before this middleware.
// Adds info to the request:
// req.config - the Config for this app
// req.auth - the Auth for this request
function handleParseHeaders(req,res,next){cov_2mghmeqoe3().f[2]++;var mount=(cov_2mghmeqoe3().s[24]++,getMountForRequest(req));let context=(cov_2mghmeqoe3().s[25]++,{});cov_2mghmeqoe3().s[26]++;if(req.get('X-Parse-Cloud-Context')!=null){cov_2mghmeqoe3().b[2][0]++;cov_2mghmeqoe3().s[27]++;try{cov_2mghmeqoe3().s[28]++;context=JSON.parse(req.get('X-Parse-Cloud-Context'));cov_2mghmeqoe3().s[29]++;if(Object.prototype.toString.call(context)!=='[object Object]'){cov_2mghmeqoe3().b[3][0]++;cov_2mghmeqoe3().s[30]++;throw'Context is not an object';}else{cov_2mghmeqoe3().b[3][1]++;}}catch(e){cov_2mghmeqoe3().s[31]++;return malformedContext(req,res);}}else{cov_2mghmeqoe3().b[2][1]++;}var info=(cov_2mghmeqoe3().s[32]++,{appId:req.get('X-Parse-Application-Id'),sessionToken:req.get('X-Parse-Session-Token'),masterKey:req.get('X-Parse-Master-Key'),installationId:req.get('X-Parse-Installation-Id'),clientKey:req.get('X-Parse-Client-Key'),javascriptKey:req.get('X-Parse-Javascript-Key'),dotNetKey:req.get('X-Parse-Windows-Key'),restAPIKey:req.get('X-Parse-REST-API-Key'),clientVersion:req.get('X-Parse-Client-Version'),context:context});var basicAuth=(cov_2mghmeqoe3().s[33]++,httpAuth(req));cov_2mghmeqoe3().s[34]++;if(basicAuth){cov_2mghmeqoe3().b[4][0]++;var basicAuthAppId=(cov_2mghmeqoe3().s[35]++,basicAuth.appId);cov_2mghmeqoe3().s[36]++;if(_cache.default.get(basicAuthAppId)){cov_2mghmeqoe3().b[5][0]++;cov_2mghmeqoe3().s[37]++;info.appId=basicAuthAppId;cov_2mghmeqoe3().s[38]++;info.masterKey=(cov_2mghmeqoe3().b[6][0]++,basicAuth.masterKey)||(cov_2mghmeqoe3().b[6][1]++,info.masterKey);cov_2mghmeqoe3().s[39]++;info.javascriptKey=(cov_2mghmeqoe3().b[7][0]++,basicAuth.javascriptKey)||(cov_2mghmeqoe3().b[7][1]++,info.javascriptKey);}else{cov_2mghmeqoe3().b[5][1]++;}}else{cov_2mghmeqoe3().b[4][1]++;}cov_2mghmeqoe3().s[40]++;if(req.body){cov_2mghmeqoe3().b[8][0]++;cov_2mghmeqoe3().s[41]++;// Unity SDK sends a _noBody key which needs to be removed.
// Unclear at this point if action needs to be taken.
delete req.body._noBody;}else{cov_2mghmeqoe3().b[8][1]++;}var fileViaJSON=(cov_2mghmeqoe3().s[42]++,false);cov_2mghmeqoe3().s[43]++;if((cov_2mghmeqoe3().b[10][0]++,!info.appId)||(cov_2mghmeqoe3().b[10][1]++,!_cache.default.get(info.appId))){cov_2mghmeqoe3().b[9][0]++;cov_2mghmeqoe3().s[44]++;// See if we can find the app id on the body.
if(req.body instanceof Buffer){cov_2mghmeqoe3().b[11][0]++;cov_2mghmeqoe3().s[45]++;// The only chance to find the app id is if this is a file
// upload that actually is a JSON body. So try to parse it.
// https://github.com/parse-community/parse-server/issues/6589
// It is also possible that the client is trying to upload a file but forgot
// to provide x-parse-app-id in header and parse a binary file will fail
try{cov_2mghmeqoe3().s[46]++;req.body=JSON.parse(req.body);}catch(e){cov_2mghmeqoe3().s[47]++;return invalidRequest(req,res);}cov_2mghmeqoe3().s[48]++;fileViaJSON=true;}else{cov_2mghmeqoe3().b[11][1]++;}cov_2mghmeqoe3().s[49]++;if(req.body){cov_2mghmeqoe3().b[12][0]++;cov_2mghmeqoe3().s[50]++;delete req.body._RevocableSession;}else{cov_2mghmeqoe3().b[12][1]++;}cov_2mghmeqoe3().s[51]++;if((cov_2mghmeqoe3().b[14][0]++,req.body)&&(cov_2mghmeqoe3().b[14][1]++,req.body._ApplicationId)&&(cov_2mghmeqoe3().b[14][2]++,_cache.default.get(req.body._ApplicationId))&&((cov_2mghmeqoe3().b[14][3]++,!info.masterKey)||(cov_2mghmeqoe3().b[14][4]++,_cache.default.get(req.body._ApplicationId).masterKey===info.masterKey))){cov_2mghmeqoe3().b[13][0]++;cov_2mghmeqoe3().s[52]++;info.appId=req.body._ApplicationId;cov_2mghmeqoe3().s[53]++;info.javascriptKey=(cov_2mghmeqoe3().b[15][0]++,req.body._JavaScriptKey)||(cov_2mghmeqoe3().b[15][1]++,'');cov_2mghmeqoe3().s[54]++;delete req.body._ApplicationId;cov_2mghmeqoe3().s[55]++;delete req.body._JavaScriptKey;// TODO: test that the REST API formats generated by the other
// SDKs are handled ok
cov_2mghmeqoe3().s[56]++;if(req.body._ClientVersion){cov_2mghmeqoe3().b[16][0]++;cov_2mghmeqoe3().s[57]++;info.clientVersion=req.body._ClientVersion;cov_2mghmeqoe3().s[58]++;delete req.body._ClientVersion;}else{cov_2mghmeqoe3().b[16][1]++;}cov_2mghmeqoe3().s[59]++;if(req.body._InstallationId){cov_2mghmeqoe3().b[17][0]++;cov_2mghmeqoe3().s[60]++;info.installationId=req.body._InstallationId;cov_2mghmeqoe3().s[61]++;delete req.body._InstallationId;}else{cov_2mghmeqoe3().b[17][1]++;}cov_2mghmeqoe3().s[62]++;if(req.body._SessionToken){cov_2mghmeqoe3().b[18][0]++;cov_2mghmeqoe3().s[63]++;info.sessionToken=req.body._SessionToken;cov_2mghmeqoe3().s[64]++;delete req.body._SessionToken;}else{cov_2mghmeqoe3().b[18][1]++;}cov_2mghmeqoe3().s[65]++;if(req.body._MasterKey){cov_2mghmeqoe3().b[19][0]++;cov_2mghmeqoe3().s[66]++;info.masterKey=req.body._MasterKey;cov_2mghmeqoe3().s[67]++;delete req.body._MasterKey;}else{cov_2mghmeqoe3().b[19][1]++;}cov_2mghmeqoe3().s[68]++;if(req.body._context){cov_2mghmeqoe3().b[20][0]++;cov_2mghmeqoe3().s[69]++;if(req.body._context instanceof Object){cov_2mghmeqoe3().b[21][0]++;cov_2mghmeqoe3().s[70]++;info.context=req.body._context;}else{cov_2mghmeqoe3().b[21][1]++;cov_2mghmeqoe3().s[71]++;try{cov_2mghmeqoe3().s[72]++;info.context=JSON.parse(req.body._context);cov_2mghmeqoe3().s[73]++;if(Object.prototype.toString.call(info.context)!=='[object Object]'){cov_2mghmeqoe3().b[22][0]++;cov_2mghmeqoe3().s[74]++;throw'Context is not an object';}else{cov_2mghmeqoe3().b[22][1]++;}}catch(e){cov_2mghmeqoe3().s[75]++;return malformedContext(req,res);}}cov_2mghmeqoe3().s[76]++;delete req.body._context;}else{cov_2mghmeqoe3().b[20][1]++;}cov_2mghmeqoe3().s[77]++;if(req.body._ContentType){cov_2mghmeqoe3().b[23][0]++;cov_2mghmeqoe3().s[78]++;req.headers['content-type']=req.body._ContentType;cov_2mghmeqoe3().s[79]++;delete req.body._ContentType;}else{cov_2mghmeqoe3().b[23][1]++;}}else{cov_2mghmeqoe3().b[13][1]++;cov_2mghmeqoe3().s[80]++;return invalidRequest(req,res);}}else{cov_2mghmeqoe3().b[9][1]++;}cov_2mghmeqoe3().s[81]++;if((cov_2mghmeqoe3().b[25][0]++,info.sessionToken)&&(cov_2mghmeqoe3().b[25][1]++,typeof info.sessionToken!=='string')){cov_2mghmeqoe3().b[24][0]++;cov_2mghmeqoe3().s[82]++;info.sessionToken=info.sessionToken.toString();}else{cov_2mghmeqoe3().b[24][1]++;}cov_2mghmeqoe3().s[83]++;if(info.clientVersion){cov_2mghmeqoe3().b[26][0]++;cov_2mghmeqoe3().s[84]++;info.clientSDK=_ClientSDK.default.fromString(info.clientVersion);}else{cov_2mghmeqoe3().b[26][1]++;}cov_2mghmeqoe3().s[85]++;if(fileViaJSON){cov_2mghmeqoe3().b[27][0]++;cov_2mghmeqoe3().s[86]++;req.fileData=req.body.fileData;// We need to repopulate req.body with a buffer
var base64=(cov_2mghmeqoe3().s[87]++,req.body.base64);cov_2mghmeqoe3().s[88]++;req.body=Buffer.from(base64,'base64');}else{cov_2mghmeqoe3().b[27][1]++;}const clientIp=(cov_2mghmeqoe3().s[89]++,getClientIp(req));cov_2mghmeqoe3().s[90]++;info.app=_cache.default.get(info.appId);cov_2mghmeqoe3().s[91]++;req.config=_Config.default.get(info.appId,mount);cov_2mghmeqoe3().s[92]++;req.config.headers=(cov_2mghmeqoe3().b[28][0]++,req.headers)||(cov_2mghmeqoe3().b[28][1]++,{});cov_2mghmeqoe3().s[93]++;req.config.ip=clientIp;cov_2mghmeqoe3().s[94]++;req.info=info;cov_2mghmeqoe3().s[95]++;if((cov_2mghmeqoe3().b[30][0]++,info.masterKey)&&(cov_2mghmeqoe3().b[30][1]++,req.config.masterKeyIps)&&(cov_2mghmeqoe3().b[30][2]++,req.config.masterKeyIps.length!==0)&&(cov_2mghmeqoe3().b[30][3]++,req.config.masterKeyIps.indexOf(clientIp)===-1)){cov_2mghmeqoe3().b[29][0]++;cov_2mghmeqoe3().s[96]++;return invalidRequest(req,res);}else{cov_2mghmeqoe3().b[29][1]++;}var isMaster=(cov_2mghmeqoe3().s[97]++,info.masterKey===req.config.masterKey);cov_2mghmeqoe3().s[98]++;if(isMaster){cov_2mghmeqoe3().b[31][0]++;cov_2mghmeqoe3().s[99]++;req.auth=new _Auth.default.Auth({config:req.config,installationId:info.installationId,isMaster:true});cov_2mghmeqoe3().s[100]++;next();cov_2mghmeqoe3().s[101]++;return;}else{cov_2mghmeqoe3().b[31][1]++;}var isReadOnlyMaster=(cov_2mghmeqoe3().s[102]++,info.masterKey===req.config.readOnlyMasterKey);cov_2mghmeqoe3().s[103]++;if((cov_2mghmeqoe3().b[33][0]++,typeof req.config.readOnlyMasterKey!='undefined')&&(cov_2mghmeqoe3().b[33][1]++,req.config.readOnlyMasterKey)&&(cov_2mghmeqoe3().b[33][2]++,isReadOnlyMaster)){cov_2mghmeqoe3().b[32][0]++;cov_2mghmeqoe3().s[104]++;req.auth=new _Auth.default.Auth({config:req.config,installationId:info.installationId,isMaster:true,isReadOnly:true});cov_2mghmeqoe3().s[105]++;next();cov_2mghmeqoe3().s[106]++;return;}else{cov_2mghmeqoe3().b[32][1]++;}// Client keys are not required in parse-server, but if any have been configured in the server, validate them
//  to preserve original behavior.
const keys=(cov_2mghmeqoe3().s[107]++,['clientKey','javascriptKey','dotNetKey','restAPIKey']);const oneKeyConfigured=(cov_2mghmeqoe3().s[108]++,keys.some(function(key){cov_2mghmeqoe3().f[3]++;cov_2mghmeqoe3().s[109]++;return req.config[key]!==undefined;}));const oneKeyMatches=(cov_2mghmeqoe3().s[110]++,keys.some(function(key){cov_2mghmeqoe3().f[4]++;cov_2mghmeqoe3().s[111]++;return(cov_2mghmeqoe3().b[34][0]++,req.config[key]!==undefined)&&(cov_2mghmeqoe3().b[34][1]++,info[key]===req.config[key]);}));cov_2mghmeqoe3().s[112]++;if((cov_2mghmeqoe3().b[36][0]++,oneKeyConfigured)&&(cov_2mghmeqoe3().b[36][1]++,!oneKeyMatches)){cov_2mghmeqoe3().b[35][0]++;cov_2mghmeqoe3().s[113]++;return invalidRequest(req,res);}else{cov_2mghmeqoe3().b[35][1]++;}cov_2mghmeqoe3().s[114]++;if(req.url=='/login'){cov_2mghmeqoe3().b[37][0]++;cov_2mghmeqoe3().s[115]++;delete info.sessionToken;}else{cov_2mghmeqoe3().b[37][1]++;}cov_2mghmeqoe3().s[116]++;if(req.userFromJWT){cov_2mghmeqoe3().b[38][0]++;cov_2mghmeqoe3().s[117]++;req.auth=new _Auth.default.Auth({config:req.config,installationId:info.installationId,isMaster:false,user:req.userFromJWT});cov_2mghmeqoe3().s[118]++;next();cov_2mghmeqoe3().s[119]++;return;}else{cov_2mghmeqoe3().b[38][1]++;}cov_2mghmeqoe3().s[120]++;if(!info.sessionToken){cov_2mghmeqoe3().b[39][0]++;cov_2mghmeqoe3().s[121]++;req.auth=new _Auth.default.Auth({config:req.config,installationId:info.installationId,isMaster:false});cov_2mghmeqoe3().s[122]++;next();cov_2mghmeqoe3().s[123]++;return;}else{cov_2mghmeqoe3().b[39][1]++;}cov_2mghmeqoe3().s[124]++;return Promise.resolve().then(()=>{cov_2mghmeqoe3().f[5]++;cov_2mghmeqoe3().s[125]++;// handle the upgradeToRevocableSession path on it's own
if((cov_2mghmeqoe3().b[41][0]++,info.sessionToken)&&(cov_2mghmeqoe3().b[41][1]++,req.url==='/upgradeToRevocableSession')&&(cov_2mghmeqoe3().b[41][2]++,info.sessionToken.indexOf('r:')!=0)){cov_2mghmeqoe3().b[40][0]++;cov_2mghmeqoe3().s[126]++;return _Auth.default.getAuthForLegacySessionToken({config:req.config,installationId:info.installationId,sessionToken:info.sessionToken});}else{cov_2mghmeqoe3().b[40][1]++;cov_2mghmeqoe3().s[127]++;return _Auth.default.getAuthForSessionToken({config:req.config,installationId:info.installationId,sessionToken:info.sessionToken});}}).then(auth=>{cov_2mghmeqoe3().f[6]++;cov_2mghmeqoe3().s[128]++;if(auth){cov_2mghmeqoe3().b[42][0]++;cov_2mghmeqoe3().s[129]++;req.auth=auth;cov_2mghmeqoe3().s[130]++;next();}else{cov_2mghmeqoe3().b[42][1]++;}}).catch(error=>{cov_2mghmeqoe3().f[7]++;cov_2mghmeqoe3().s[131]++;if(error instanceof _node.default.Error){cov_2mghmeqoe3().b[43][0]++;cov_2mghmeqoe3().s[132]++;next(error);cov_2mghmeqoe3().s[133]++;return;}else{cov_2mghmeqoe3().b[43][1]++;cov_2mghmeqoe3().s[134]++;// TODO: Determine the correct error scenario.
req.config.loggerController.error('error getting auth for sessionToken',error);cov_2mghmeqoe3().s[135]++;throw new _node.default.Error(_node.default.Error.UNKNOWN_ERROR,error);}});}function getClientIp(req){cov_2mghmeqoe3().f[8]++;cov_2mghmeqoe3().s[136]++;if(req.headers['x-forwarded-for']){cov_2mghmeqoe3().b[44][0]++;cov_2mghmeqoe3().s[137]++;// try to get from x-forwared-for if it set (behind reverse proxy)
return req.headers['x-forwarded-for'].split(',')[0];}else{cov_2mghmeqoe3().b[44][1]++;cov_2mghmeqoe3().s[138]++;if((cov_2mghmeqoe3().b[46][0]++,req.connection)&&(cov_2mghmeqoe3().b[46][1]++,req.connection.remoteAddress)){cov_2mghmeqoe3().b[45][0]++;cov_2mghmeqoe3().s[139]++;// no proxy, try getting from connection.remoteAddress
return req.connection.remoteAddress;}else{cov_2mghmeqoe3().b[45][1]++;cov_2mghmeqoe3().s[140]++;if(req.socket){cov_2mghmeqoe3().b[47][0]++;cov_2mghmeqoe3().s[141]++;// try to get it from req.socket
return req.socket.remoteAddress;}else{cov_2mghmeqoe3().b[47][1]++;cov_2mghmeqoe3().s[142]++;if((cov_2mghmeqoe3().b[49][0]++,req.connection)&&(cov_2mghmeqoe3().b[49][1]++,req.connection.socket)){cov_2mghmeqoe3().b[48][0]++;cov_2mghmeqoe3().s[143]++;// try to get it form the connection.socket
return req.connection.socket.remoteAddress;}else{cov_2mghmeqoe3().b[48][1]++;cov_2mghmeqoe3().s[144]++;// if non above, fallback.
return req.ip;}}}}}function httpAuth(req){cov_2mghmeqoe3().f[9]++;cov_2mghmeqoe3().s[145]++;if(!((cov_2mghmeqoe3().b[51][0]++,req.req)||(cov_2mghmeqoe3().b[51][1]++,req)).headers.authorization){cov_2mghmeqoe3().b[50][0]++;cov_2mghmeqoe3().s[146]++;return;}else{cov_2mghmeqoe3().b[50][1]++;}var header=(cov_2mghmeqoe3().s[147]++,((cov_2mghmeqoe3().b[52][0]++,req.req)||(cov_2mghmeqoe3().b[52][1]++,req)).headers.authorization);var appId,masterKey,javascriptKey;// parse header
var authPrefix=(cov_2mghmeqoe3().s[148]++,'basic ');var match=(cov_2mghmeqoe3().s[149]++,header.toLowerCase().indexOf(authPrefix));cov_2mghmeqoe3().s[150]++;if(match==0){cov_2mghmeqoe3().b[53][0]++;var encodedAuth=(cov_2mghmeqoe3().s[151]++,header.substring(authPrefix.length,header.length));var credentials=(cov_2mghmeqoe3().s[152]++,decodeBase64(encodedAuth).split(':'));cov_2mghmeqoe3().s[153]++;if(credentials.length==2){cov_2mghmeqoe3().b[54][0]++;cov_2mghmeqoe3().s[154]++;appId=credentials[0];var key=(cov_2mghmeqoe3().s[155]++,credentials[1]);var jsKeyPrefix=(cov_2mghmeqoe3().s[156]++,'javascript-key=');var matchKey=(cov_2mghmeqoe3().s[157]++,key.indexOf(jsKeyPrefix));cov_2mghmeqoe3().s[158]++;if(matchKey==0){cov_2mghmeqoe3().b[55][0]++;cov_2mghmeqoe3().s[159]++;javascriptKey=key.substring(jsKeyPrefix.length,key.length);}else{cov_2mghmeqoe3().b[55][1]++;cov_2mghmeqoe3().s[160]++;masterKey=key;}}else{cov_2mghmeqoe3().b[54][1]++;}}else{cov_2mghmeqoe3().b[53][1]++;}cov_2mghmeqoe3().s[161]++;return{appId:appId,masterKey:masterKey,javascriptKey:javascriptKey};}function decodeBase64(str){cov_2mghmeqoe3().f[10]++;cov_2mghmeqoe3().s[162]++;return Buffer.from(str,'base64').toString();}function allowCrossDomain(appId){cov_2mghmeqoe3().f[11]++;cov_2mghmeqoe3().s[163]++;return(req,res,next)=>{cov_2mghmeqoe3().f[12]++;const config=(cov_2mghmeqoe3().s[164]++,_Config.default.get(appId,getMountForRequest(req)));let allowHeaders=(cov_2mghmeqoe3().s[165]++,DEFAULT_ALLOWED_HEADERS);cov_2mghmeqoe3().s[166]++;if((cov_2mghmeqoe3().b[57][0]++,config)&&(cov_2mghmeqoe3().b[57][1]++,config.allowHeaders)){cov_2mghmeqoe3().b[56][0]++;cov_2mghmeqoe3().s[167]++;allowHeaders+=`, ${config.allowHeaders.join(', ')}`;}else{cov_2mghmeqoe3().b[56][1]++;}const allowOrigin=(cov_2mghmeqoe3().s[168]++,(cov_2mghmeqoe3().b[58][0]++,config)&&(cov_2mghmeqoe3().b[58][1]++,config.allowOrigin)||(cov_2mghmeqoe3().b[58][2]++,'*'));cov_2mghmeqoe3().s[169]++;res.header('Access-Control-Allow-Origin',allowOrigin);cov_2mghmeqoe3().s[170]++;res.header('Access-Control-Allow-Methods','GET,PUT,POST,DELETE,OPTIONS');cov_2mghmeqoe3().s[171]++;res.header('Access-Control-Allow-Headers',allowHeaders);cov_2mghmeqoe3().s[172]++;res.header('Access-Control-Expose-Headers','X-Parse-Job-Status-Id, X-Parse-Push-Status-Id');// intercept OPTIONS method
cov_2mghmeqoe3().s[173]++;if('OPTIONS'==req.method){cov_2mghmeqoe3().b[59][0]++;cov_2mghmeqoe3().s[174]++;res.sendStatus(200);}else{cov_2mghmeqoe3().b[59][1]++;cov_2mghmeqoe3().s[175]++;next();}};}function allowMethodOverride(req,res,next){cov_2mghmeqoe3().f[13]++;cov_2mghmeqoe3().s[176]++;if((cov_2mghmeqoe3().b[61][0]++,req.method==='POST')&&(cov_2mghmeqoe3().b[61][1]++,req.body._method)){cov_2mghmeqoe3().b[60][0]++;cov_2mghmeqoe3().s[177]++;req.originalMethod=req.method;cov_2mghmeqoe3().s[178]++;req.method=req.body._method;cov_2mghmeqoe3().s[179]++;delete req.body._method;}else{cov_2mghmeqoe3().b[60][1]++;}cov_2mghmeqoe3().s[180]++;next();}function handleParseErrors(err,req,res,next){cov_2mghmeqoe3().f[14]++;const log=(cov_2mghmeqoe3().s[181]++,(cov_2mghmeqoe3().b[62][0]++,req.config)&&(cov_2mghmeqoe3().b[62][1]++,req.config.loggerController)||(cov_2mghmeqoe3().b[62][2]++,_logger.default));cov_2mghmeqoe3().s[182]++;if(err instanceof _node.default.Error){cov_2mghmeqoe3().b[63][0]++;cov_2mghmeqoe3().s[183]++;if((cov_2mghmeqoe3().b[65][0]++,req.config)&&(cov_2mghmeqoe3().b[65][1]++,req.config.enableExpressErrorHandler)){cov_2mghmeqoe3().b[64][0]++;cov_2mghmeqoe3().s[184]++;return next(err);}else{cov_2mghmeqoe3().b[64][1]++;}let httpStatus;// TODO: fill out this mapping
cov_2mghmeqoe3().s[185]++;switch(err.code){case _node.default.Error.INTERNAL_SERVER_ERROR:cov_2mghmeqoe3().b[66][0]++;cov_2mghmeqoe3().s[186]++;httpStatus=500;cov_2mghmeqoe3().s[187]++;break;case _node.default.Error.OBJECT_NOT_FOUND:cov_2mghmeqoe3().b[66][1]++;cov_2mghmeqoe3().s[188]++;httpStatus=404;cov_2mghmeqoe3().s[189]++;break;default:cov_2mghmeqoe3().b[66][2]++;cov_2mghmeqoe3().s[190]++;httpStatus=400;}cov_2mghmeqoe3().s[191]++;res.status(httpStatus);cov_2mghmeqoe3().s[192]++;res.json({code:err.code,error:err.message});cov_2mghmeqoe3().s[193]++;log.error('Parse error: ',err);}else{cov_2mghmeqoe3().b[63][1]++;cov_2mghmeqoe3().s[194]++;if((cov_2mghmeqoe3().b[68][0]++,err.status)&&(cov_2mghmeqoe3().b[68][1]++,err.message)){cov_2mghmeqoe3().b[67][0]++;cov_2mghmeqoe3().s[195]++;res.status(err.status);cov_2mghmeqoe3().s[196]++;res.json({error:err.message});cov_2mghmeqoe3().s[197]++;if(!((cov_2mghmeqoe3().b[70][0]++,process)&&(cov_2mghmeqoe3().b[70][1]++,process.env.TESTING))){cov_2mghmeqoe3().b[69][0]++;cov_2mghmeqoe3().s[198]++;next(err);}else{cov_2mghmeqoe3().b[69][1]++;}}else{cov_2mghmeqoe3().b[67][1]++;cov_2mghmeqoe3().s[199]++;log.error('Uncaught internal server error.',err,err.stack);cov_2mghmeqoe3().s[200]++;res.status(500);cov_2mghmeqoe3().s[201]++;res.json({code:_node.default.Error.INTERNAL_SERVER_ERROR,message:'Internal server error.'});cov_2mghmeqoe3().s[202]++;if(!((cov_2mghmeqoe3().b[72][0]++,process)&&(cov_2mghmeqoe3().b[72][1]++,process.env.TESTING))){cov_2mghmeqoe3().b[71][0]++;cov_2mghmeqoe3().s[203]++;next(err);}else{cov_2mghmeqoe3().b[71][1]++;}}}}function enforceMasterKeyAccess(req,res,next){cov_2mghmeqoe3().f[15]++;cov_2mghmeqoe3().s[204]++;if(!req.auth.isMaster){cov_2mghmeqoe3().b[73][0]++;cov_2mghmeqoe3().s[205]++;res.status(403);cov_2mghmeqoe3().s[206]++;res.end('{"error":"unauthorized: master key is required"}');cov_2mghmeqoe3().s[207]++;return;}else{cov_2mghmeqoe3().b[73][1]++;}cov_2mghmeqoe3().s[208]++;next();}function promiseEnforceMasterKeyAccess(request){cov_2mghmeqoe3().f[16]++;cov_2mghmeqoe3().s[209]++;if(!request.auth.isMaster){cov_2mghmeqoe3().b[74][0]++;const error=(cov_2mghmeqoe3().s[210]++,new Error());cov_2mghmeqoe3().s[211]++;error.status=403;cov_2mghmeqoe3().s[212]++;error.message='unauthorized: master key is required';cov_2mghmeqoe3().s[213]++;throw error;}else{cov_2mghmeqoe3().b[74][1]++;}cov_2mghmeqoe3().s[214]++;return Promise.resolve();}/**
 * Deduplicates a request to ensure idempotency. Duplicates are determined by the request ID
 * in the request header. If a request has no request ID, it is executed anyway.
 * @param {*} req The request to evaluate.
 * @returns Promise<{}>
 */function promiseEnsureIdempotency(req){cov_2mghmeqoe3().f[17]++;cov_2mghmeqoe3().s[215]++;// Enable feature only for MongoDB
if(!(req.config.database.adapter instanceof _MongoStorageAdapter.default)){cov_2mghmeqoe3().b[75][0]++;cov_2mghmeqoe3().s[216]++;return Promise.resolve();}else{cov_2mghmeqoe3().b[75][1]++;}// Get parameters
const config=(cov_2mghmeqoe3().s[217]++,req.config);const requestId=(cov_2mghmeqoe3().s[218]++,((cov_2mghmeqoe3().b[76][0]++,((cov_2mghmeqoe3().b[77][0]++,req)||(cov_2mghmeqoe3().b[77][1]++,{})).headers)||(cov_2mghmeqoe3().b[76][1]++,{}))['x-parse-request-id']);const{paths,ttl}=(cov_2mghmeqoe3().s[219]++,config.idempotencyOptions);cov_2mghmeqoe3().s[220]++;if((cov_2mghmeqoe3().b[79][0]++,!requestId)||(cov_2mghmeqoe3().b[79][1]++,!config.idempotencyOptions)){cov_2mghmeqoe3().b[78][0]++;cov_2mghmeqoe3().s[221]++;return Promise.resolve();}else{cov_2mghmeqoe3().b[78][1]++;}// Request path may contain trailing slashes, depending on the original request, so remove
// leading and trailing slashes to make it easier to specify paths in the configuration
const reqPath=(cov_2mghmeqoe3().s[222]++,req.path.replace(/^\/|\/$/,''));// Determine whether idempotency is enabled for current request path
let match=(cov_2mghmeqoe3().s[223]++,false);cov_2mghmeqoe3().s[224]++;for(const path of paths){// Assume one wants a path to always match from the beginning to prevent any mistakes
const regex=(cov_2mghmeqoe3().s[225]++,new RegExp(path.charAt(0)==='^'?(cov_2mghmeqoe3().b[80][0]++,path):(cov_2mghmeqoe3().b[80][1]++,'^'+path)));cov_2mghmeqoe3().s[226]++;if(reqPath.match(regex)){cov_2mghmeqoe3().b[81][0]++;cov_2mghmeqoe3().s[227]++;match=true;cov_2mghmeqoe3().s[228]++;break;}else{cov_2mghmeqoe3().b[81][1]++;}}cov_2mghmeqoe3().s[229]++;if(!match){cov_2mghmeqoe3().b[82][0]++;cov_2mghmeqoe3().s[230]++;return Promise.resolve();}else{cov_2mghmeqoe3().b[82][1]++;}// Try to store request
const expiryDate=(cov_2mghmeqoe3().s[231]++,new Date(new Date().setSeconds(new Date().getSeconds()+ttl)));cov_2mghmeqoe3().s[232]++;return _rest.default.create(config,_Auth.default.master(config),'_Idempotency',{reqId:requestId,expire:_node.default._encode(expiryDate)}).catch(e=>{cov_2mghmeqoe3().f[18]++;cov_2mghmeqoe3().s[233]++;if(e.code==_node.default.Error.DUPLICATE_VALUE){cov_2mghmeqoe3().b[83][0]++;cov_2mghmeqoe3().s[234]++;throw new _node.default.Error(_node.default.Error.DUPLICATE_REQUEST,'Duplicate request');}else{cov_2mghmeqoe3().b[83][1]++;}cov_2mghmeqoe3().s[235]++;throw e;});}function invalidRequest(req,res){cov_2mghmeqoe3().f[19]++;cov_2mghmeqoe3().s[236]++;res.status(403);cov_2mghmeqoe3().s[237]++;res.end('{"error":"unauthorized"}');}function malformedContext(req,res){cov_2mghmeqoe3().f[20]++;cov_2mghmeqoe3().s[238]++;res.status(400);cov_2mghmeqoe3().s[239]++;res.json({code:_node.default.Error.INVALID_JSON,error:'Invalid object for context.'});}//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9taWRkbGV3YXJlcy5qcyJdLCJuYW1lcyI6WyJERUZBVUxUX0FMTE9XRURfSEVBREVSUyIsImdldE1vdW50Rm9yUmVxdWVzdCIsInJlcSIsIm1vdW50UGF0aExlbmd0aCIsIm9yaWdpbmFsVXJsIiwibGVuZ3RoIiwidXJsIiwibW91bnRQYXRoIiwic2xpY2UiLCJwcm90b2NvbCIsImdldCIsImhhbmRsZVBhcnNlSGVhZGVycyIsInJlcyIsIm5leHQiLCJtb3VudCIsImNvbnRleHQiLCJKU09OIiwicGFyc2UiLCJPYmplY3QiLCJwcm90b3R5cGUiLCJ0b1N0cmluZyIsImNhbGwiLCJlIiwibWFsZm9ybWVkQ29udGV4dCIsImluZm8iLCJhcHBJZCIsInNlc3Npb25Ub2tlbiIsIm1hc3RlcktleSIsImluc3RhbGxhdGlvbklkIiwiY2xpZW50S2V5IiwiamF2YXNjcmlwdEtleSIsImRvdE5ldEtleSIsInJlc3RBUElLZXkiLCJjbGllbnRWZXJzaW9uIiwiYmFzaWNBdXRoIiwiaHR0cEF1dGgiLCJiYXNpY0F1dGhBcHBJZCIsIkFwcENhY2hlIiwiYm9keSIsIl9ub0JvZHkiLCJmaWxlVmlhSlNPTiIsIkJ1ZmZlciIsImludmFsaWRSZXF1ZXN0IiwiX1Jldm9jYWJsZVNlc3Npb24iLCJfQXBwbGljYXRpb25JZCIsIl9KYXZhU2NyaXB0S2V5IiwiX0NsaWVudFZlcnNpb24iLCJfSW5zdGFsbGF0aW9uSWQiLCJfU2Vzc2lvblRva2VuIiwiX01hc3RlcktleSIsIl9jb250ZXh0IiwiX0NvbnRlbnRUeXBlIiwiaGVhZGVycyIsImNsaWVudFNESyIsIkNsaWVudFNESyIsImZyb21TdHJpbmciLCJmaWxlRGF0YSIsImJhc2U2NCIsImZyb20iLCJjbGllbnRJcCIsImdldENsaWVudElwIiwiYXBwIiwiY29uZmlnIiwiQ29uZmlnIiwiaXAiLCJtYXN0ZXJLZXlJcHMiLCJpbmRleE9mIiwiaXNNYXN0ZXIiLCJhdXRoIiwiQXV0aCIsImlzUmVhZE9ubHlNYXN0ZXIiLCJyZWFkT25seU1hc3RlcktleSIsImlzUmVhZE9ubHkiLCJrZXlzIiwib25lS2V5Q29uZmlndXJlZCIsInNvbWUiLCJrZXkiLCJ1bmRlZmluZWQiLCJvbmVLZXlNYXRjaGVzIiwidXNlckZyb21KV1QiLCJ1c2VyIiwiUHJvbWlzZSIsInJlc29sdmUiLCJ0aGVuIiwiZ2V0QXV0aEZvckxlZ2FjeVNlc3Npb25Ub2tlbiIsImdldEF1dGhGb3JTZXNzaW9uVG9rZW4iLCJjYXRjaCIsImVycm9yIiwiUGFyc2UiLCJFcnJvciIsImxvZ2dlckNvbnRyb2xsZXIiLCJVTktOT1dOX0VSUk9SIiwic3BsaXQiLCJjb25uZWN0aW9uIiwicmVtb3RlQWRkcmVzcyIsInNvY2tldCIsImF1dGhvcml6YXRpb24iLCJoZWFkZXIiLCJhdXRoUHJlZml4IiwibWF0Y2giLCJ0b0xvd2VyQ2FzZSIsImVuY29kZWRBdXRoIiwic3Vic3RyaW5nIiwiY3JlZGVudGlhbHMiLCJkZWNvZGVCYXNlNjQiLCJqc0tleVByZWZpeCIsIm1hdGNoS2V5Iiwic3RyIiwiYWxsb3dDcm9zc0RvbWFpbiIsImFsbG93SGVhZGVycyIsImpvaW4iLCJhbGxvd09yaWdpbiIsIm1ldGhvZCIsInNlbmRTdGF0dXMiLCJhbGxvd01ldGhvZE92ZXJyaWRlIiwiX21ldGhvZCIsIm9yaWdpbmFsTWV0aG9kIiwiaGFuZGxlUGFyc2VFcnJvcnMiLCJlcnIiLCJsb2ciLCJkZWZhdWx0TG9nZ2VyIiwiZW5hYmxlRXhwcmVzc0Vycm9ySGFuZGxlciIsImh0dHBTdGF0dXMiLCJjb2RlIiwiSU5URVJOQUxfU0VSVkVSX0VSUk9SIiwiT0JKRUNUX05PVF9GT1VORCIsInN0YXR1cyIsImpzb24iLCJtZXNzYWdlIiwicHJvY2VzcyIsImVudiIsIlRFU1RJTkciLCJzdGFjayIsImVuZm9yY2VNYXN0ZXJLZXlBY2Nlc3MiLCJlbmQiLCJwcm9taXNlRW5mb3JjZU1hc3RlcktleUFjY2VzcyIsInJlcXVlc3QiLCJwcm9taXNlRW5zdXJlSWRlbXBvdGVuY3kiLCJkYXRhYmFzZSIsImFkYXB0ZXIiLCJNb25nb1N0b3JhZ2VBZGFwdGVyIiwicmVxdWVzdElkIiwicGF0aHMiLCJ0dGwiLCJpZGVtcG90ZW5jeU9wdGlvbnMiLCJyZXFQYXRoIiwicGF0aCIsInJlcGxhY2UiLCJyZWdleCIsIlJlZ0V4cCIsImNoYXJBdCIsImV4cGlyeURhdGUiLCJEYXRlIiwic2V0U2Vjb25kcyIsImdldFNlY29uZHMiLCJyZXN0IiwiY3JlYXRlIiwibWFzdGVyIiwicmVxSWQiLCJleHBpcmUiLCJfZW5jb2RlIiwiRFVQTElDQVRFX1ZBTFVFIiwiRFVQTElDQVRFX1JFUVVFU1QiLCJJTlZBTElEX0pTT04iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7O0FBQUE7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7Ozs7QUFFTyxNQUFNQSx1QkFBdUIsR0FDbEMsK09BREs7OztBQUdQLE1BQU1DLGtCQUFrQixHQUFHLFVBQVVDLEdBQVYsRUFBZTtBQUN4QyxRQUFNQyxlQUFlLEdBQUdELEdBQUcsQ0FBQ0UsV0FBSixDQUFnQkMsTUFBaEIsR0FBeUJILEdBQUcsQ0FBQ0ksR0FBSixDQUFRRCxNQUF6RDtBQUNBLFFBQU1FLFNBQVMsR0FBR0wsR0FBRyxDQUFDRSxXQUFKLENBQWdCSSxLQUFoQixDQUFzQixDQUF0QixFQUF5QkwsZUFBekIsQ0FBbEI7QUFDQSxTQUFPRCxHQUFHLENBQUNPLFFBQUosR0FBZSxLQUFmLEdBQXVCUCxHQUFHLENBQUNRLEdBQUosQ0FBUSxNQUFSLENBQXZCLEdBQXlDSCxTQUFoRDtBQUNELENBSkQsQyxDQU1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBQ08sU0FBU0ksa0JBQVQsQ0FBNEJULEdBQTVCLEVBQWlDVSxHQUFqQyxFQUFzQ0MsSUFBdEMsRUFBNEM7QUFDakQsTUFBSUMsS0FBSyxHQUFHYixrQkFBa0IsQ0FBQ0MsR0FBRCxDQUE5QjtBQUVBLE1BQUlhLE9BQU8sR0FBRyxFQUFkOztBQUNBLE1BQUliLEdBQUcsQ0FBQ1EsR0FBSixDQUFR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SUFBSSxFQUFFbkMsY0FBTUMsS0FBTixDQUFZMEUsWUFBcEI7QUFBa0M1RSxJQUFBQSxLQUFLLEVBQUU7QUFBekMsR0FBVDtBQUNEIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IEFwcENhY2hlIGZyb20gJy4vY2FjaGUnO1xuaW1wb3J0IFBhcnNlIGZyb20gJ3BhcnNlL25vZGUnO1xuaW1wb3J0IGF1dGggZnJvbSAnLi9BdXRoJztcbmltcG9ydCBDb25maWcgZnJvbSAnLi9Db25maWcnO1xuaW1wb3J0IENsaWVudFNESyBmcm9tICcuL0NsaWVudFNESyc7XG5pbXBvcnQgZGVmYXVsdExvZ2dlciBmcm9tICcuL2xvZ2dlcic7XG5pbXBvcnQgcmVzdCBmcm9tICcuL3Jlc3QnO1xuaW1wb3J0IE1vbmdvU3RvcmFnZUFkYXB0ZXIgZnJvbSAnLi9BZGFwdGVycy9TdG9yYWdlL01vbmdvL01vbmdvU3RvcmFnZUFkYXB0ZXInO1xuXG5leHBvcnQgY29uc3QgREVGQVVMVF9BTExPV0VEX0hFQURFUlMgPVxuICAnWC1QYXJzZS1NYXN0ZXItS2V5LCBYLVBhcnNlLVJFU1QtQVBJLUtleSwgWC1QYXJzZS1KYXZhc2NyaXB0LUtleSwgWC1QYXJzZS1BcHBsaWNhdGlvbi1JZCwgWC1QYXJzZS1DbGllbnQtVmVyc2lvbiwgWC1QYXJzZS1TZXNzaW9uLVRva2VuLCBYLVJlcXVlc3RlZC1XaXRoLCBYLVBhcnNlLVJldm9jYWJsZS1TZXNzaW9uLCBYLVBhcnNlLVJlcXVlc3QtSWQsIENvbnRlbnQtVHlwZSwgUHJhZ21hLCBDYWNoZS1Db250cm9sJztcblxuY29uc3QgZ2V0TW91bnRGb3JSZXF1ZXN0ID0gZnVuY3Rpb24gKHJlcSkge1xuICBjb25zdCBtb3VudFBhdGhMZW5ndGggPSByZXEub3JpZ2luYWxVcmwubGVuZ3RoIC0gcmVxLnVybC5sZW5ndGg7XG4gIGNvbnN0IG1vdW50UGF0aCA9IHJlcS5vcmlnaW5hbFVybC5zbGljZSgwLCBtb3VudFBhdGhMZW5ndGgpO1xuICByZXR1cm4gcmVxLnByb3RvY29sICsgJzovLycgKyByZXEuZ2V0KCdob3N0JykgKyBtb3VudFBhdGg7XG59O1xuXG4vLyBDaGVja3MgdGhhdCB0aGUgcmVxdWVzdCBpcyBhdXRob3JpemVkIGZvciB0aGlzIGFwcCBhbmQgY2hlY2tzIHVzZXJcbi8vIGF1dGggdG9vLlxuLy8gVGhlIGJvZHlwYXJzZXIgc2hvdWxkIHJ1biBiZWZvcmUgdGhpcyBtaWRkbGV3YXJlLlxuLy8gQWRkcyBpbmZvIHRvIHRoZSByZXF1ZXN0OlxuLy8gcmVxLmNvbmZpZyAtIHRoZSBDb25maWcgZm9yIHRoaXMgYXBwXG4vLyByZXEuYXV0aCAtIHRoZSBBdXRoIGZvciB0aGlzIHJlcXVlc3RcbmV4cG9ydCBmdW5jdGlvbiBoYW5kbGVQYXJzZUhlYWRlcnMocmVxLCByZXMsIG5leHQpIHtcbiAgdmFyIG1vdW50ID0gZ2V0TW91bnRGb3JSZXF1ZXN0KHJlcSk7XG5cbiAgbGV0IGNvbnRleHQgPSB7fTtcbiAgaWYgKHJlcS5nZXQoJ1gtUGFyc2UtQ2xvdWQtQ29udGV4dCcpICE9IG51bGwpIHtcbiAgICB0cnkge1xuICAgICAgY29udGV4dCA9IEpTT04ucGFyc2UocmVxLmdldCgnWC1QYXJzZS1DbG91ZC1Db250ZXh0JykpO1xuICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChjb250ZXh0KSAhPT0gJ1tvYmplY3QgT2JqZWN0XScpIHtcbiAgICAgICAgdGhyb3cgJ0NvbnRleHQgaXMgbm90IGFuIG9iamVjdCc7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgcmV0dXJuIG1hbGZvcm1lZENvbnRleHQocmVxLCByZXMpO1xuICAgIH1cbiAgfVxuICB2YXIgaW5mbyA9IHtcbiAgICBhcHBJZDogcmVxLmdldCgnWC1QYXJzZS1BcHBsaWNhdGlvbi1JZCcpLFxuICAgIHNlc3Npb25Ub2tlbjogcmVxLmdldCgnWC1QYXJzZS1TZXNzaW9uLVRva2VuJyksXG4gICAgbWFzdGVyS2V5OiByZXEuZ2V0KCdYLVBhcnNlLU1hc3Rlci1LZXknKSxcbiAgICBpbnN0YWxsYXRpb25JZDogcmVxLmdldCgnWC1QYXJzZS1JbnN0YWxsYXRpb24tSWQnKSxcbiAgICBjbGllbnRLZXk6IHJlcS5nZXQoJ1gtUGFyc2UtQ2xpZW50LUtleScpLFxuICAgIGphdmFzY3JpcHRLZXk6IHJlcS5nZXQoJ1gtUGFyc2UtSmF2YXNjcmlwdC1LZXknKSxcbiAgICBkb3ROZXRLZXk6IHJlcS5nZXQoJ1gtUGFyc2UtV2luZG93cy1LZXknKSxcbiAgICByZXN0QVBJS2V5OiByZXEuZ2V0KCdYLVBhcnNlLVJFU1QtQVBJLUtleScpLFxuICAgIGNsaWVudFZlcnNpb246IHJlcS5nZXQoJ1gtUGFyc2UtQ2xpZW50LVZlcnNpb24nKSxcbiAgICBjb250ZXh0OiBjb250ZXh0LFxuICB9O1xuXG4gIHZhciBiYXNpY0F1dGggPSBodHRwQXV0aChyZXEpO1xuXG4gIGlmIChiYXNpY0F1dGgpIHtcbiAgICB2YXIgYmFzaWNBdXRoQXBwSWQgPSBiYXNpY0F1dGguYXBwSWQ7XG4gICAgaWYgKEFwcENhY2hlLmdldChiYXNpY0F1dGhBcHBJZCkpIHtcbiAgICAgIGluZm8uYXBwSWQgPSBiYXNpY0F1dGhBcHBJZDtcbiAgICAgIGluZm8ubWFzdGVyS2V5ID0gYmFzaWNBdXRoLm1hc3RlcktleSB8fCBpbmZvLm1hc3RlcktleTtcbiAgICAgIGluZm8uamF2YXNjcmlwdEtleSA9IGJhc2ljQXV0aC5qYXZhc2NyaXB0S2V5IHx8IGluZm8uamF2YXNjcmlwdEtleTtcbiAgICB9XG4gIH1cblxuICBpZiAocmVxLmJvZHkpIHtcbiAgICAvLyBVbml0eSBTREsgc2VuZHMgYSBfbm9Cb2R5IGtleSB3aGljaCBuZWVkcyB0byBiZSByZW1vdmVkLlxuICAgIC8vIFVuY2xlYXIgYXQgdGhpcyBwb2ludCBpZiBhY3Rpb24gbmVlZHMgdG8gYmUgdGFrZW4uXG4gICAgZGVsZXRlIHJlcS5ib2R5Ll9ub0JvZHk7XG4gIH1cblxuICB2YXIgZmlsZVZpYUpTT04gPSBmYWxzZTtcblxuICBpZiAoIWluZm8uYXBwSWQgfHwgIUFwcENhY2hlLmdldChpbmZvLmFwcElkKSkge1xuICAgIC8vIFNlZSBpZiB3ZSBjYW4gZmluZCB0aGUgYXBwIGlkIG9uIHRoZSBib2R5LlxuICAgIGlmIChyZXEuYm9keSBpbnN0YW5jZW9mIEJ1ZmZlcikge1xuICAgICAgLy8gVGhlIG9ubHkgY2hhbmNlIHRvIGZpbmQgdGhlIGFwcCBpZCBpcyBpZiB0aGlzIGlzIGEgZmlsZVxuICAgICAgLy8gdXBsb2FkIHRoYXQgYWN0dWFsbHkgaXMgYSBKU09OIGJvZHkuIFNvIHRyeSB0byBwYXJzZSBpdC5cbiAgICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9wYXJzZS1jb21tdW5pdHkvcGFyc2Utc2VydmVyL2lzc3Vlcy82NTg5XG4gICAgICAvLyBJdCBpcyBhbHNvIHBvc3NpYmxlIHRoYXQgdGhlIGNsaWVudCBpcyB0cnlpbmcgdG8gdXBsb2FkIGEgZmlsZSBidXQgZm9yZ290XG4gICAgICAvLyB0byBwcm92aWRlIHgtcGFyc2UtYXBwLWlkIGluIGhlYWRlciBhbmQgcGFyc2UgYSBiaW5hcnkgZmlsZSB3aWxsIGZhaWxcbiAgICAgIHRyeSB7XG4gICAgICAgIHJlcS5ib2R5ID0gSlNPTi5wYXJzZShyZXEuYm9keSk7XG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIHJldHVybiBpbnZhbGlkUmVxdWVzdChyZXEsIHJlcyk7XG4gICAgICB9XG4gICAgICBmaWxlVmlhSlNPTiA9IHRydWU7XG4gICAgfVxuXG4gICAgaWYgKHJlcS5ib2R5KSB7XG4gICAgICBkZWxldGUgcmVxLmJvZHkuX1Jldm9jYWJsZVNlc3Npb247XG4gICAgfVxuXG4gICAgaWYgKFxuICAgICAgcmVxLmJvZHkgJiZcbiAgICAgIHJlcS5ib2R5Ll9BcHBsaWNhdGlvbklkICYmXG4gICAgICBBcHBDYWNoZS5nZXQocmVxLmJvZHkuX0FwcGxpY2F0aW9uSWQpICYmXG4gICAgICAoIWluZm8ubWFzdGVyS2V5IHx8IEFwcENhY2hlLmdldChyZXEuYm9keS5fQXBwbGljYXRpb25JZCkubWFzdGVyS2V5ID09PSBpbmZvLm1hc3RlcktleSlcbiAgICApIHtcbiAgICAgIGluZm8uYXBwSWQgPSByZXEuYm9keS5fQXBwbGljYXRpb25JZDtcbiAgICAgIGluZm8uamF2YXNjcmlwdEtleSA9IHJlcS5ib2R5Ll9KYXZhU2NyaXB0S2V5IHx8ICcnO1xuICAgICAgZGVsZXRlIHJlcS5ib2R5Ll9BcHBsaWNhdGlvbklkO1xuICAgICAgZGVsZXRlIHJlcS5ib2R5Ll9KYXZhU2NyaXB0S2V5O1xuICAgICAgLy8gVE9ETzogdGVzdCB0aGF0IHRoZSBSRVNUIEFQSSBmb3JtYXRzIGdlbmVyYXRlZCBieSB0aGUgb3RoZXJcbiAgICAgIC8vIFNES3MgYXJlIGhhbmRsZWQgb2tcbiAgICAgIGlmIChyZXEuYm9keS5fQ2xpZW50VmVyc2lvbikge1xuICAgICAgICBpbmZvLmNsaWVudFZlcnNpb24gPSByZXEuYm9keS5fQ2xpZW50VmVyc2lvbjtcbiAgICAgICAgZGVsZXRlIHJlcS5ib2R5Ll9DbGllbnRWZXJzaW9uO1xuICAgICAgfVxuICAgICAgaWYgKHJlcS5ib2R5Ll9JbnN0YWxsYXRpb25JZCkge1xuICAgICAgICBpbmZvLmluc3RhbGxhdGlvbklkID0gcmVxLmJvZHkuX0luc3RhbGxhdGlvbklkO1xuICAgICAgICBkZWxldGUgcmVxLmJvZHkuX0luc3RhbGxhdGlvbklkO1xuICAgICAgfVxuICAgICAgaWYgKHJlcS5ib2R5Ll9TZXNzaW9uVG9rZW4pIHtcbiAgICAgICAgaW5mby5zZXNzaW9uVG9rZW4gPSByZXEuYm9keS5fU2Vzc2lvblRva2VuO1xuICAgICAgICBkZWxldGUgcmVxLmJvZHkuX1Nlc3Npb25Ub2tlbjtcbiAgICAgIH1cbiAgICAgIGlmIChyZXEuYm9keS5fTWFzdGVyS2V5KSB7XG4gICAgICAgIGluZm8ubWFzdGVyS2V5ID0gcmVxLmJvZHkuX01hc3RlcktleTtcbiAgICAgICAgZGVsZXRlIHJlcS5ib2R5Ll9NYXN0ZXJLZXk7XG4gICAgICB9XG4gICAgICBpZiAocmVxLmJvZHkuX2NvbnRleHQpIHtcbiAgICAgICAgaWYgKHJlcS5ib2R5Ll9jb250ZXh0IGluc3RhbmNlb2YgT2JqZWN0KSB7XG4gICAgICAgICAgaW5mby5jb250ZXh0ID0gcmVxLmJvZHkuX2NvbnRleHQ7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGluZm8uY29udGV4dCA9IEpTT04ucGFyc2UocmVxLmJvZHkuX2NvbnRleHQpO1xuICAgICAgICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChpbmZvLmNvbnRleHQpICE9PSAnW29iamVjdCBPYmplY3RdJykge1xuICAgICAgICAgICAgICB0aHJvdyAnQ29udGV4dCBpcyBub3QgYW4gb2JqZWN0JztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICByZXR1cm4gbWFsZm9ybWVkQ29udGV4dChyZXEsIHJlcyk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGRlbGV0ZSByZXEuYm9keS5fY29udGV4dDtcbiAgICAgIH1cbiAgICAgIGlmIChyZXEuYm9keS5fQ29udGVudFR5cGUpIHtcbiAgICAgICAgcmVxLmhlYWRlcnNbJ2NvbnRlbnQtdHlwZSddID0gcmVxLmJvZHkuX0NvbnRlbnRUeXBlO1xuICAgICAgICBkZWxldGUgcmVxLmJvZHkuX0NvbnRlbnRUeXBlO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gaW52YWxpZFJlcXVlc3QocmVxLCByZXMpO1xuICAgIH1cbiAgfVxuXG4gIGlmIChpbmZvLnNlc3Npb25Ub2tlbiAmJiB0eXBlb2YgaW5mby5zZXNzaW9uVG9rZW4gIT09ICdzdHJpbmcnKSB7XG4gICAgaW5mby5zZXNzaW9uVG9rZW4gPSBpbmZvLnNlc3Npb25Ub2tlbi50b1N0cmluZygpO1xuICB9XG5cbiAgaWYgKGluZm8uY2xpZW50VmVyc2lvbikge1xuICAgIGluZm8uY2xpZW50U0RLID0gQ2xpZW50U0RLLmZyb21TdHJpbmcoaW5mby5jbGllbnRWZXJzaW9uKTtcbiAgfVxuXG4gIGlmIChmaWxlVmlhSlNPTikge1xuICAgIHJlcS5maWxlRGF0YSA9IHJlcS5ib2R5LmZpbGVEYXRhO1xuICAgIC8vIFdlIG5lZWQgdG8gcmVwb3B1bGF0ZSByZXEuYm9keSB3aXRoIGEgYnVmZmVyXG4gICAgdmFyIGJhc2U2NCA9IHJlcS5ib2R5LmJhc2U2NDtcbiAgICByZXEuYm9keSA9IEJ1ZmZlci5mcm9tKGJhc2U2NCwgJ2Jhc2U2NCcpO1xuICB9XG5cbiAgY29uc3QgY2xpZW50SXAgPSBnZXRDbGllbnRJcChyZXEpO1xuXG4gIGluZm8uYXBwID0gQXBwQ2FjaGUuZ2V0KGluZm8uYXBwSWQpO1xuICByZXEuY29uZmlnID0gQ29uZmlnLmdldChpbmZvLmFwcElkLCBtb3VudCk7XG4gIHJlcS5jb25maWcuaGVhZGVycyA9IHJlcS5oZWFkZXJzIHx8IHt9O1xuICByZXEuY29uZmlnLmlwID0gY2xpZW50SXA7XG4gIHJlcS5pbmZvID0gaW5mbztcblxuICBpZiAoXG4gICAgaW5mby5tYXN0ZXJLZXkgJiZcbiAgICByZXEuY29uZmlnLm1hc3RlcktleUlwcyAmJlxuICAgIHJlcS5jb25maWcubWFzdGVyS2V5SXBzLmxlbmd0aCAhPT0gMCAmJlxuICAgIHJlcS5jb25maWcubWFzdGVyS2V5SXBzLmluZGV4T2YoY2xpZW50SXApID09PSAtMVxuICApIHtcbiAgICByZXR1cm4gaW52YWxpZFJlcXVlc3QocmVxLCByZXMpO1xuICB9XG5cbiAgdmFyIGlzTWFzdGVyID0gaW5mby5tYXN0ZXJLZXkgPT09IHJlcS5jb25maWcubWFzdGVyS2V5O1xuXG4gIGlmIChpc01hc3Rlcikge1xuICAgIHJlcS5hdXRoID0gbmV3IGF1dGguQXV0aCh7XG4gICAgICBjb25maWc6IHJlcS5jb25maWcsXG4gICAgICBpbnN0YWxsYXRpb25JZDogaW5mby5pbnN0YWxsYXRpb25JZCxcbiAgICAgIGlzTWFzdGVyOiB0cnVlLFxuICAgIH0pO1xuICAgIG5leHQoKTtcbiAgICByZXR1cm47XG4gIH1cblxuICB2YXIgaXNSZWFkT25seU1hc3RlciA9IGluZm8ubWFzdGVyS2V5ID09PSByZXEuY29uZmlnLnJlYWRPbmx5TWFzdGVyS2V5O1xuICBpZiAoXG4gICAgdHlwZW9mIHJlcS5jb25maWcucmVhZE9ubHlNYXN0ZXJLZXkgIT0gJ3VuZGVmaW5lZCcgJiZcbiAgICByZXEuY29uZmlnLnJlYWRPbmx5TWFzdGVyS2V5ICYmXG4gICAgaXNSZWFkT25seU1hc3RlclxuICApIHtcbiAgICByZXEuYXV0aCA9IG5ldyBhdXRoLkF1dGgoe1xuICAgICAgY29uZmlnOiByZXEuY29uZmlnLFxuICAgICAgaW5zdGFsbGF0aW9uSWQ6IGluZm8uaW5zdGFsbGF0aW9uSWQsXG4gICAgICBpc01hc3RlcjogdHJ1ZSxcbiAgICAgIGlzUmVhZE9ubHk6IHRydWUsXG4gICAgfSk7XG4gICAgbmV4dCgpO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIC8vIENsaWVudCBrZXlzIGFyZSBub3QgcmVxdWlyZWQgaW4gcGFyc2Utc2VydmVyLCBidXQgaWYgYW55IGhhdmUgYmVlbiBjb25maWd1cmVkIGluIHRoZSBzZXJ2ZXIsIHZhbGlkYXRlIHRoZW1cbiAgLy8gIHRvIHByZXNlcnZlIG9yaWdpbmFsIGJlaGF2aW9yLlxuICBjb25zdCBrZXlzID0gWydjbGllbnRLZXknLCAnamF2YXNjcmlwdEtleScsICdkb3ROZXRLZXknLCAncmVzdEFQSUtleSddO1xuICBjb25zdCBvbmVLZXlDb25maWd1cmVkID0ga2V5cy5zb21lKGZ1bmN0aW9uIChrZXkpIHtcbiAgICByZXR1cm4gcmVxLmNvbmZpZ1trZXldICE9PSB1bmRlZmluZWQ7XG4gIH0pO1xuICBjb25zdCBvbmVLZXlNYXRjaGVzID0ga2V5cy5zb21lKGZ1bmN0aW9uIChrZXkpIHtcbiAgICByZXR1cm4gcmVxLmNvbmZpZ1trZXldICE9PSB1bmRlZmluZWQgJiYgaW5mb1trZXldID09PSByZXEuY29uZmlnW2tleV07XG4gIH0pO1xuXG4gIGlmIChvbmVLZXlDb25maWd1cmVkICYmICFvbmVLZXlNYXRjaGVzKSB7XG4gICAgcmV0dXJuIGludmFsaWRSZXF1ZXN0KHJlcSwgcmVzKTtcbiAgfVxuXG4gIGlmIChyZXEudXJsID09ICcvbG9naW4nKSB7XG4gICAgZGVsZXRlIGluZm8uc2Vzc2lvblRva2VuO1xuICB9XG5cbiAgaWYgKHJlcS51c2VyRnJvbUpXVCkge1xuICAgIHJlcS5hdXRoID0gbmV3IGF1dGguQXV0aCh7XG4gICAgICBjb25maWc6IHJlcS5jb25maWcsXG4gICAgICBpbnN0YWxsYXRpb25JZDogaW5mby5pbnN0YWxsYXRpb25JZCxcbiAgICAgIGlzTWFzdGVyOiBmYWxzZSxcbiAgICAgIHVzZXI6IHJlcS51c2VyRnJvbUpXVCxcbiAgICB9KTtcbiAgICBuZXh0KCk7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgaWYgKCFpbmZvLnNlc3Npb25Ub2tlbikge1xuICAgIHJlcS5hdXRoID0gbmV3IGF1dGguQXV0aCh7XG4gICAgICBjb25maWc6IHJlcS5jb25maWcsXG4gICAgICBpbnN0YWxsYXRpb25JZDogaW5mby5pbnN0YWxsYXRpb25JZCxcbiAgICAgIGlzTWFzdGVyOiBmYWxzZSxcbiAgICB9KTtcbiAgICBuZXh0KCk7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpXG4gICAgLnRoZW4oKCkgPT4ge1xuICAgICAgLy8gaGFuZGxlIHRoZSB1cGdyYWRlVG9SZXZvY2FibGVTZXNzaW9uIHBhdGggb24gaXQncyBvd25cbiAgICAgIGlmIChcbiAgICAgICAgaW5mby5zZXNzaW9uVG9rZW4gJiZcbiAgICAgICAgcmVxLnVybCA9PT0gJy91cGdyYWRlVG9SZXZvY2FibGVTZXNzaW9uJyAmJlxuICAgICAgICBpbmZvLnNlc3Npb25Ub2tlbi5pbmRleE9mKCdyOicpICE9IDBcbiAgICAgICkge1xuICAgICAgICByZXR1cm4gYXV0aC5nZXRBdXRoRm9yTGVnYWN5U2Vzc2lvblRva2VuKHtcbiAgICAgICAgICBjb25maWc6IHJlcS5jb25maWcsXG4gICAgICAgICAgaW5zdGFsbGF0aW9uSWQ6IGluZm8uaW5zdGFsbGF0aW9uSWQsXG4gICAgICAgICAgc2Vzc2lvblRva2VuOiBpbmZvLnNlc3Npb25Ub2tlbixcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gYXV0aC5nZXRBdXRoRm9yU2Vzc2lvblRva2VuKHtcbiAgICAgICAgICBjb25maWc6IHJlcS5jb25maWcsXG4gICAgICAgICAgaW5zdGFsbGF0aW9uSWQ6IGluZm8uaW5zdGFsbGF0aW9uSWQsXG4gICAgICAgICAgc2Vzc2lvblRva2VuOiBpbmZvLnNlc3Npb25Ub2tlbixcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSlcbiAgICAudGhlbihhdXRoID0+IHtcbiAgICAgIGlmIChhdXRoKSB7XG4gICAgICAgIHJlcS5hdXRoID0gYXV0aDtcbiAgICAgICAgbmV4dCgpO1xuICAgICAgfVxuICAgIH0pXG4gICAgLmNhdGNoKGVycm9yID0+IHtcbiAgICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIFBhcnNlLkVycm9yKSB7XG4gICAgICAgIG5leHQoZXJyb3IpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBUT0RPOiBEZXRlcm1pbmUgdGhlIGNvcnJlY3QgZXJyb3Igc2NlbmFyaW8uXG4gICAgICAgIHJlcS5jb25maWcubG9nZ2VyQ29udHJvbGxlci5lcnJvcignZXJyb3IgZ2V0dGluZyBhdXRoIGZvciBzZXNzaW9uVG9rZW4nLCBlcnJvcik7XG4gICAgICAgIHRocm93IG5ldyBQYXJzZS5FcnJvcihQYXJzZS5FcnJvci5VTktOT1dOX0VSUk9SLCBlcnJvcik7XG4gICAgICB9XG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIGdldENsaWVudElwKHJlcSkge1xuICBpZiAocmVxLmhlYWRlcnNbJ3gtZm9yd2FyZGVkLWZvciddKSB7XG4gICAgLy8gdHJ5IHRvIGdldCBmcm9tIHgtZm9yd2FyZWQtZm9yIGlmIGl0IHNldCAoYmVoaW5kIHJldmVyc2UgcHJveHkpXG4gICAgcmV0dXJuIHJlcS5oZWFkZXJzWyd4LWZvcndhcmRlZC1mb3InXS5zcGxpdCgnLCcpWzBdO1xuICB9IGVsc2UgaWYgKHJlcS5jb25uZWN0aW9uICYmIHJlcS5jb25uZWN0aW9uLnJlbW90ZUFkZHJlc3MpIHtcbiAgICAvLyBubyBwcm94eSwgdHJ5IGdldHRpbmcgZnJvbSBjb25uZWN0aW9uLnJlbW90ZUFkZHJlc3NcbiAgICByZXR1cm4gcmVxLmNvbm5lY3Rpb24ucmVtb3RlQWRkcmVzcztcbiAgfSBlbHNlIGlmIChyZXEuc29ja2V0KSB7XG4gICAgLy8gdHJ5IHRvIGdldCBpdCBmcm9tIHJlcS5zb2NrZXRcbiAgICByZXR1cm4gcmVxLnNvY2tldC5yZW1vdGVBZGRyZXNzO1xuICB9IGVsc2UgaWYgKHJlcS5jb25uZWN0aW9uICYmIHJlcS5jb25uZWN0aW9uLnNvY2tldCkge1xuICAgIC8vIHRyeSB0byBnZXQgaXQgZm9ybSB0aGUgY29ubmVjdGlvbi5zb2NrZXRcbiAgICByZXR1cm4gcmVxLmNvbm5lY3Rpb24uc29ja2V0LnJlbW90ZUFkZHJlc3M7XG4gIH0gZWxzZSB7XG4gICAgLy8gaWYgbm9uIGFib3ZlLCBmYWxsYmFjay5cbiAgICByZXR1cm4gcmVxLmlwO1xuICB9XG59XG5cbmZ1bmN0aW9uIGh0dHBBdXRoKHJlcSkge1xuICBpZiAoIShyZXEucmVxIHx8IHJlcSkuaGVhZGVycy5hdXRob3JpemF0aW9uKSByZXR1cm47XG5cbiAgdmFyIGhlYWRlciA9IChyZXEucmVxIHx8IHJlcSkuaGVhZGVycy5hdXRob3JpemF0aW9uO1xuICB2YXIgYXBwSWQsIG1hc3RlcktleSwgamF2YXNjcmlwdEtleTtcblxuICAvLyBwYXJzZSBoZWFkZXJcbiAgdmFyIGF1dGhQcmVmaXggPSAnYmFzaWMgJztcblxuICB2YXIgbWF0Y2ggPSBoZWFkZXIudG9Mb3dlckNhc2UoKS5pbmRleE9mKGF1dGhQcmVmaXgpO1xuXG4gIGlmIChtYXRjaCA9PSAwKSB7XG4gICAgdmFyIGVuY29kZWRBdXRoID0gaGVhZGVyLnN1YnN0cmluZyhhdXRoUHJlZml4Lmxlbmd0aCwgaGVhZGVyLmxlbmd0aCk7XG4gICAgdmFyIGNyZWRlbnRpYWxzID0gZGVjb2RlQmFzZTY0KGVuY29kZWRBdXRoKS5zcGxpdCgnOicpO1xuXG4gICAgaWYgKGNyZWRlbnRpYWxzLmxlbmd0aCA9PSAyKSB7XG4gICAgICBhcHBJZCA9IGNyZWRlbnRpYWxzWzBdO1xuICAgICAgdmFyIGtleSA9IGNyZWRlbnRpYWxzWzFdO1xuXG4gICAgICB2YXIganNLZXlQcmVmaXggPSAnamF2YXNjcmlwdC1rZXk9JztcblxuICAgICAgdmFyIG1hdGNoS2V5ID0ga2V5LmluZGV4T2YoanNLZXlQcmVmaXgpO1xuICAgICAgaWYgKG1hdGNoS2V5ID09IDApIHtcbiAgICAgICAgamF2YXNjcmlwdEtleSA9IGtleS5zdWJzdHJpbmcoanNLZXlQcmVmaXgubGVuZ3RoLCBrZXkubGVuZ3RoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG1hc3RlcktleSA9IGtleTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICByZXR1cm4geyBhcHBJZDogYXBwSWQsIG1hc3RlcktleTogbWFzdGVyS2V5LCBqYXZhc2NyaXB0S2V5OiBqYXZhc2NyaXB0S2V5IH07XG59XG5cbmZ1bmN0aW9uIGRlY29kZUJhc2U2NChzdHIpIHtcbiAgcmV0dXJuIEJ1ZmZlci5mcm9tKHN0ciwgJ2Jhc2U2NCcpLnRvU3RyaW5nKCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBhbGxvd0Nyb3NzRG9tYWluKGFwcElkKSB7XG4gIHJldHVybiAocmVxLCByZXMsIG5leHQpID0+IHtcbiAgICBjb25zdCBjb25maWcgPSBDb25maWcuZ2V0KGFwcElkLCBnZXRNb3VudEZvclJlcXVlc3QocmVxKSk7XG4gICAgbGV0IGFsbG93SGVhZGVycyA9IERFRkFVTFRfQUxMT1dFRF9IRUFERVJTO1xuICAgIGlmIChjb25maWcgJiYgY29uZmlnLmFsbG93SGVhZGVycykge1xuICAgICAgYWxsb3dIZWFkZXJzICs9IGAsICR7Y29uZmlnLmFsbG93SGVhZGVycy5qb2luKCcsICcpfWA7XG4gICAgfVxuICAgIGNvbnN0IGFsbG93T3JpZ2luID0gKGNvbmZpZyAmJiBjb25maWcuYWxsb3dPcmlnaW4pIHx8ICcqJztcbiAgICByZXMuaGVhZGVyKCdBY2Nlc3MtQ29udHJvbC1BbGxvdy1PcmlnaW4nLCBhbGxvd09yaWdpbik7XG4gICAgcmVzLmhlYWRlcignQWNjZXNzLUNvbnRyb2wtQWxsb3ctTWV0aG9kcycsICdHRVQsUFVULFBPU1QsREVMRVRFLE9QVElPTlMnKTtcbiAgICByZXMuaGVhZGVyKCdBY2Nlc3MtQ29udHJvbC1BbGxvdy1IZWFkZXJzJywgYWxsb3dIZWFkZXJzKTtcbiAgICByZXMuaGVhZGVyKCdBY2Nlc3MtQ29udHJvbC1FeHBvc2UtSGVhZGVycycsICdYLVBhcnNlLUpvYi1TdGF0dXMtSWQsIFgtUGFyc2UtUHVzaC1TdGF0dXMtSWQnKTtcbiAgICAvLyBpbnRlcmNlcHQgT1BUSU9OUyBtZXRob2RcbiAgICBpZiAoJ09QVElPTlMnID09IHJlcS5tZXRob2QpIHtcbiAgICAgIHJlcy5zZW5kU3RhdHVzKDIwMCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIG5leHQoKTtcbiAgICB9XG4gIH07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBhbGxvd01ldGhvZE92ZXJyaWRlKHJlcSwgcmVzLCBuZXh0KSB7XG4gIGlmIChyZXEubWV0aG9kID09PSAnUE9TVCcgJiYgcmVxLmJvZHkuX21ldGhvZCkge1xuICAgIHJlcS5vcmlnaW5hbE1ldGhvZCA9IHJlcS5tZXRob2Q7XG4gICAgcmVxLm1ldGhvZCA9IHJlcS5ib2R5Ll9tZXRob2Q7XG4gICAgZGVsZXRlIHJlcS5ib2R5Ll9tZXRob2Q7XG4gIH1cbiAgbmV4dCgpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaGFuZGxlUGFyc2VFcnJvcnMoZXJyLCByZXEsIHJlcywgbmV4dCkge1xuICBjb25zdCBsb2cgPSAocmVxLmNvbmZpZyAmJiByZXEuY29uZmlnLmxvZ2dlckNvbnRyb2xsZXIpIHx8IGRlZmF1bHRMb2dnZXI7XG4gIGlmIChlcnIgaW5zdGFuY2VvZiBQYXJzZS5FcnJvcikge1xuICAgIGlmIChyZXEuY29uZmlnICYmIHJlcS5jb25maWcuZW5hYmxlRXhwcmVzc0Vycm9ySGFuZGxlcikge1xuICAgICAgcmV0dXJuIG5leHQoZXJyKTtcbiAgICB9XG4gICAgbGV0IGh0dHBTdGF0dXM7XG4gICAgLy8gVE9ETzogZmlsbCBvdXQgdGhpcyBtYXBwaW5nXG4gICAgc3dpdGNoIChlcnIuY29kZSkge1xuICAgICAgY2FzZSBQYXJzZS5FcnJvci5JTlRFUk5BTF9TRVJWRVJfRVJST1I6XG4gICAgICAgIGh0dHBTdGF0dXMgPSA1MDA7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBQYXJzZS5FcnJvci5PQkpFQ1RfTk9UX0ZPVU5EOlxuICAgICAgICBodHRwU3RhdHVzID0gNDA0O1xuICAgICAgICBicmVhaztcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIGh0dHBTdGF0dXMgPSA0MDA7XG4gICAgfVxuICAgIHJlcy5zdGF0dXMoaHR0cFN0YXR1cyk7XG4gICAgcmVzLmpzb24oeyBjb2RlOiBlcnIuY29kZSwgZXJyb3I6IGVyci5tZXNzYWdlIH0pO1xuICAgIGxvZy5lcnJvcignUGFyc2UgZXJyb3I6ICcsIGVycik7XG4gIH0gZWxzZSBpZiAoZXJyLnN0YXR1cyAmJiBlcnIubWVzc2FnZSkge1xuICAgIHJlcy5zdGF0dXMoZXJyLnN0YXR1cyk7XG4gICAgcmVzLmpzb24oeyBlcnJvcjogZXJyLm1lc3NhZ2UgfSk7XG4gICAgaWYgKCEocHJvY2VzcyAmJiBwcm9jZXNzLmVudi5URVNUSU5HKSkge1xuICAgICAgbmV4dChlcnIpO1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICBsb2cuZXJyb3IoJ1VuY2F1Z2h0IGludGVybmFsIHNlcnZlciBlcnJvci4nLCBlcnIsIGVyci5zdGFjayk7XG4gICAgcmVzLnN0YXR1cyg1MDApO1xuICAgIHJlcy5qc29uKHtcbiAgICAgIGNvZGU6IFBhcnNlLkVycm9yLklOVEVSTkFMX1NFUlZFUl9FUlJPUixcbiAgICAgIG1lc3NhZ2U6ICdJbnRlcm5hbCBzZXJ2ZXIgZXJyb3IuJyxcbiAgICB9KTtcbiAgICBpZiAoIShwcm9jZXNzICYmIHByb2Nlc3MuZW52LlRFU1RJTkcpKSB7XG4gICAgICBuZXh0KGVycik7XG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBlbmZvcmNlTWFzdGVyS2V5QWNjZXNzKHJlcSwgcmVzLCBuZXh0KSB7XG4gIGlmICghcmVxLmF1dGguaXNNYXN0ZXIpIHtcbiAgICByZXMuc3RhdHVzKDQwMyk7XG4gICAgcmVzLmVuZCgne1wiZXJyb3JcIjpcInVuYXV0aG9yaXplZDogbWFzdGVyIGtleSBpcyByZXF1aXJlZFwifScpO1xuICAgIHJldHVybjtcbiAgfVxuICBuZXh0KCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBwcm9taXNlRW5mb3JjZU1hc3RlcktleUFjY2VzcyhyZXF1ZXN0KSB7XG4gIGlmICghcmVxdWVzdC5hdXRoLmlzTWFzdGVyKSB7XG4gICAgY29uc3QgZXJyb3IgPSBuZXcgRXJyb3IoKTtcbiAgICBlcnJvci5zdGF0dXMgPSA0MDM7XG4gICAgZXJyb3IubWVzc2FnZSA9ICd1bmF1dGhvcml6ZWQ6IG1hc3RlciBrZXkgaXMgcmVxdWlyZWQnO1xuICAgIHRocm93IGVycm9yO1xuICB9XG4gIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcbn1cblxuLyoqXG4gKiBEZWR1cGxpY2F0ZXMgYSByZXF1ZXN0IHRvIGVuc3VyZSBpZGVtcG90ZW5jeS4gRHVwbGljYXRlcyBhcmUgZGV0ZXJtaW5lZCBieSB0aGUgcmVxdWVzdCBJRFxuICogaW4gdGhlIHJlcXVlc3QgaGVhZGVyLiBJZiBhIHJlcXVlc3QgaGFzIG5vIHJlcXVlc3QgSUQsIGl0IGlzIGV4ZWN1dGVkIGFueXdheS5cbiAqIEBwYXJhbSB7Kn0gcmVxIFRoZSByZXF1ZXN0IHRvIGV2YWx1YXRlLlxuICogQHJldHVybnMgUHJvbWlzZTx7fT5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHByb21pc2VFbnN1cmVJZGVtcG90ZW5jeShyZXEpIHtcbiAgLy8gRW5hYmxlIGZlYXR1cmUgb25seSBmb3IgTW9uZ29EQlxuICBpZiAoIShyZXEuY29uZmlnLmRhdGFiYXNlLmFkYXB0ZXIgaW5zdGFuY2VvZiBNb25nb1N0b3JhZ2VBZGFwdGVyKSkge1xuICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcbiAgfVxuICAvLyBHZXQgcGFyYW1ldGVyc1xuICBjb25zdCBjb25maWcgPSByZXEuY29uZmlnO1xuICBjb25zdCByZXF1ZXN0SWQgPSAoKHJlcSB8fCB7fSkuaGVhZGVycyB8fCB7fSlbJ3gtcGFyc2UtcmVxdWVzdC1pZCddO1xuICBjb25zdCB7IHBhdGhzLCB0dGwgfSA9IGNvbmZpZy5pZGVtcG90ZW5jeU9wdGlvbnM7XG4gIGlmICghcmVxdWVzdElkIHx8ICFjb25maWcuaWRlbXBvdGVuY3lPcHRpb25zKSB7XG4gICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xuICB9XG4gIC8vIFJlcXVlc3QgcGF0aCBtYXkgY29udGFpbiB0cmFpbGluZyBzbGFzaGVzLCBkZXBlbmRpbmcgb24gdGhlIG9yaWdpbmFsIHJlcXVlc3QsIHNvIHJlbW92ZVxuICAvLyBsZWFkaW5nIGFuZCB0cmFpbGluZyBzbGFzaGVzIHRvIG1ha2UgaXQgZWFzaWVyIHRvIHNwZWNpZnkgcGF0aHMgaW4gdGhlIGNvbmZpZ3VyYXRpb25cbiAgY29uc3QgcmVxUGF0aCA9IHJlcS5wYXRoLnJlcGxhY2UoL15cXC98XFwvJC8sICcnKTtcbiAgLy8gRGV0ZXJtaW5lIHdoZXRoZXIgaWRlbXBvdGVuY3kgaXMgZW5hYmxlZCBmb3IgY3VycmVudCByZXF1ZXN0IHBhdGhcbiAgbGV0IG1hdGNoID0gZmFsc2U7XG4gIGZvciAoY29uc3QgcGF0aCBvZiBwYXRocykge1xuICAgIC8vIEFzc3VtZSBvbmUgd2FudHMgYSBwYXRoIHRvIGFsd2F5cyBtYXRjaCBmcm9tIHRoZSBiZWdpbm5pbmcgdG8gcHJldmVudCBhbnkgbWlzdGFrZXNcbiAgICBjb25zdCByZWdleCA9IG5ldyBSZWdFeHAocGF0aC5jaGFyQXQoMCkgPT09ICdeJyA/IHBhdGggOiAnXicgKyBwYXRoKTtcbiAgICBpZiAocmVxUGF0aC5tYXRjaChyZWdleCkpIHtcbiAgICAgIG1hdGNoID0gdHJ1ZTtcbiAgICAgIGJyZWFrO1xuICAgIH1cbiAgfVxuICBpZiAoIW1hdGNoKSB7XG4gICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xuICB9XG4gIC8vIFRyeSB0byBzdG9yZSByZXF1ZXN0XG4gIGNvbnN0IGV4cGlyeURhdGUgPSBuZXcgRGF0ZShuZXcgRGF0ZSgpLnNldFNlY29uZHMobmV3IERhdGUoKS5nZXRTZWNvbmRzKCkgKyB0dGwpKTtcbiAgcmV0dXJuIHJlc3RcbiAgICAuY3JlYXRlKGNvbmZpZywgYXV0aC5tYXN0ZXIoY29uZmlnKSwgJ19JZGVtcG90ZW5jeScsIHtcbiAgICAgIHJlcUlkOiByZXF1ZXN0SWQsXG4gICAgICBleHBpcmU6IFBhcnNlLl9lbmNvZGUoZXhwaXJ5RGF0ZSksXG4gICAgfSlcbiAgICAuY2F0Y2goZSA9PiB7XG4gICAgICBpZiAoZS5jb2RlID09IFBhcnNlLkVycm9yLkRVUExJQ0FURV9WQUxVRSkge1xuICAgICAgICB0aHJvdyBuZXcgUGFyc2UuRXJyb3IoUGFyc2UuRXJyb3IuRFVQTElDQVRFX1JFUVVFU1QsICdEdXBsaWNhdGUgcmVxdWVzdCcpO1xuICAgICAgfVxuICAgICAgdGhyb3cgZTtcbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gaW52YWxpZFJlcXVlc3QocmVxLCByZXMpIHtcbiAgcmVzLnN0YXR1cyg0MDMpO1xuICByZXMuZW5kKCd7XCJlcnJvclwiOlwidW5hdXRob3JpemVkXCJ9Jyk7XG59XG5cbmZ1bmN0aW9uIG1hbGZvcm1lZENvbnRleHQocmVxLCByZXMpIHtcbiAgcmVzLnN0YXR1cyg0MDApO1xuICByZXMuanNvbih7IGNvZGU6IFBhcnNlLkVycm9yLklOVkFMSURfSlNPTiwgZXJyb3I6ICdJbnZhbGlkIG9iamVjdCBmb3IgY29udGV4dC4nIH0pO1xufVxuIl19
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9taWRkbGV3YXJlcy5qcyJdLCJuYW1lcyI6WyJERUZBVUxUX0FMTE9XRURfSEVBREVSUyIsImdldE1vdW50Rm9yUmVxdWVzdCIsIm1vdW50UGF0aExlbmd0aCIsInJlcSIsIm1vdW50UGF0aCIsIm1vdW50IiwiY29udGV4dCIsIkpTT04iLCJPYmplY3QiLCJtYWxmb3JtZWRDb250ZXh0IiwiaW5mbyIsImFwcElkIiwic2Vzc2lvblRva2VuIiwibWFzdGVyS2V5IiwiaW5zdGFsbGF0aW9uSWQiLCJjbGllbnRLZXkiLCJqYXZhc2NyaXB0S2V5IiwiZG90TmV0S2V5IiwicmVzdEFQSUtleSIsImNsaWVudFZlcnNpb24iLCJiYXNpY0F1dGgiLCJodHRwQXV0aCIsImJhc2ljQXV0aEFwcElkIiwiQXBwQ2FjaGUiLCJmaWxlVmlhSlNPTiIsImludmFsaWRSZXF1ZXN0IiwiQ2xpZW50U0RLIiwiYmFzZTY0IiwiQnVmZmVyIiwiY2xpZW50SXAiLCJnZXRDbGllbnRJcCIsIkNvbmZpZyIsImlzTWFzdGVyIiwiYXV0aCIsImNvbmZpZyIsIm5leHQiLCJpc1JlYWRPbmx5TWFzdGVyIiwiaXNSZWFkT25seSIsImtleXMiLCJvbmVLZXlDb25maWd1cmVkIiwib25lS2V5TWF0Y2hlcyIsInVzZXIiLCJ1c2VyRnJvbUpXVCIsImVycm9yIiwiUGFyc2UiLCJoZWFkZXIiLCJhdXRoUHJlZml4IiwibWF0Y2giLCJlbmNvZGVkQXV0aCIsImNyZWRlbnRpYWxzIiwiZGVjb2RlQmFzZTY0Iiwia2V5IiwianNLZXlQcmVmaXgiLCJtYXRjaEtleSIsImFsbG93SGVhZGVycyIsImFsbG93T3JpZ2luIiwicmVzIiwibG9nIiwiZGVmYXVsdExvZ2dlciIsImVyciIsImh0dHBTdGF0dXMiLCJjb2RlIiwibWVzc2FnZSIsInByb2Nlc3MiLCJyZXF1ZXN0IiwiUHJvbWlzZSIsIk1vbmdvU3RvcmFnZUFkYXB0ZXIiLCJyZXF1ZXN0SWQiLCJ0dGwiLCJyZXFQYXRoIiwicmVnZXgiLCJw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LEVBQ0QsQ0FFRCxRQUFBLENBQUEsZ0JBQUEsQ0FBQSxHQUFBLENBQUEsR0FBQSxDQUFvQyxvREFDbENBLEdBQUcsQ0FBSEEsTUFBQUEsQ0FBQUEsR0FBQUEsRUFEa0MsMEJBRWxDQSxHQUFHLENBQUhBLElBQUFBLENBQVMsQ0FBRUssSUFBSSxDQUFFakIsS0FBQUEsQ0FBQUEsT0FBQUEsQ0FBQUEsS0FBQUEsQ0FBUixZQUFBLENBQWtDRCxLQUFLLENBQUUsNkJBQXpDLENBQVRhLEVBQ0QsQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBBcHBDYWNoZSBmcm9tICcuL2NhY2hlJztcbmltcG9ydCBQYXJzZSBmcm9tICdwYXJzZS9ub2RlJztcbmltcG9ydCBhdXRoIGZyb20gJy4vQXV0aCc7XG5pbXBvcnQgQ29uZmlnIGZyb20gJy4vQ29uZmlnJztcbmltcG9ydCBDbGllbnRTREsgZnJvbSAnLi9DbGllbnRTREsnO1xuaW1wb3J0IGRlZmF1bHRMb2dnZXIgZnJvbSAnLi9sb2dnZXInO1xuaW1wb3J0IHJlc3QgZnJvbSAnLi9yZXN0JztcbmltcG9ydCBNb25nb1N0b3JhZ2VBZGFwdGVyIGZyb20gJy4vQWRhcHRlcnMvU3RvcmFnZS9Nb25nby9Nb25nb1N0b3JhZ2VBZGFwdGVyJztcblxuZXhwb3J0IGNvbnN0IERFRkFVTFRfQUxMT1dFRF9IRUFERVJTID1cbiAgJ1gtUGFyc2UtTWFzdGVyLUtleSwgWC1QYXJzZS1SRVNULUFQSS1LZXksIFgtUGFyc2UtSmF2YXNjcmlwdC1LZXksIFgtUGFyc2UtQXBwbGljYXRpb24tSWQsIFgtUGFyc2UtQ2xpZW50LVZlcnNpb24sIFgtUGFyc2UtU2Vzc2lvbi1Ub2tlbiwgWC1SZXF1ZXN0ZWQtV2l0aCwgWC1QYXJzZS1SZXZvY2FibGUtU2Vzc2lvbiwgWC1QYXJzZS1SZXF1ZXN0LUlkLCBDb250ZW50LVR5cGUsIFByYWdtYSwgQ2FjaGUtQ29udHJvbCc7XG5cbmNvbnN0IGdldE1vdW50Rm9yUmVxdWVzdCA9IGZ1bmN0aW9uIChyZXEpIHtcbiAgY29uc3QgbW91bnRQYXRoTGVuZ3RoID0gcmVxLm9yaWdpbmFsVXJsLmxlbmd0aCAtIHJlcS51cmwubGVuZ3RoO1xuICBjb25zdCBtb3VudFBhdGggPSByZXEub3JpZ2luYWxVcmwuc2xpY2UoMCwgbW91bnRQYXRoTGVuZ3RoKTtcbiAgcmV0dXJuIHJlcS5wcm90b2NvbCArICc6Ly8nICsgcmVxLmdldCgnaG9zdCcpICsgbW91bnRQYXRoO1xufTtcblxuLy8gQ2hlY2tzIHRoYXQgdGhlIHJlcXVlc3QgaXMgYXV0aG9yaXplZCBmb3IgdGhpcyBhcHAgYW5kIGNoZWNrcyB1c2VyXG4vLyBhdXRoIHRvby5cbi8vIFRoZSBib2R5cGFyc2VyIHNob3VsZCBydW4gYmVmb3JlIHRoaXMgbWlkZGxld2FyZS5cbi8vIEFkZHMgaW5mbyB0byB0aGUgcmVxdWVzdDpcbi8vIHJlcS5jb25maWcgLSB0aGUgQ29uZmlnIGZvciB0aGlzIGFwcFxuLy8gcmVxLmF1dGggLSB0aGUgQXV0aCBmb3IgdGhpcyByZXF1ZXN0XG5leHBvcnQgZnVuY3Rpb24gaGFuZGxlUGFyc2VIZWFkZXJzKHJlcSwgcmVzLCBuZXh0KSB7XG4gIHZhciBtb3VudCA9IGdldE1vdW50Rm9yUmVxdWVzdChyZXEpO1xuXG4gIGxldCBjb250ZXh0ID0ge307XG4gIGlmIChyZXEuZ2V0KCdYLVBhcnNlLUNsb3VkLUNvbnRleHQnKSAhPSBudWxsKSB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnRleHQgPSBKU09OLnBhcnNlKHJlcS5nZXQoJ1gtUGFyc2UtQ2xvdWQtQ29udGV4dCcpKTtcbiAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoY29udGV4dCkgIT09ICdbb2JqZWN0IE9iamVjdF0nKSB7XG4gICAgICAgIHRocm93ICdDb250ZXh0IGlzIG5vdCBhbiBvYmplY3QnO1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIHJldHVybiBtYWxmb3JtZWRDb250ZXh0KHJlcSwgcmVzKTtcbiAgICB9XG4gIH1cbiAgdmFyIGluZm8gPSB7XG4gICAgYXBwSWQ6IHJlcS5nZXQoJ1gtUGFyc2UtQXBwbGljYXRpb24tSWQnKSxcbiAgICBzZXNzaW9uVG9rZW46IHJlcS5nZXQoJ1gtUGFyc2UtU2Vzc2lvbi1Ub2tlbicpLFxuICAgIG1hc3RlcktleTogcmVxLmdldCgnWC1QYXJzZS1NYXN0ZXItS2V5JyksXG4gICAgaW5zdGFsbGF0aW9uSWQ6IHJlcS5nZXQoJ1gtUGFyc2UtSW5zdGFsbGF0aW9uLUlkJyksXG4gICAgY2xpZW50S2V5OiByZXEuZ2V0KCdYLVBhcnNlLUNsaWVudC1LZXknKSxcbiAgICBqYXZhc2NyaXB0S2V5OiByZXEuZ2V0KCdYLVBhcnNlLUphdmFzY3JpcHQtS2V5JyksXG4gICAgZG90TmV0S2V5OiByZXEuZ2V0KCdYLVBhcnNlLVdpbmRvd3MtS2V5JyksXG4gICAgcmVzdEFQSUtleTogcmVxLmdldCgnWC1QYXJzZS1SRVNULUFQSS1LZXknKSxcbiAgICBjbGllbnRWZXJzaW9uOiByZXEuZ2V0KCdYLVBhcnNlLUNsaWVudC1WZXJzaW9uJyksXG4gICAgY29udGV4dDogY29udGV4dCxcbiAgfTtcblxuICB2YXIgYmFzaWNBdXRoID0gaHR0cEF1dGgocmVxKTtcblxuICBpZiAoYmFzaWNBdXRoKSB7XG4gICAgdmFyIGJhc2ljQXV0aEFwcElkID0gYmFzaWNBdXRoLmFwcElkO1xuICAgIGlmIChBcHBDYWNoZS5nZXQoYmFzaWNBdXRoQXBwSWQpKSB7XG4gICAgICBpbmZvLmFwcElkID0gYmFzaWNBdXRoQXBwSWQ7XG4gICAgICBpbmZvLm1hc3RlcktleSA9IGJhc2ljQXV0aC5tYXN0ZXJLZXkgfHwgaW5mby5tYXN0ZXJLZXk7XG4gICAgICBpbmZvLmphdmFzY3JpcHRLZXkgPSBiYXNpY0F1dGguamF2YXNjcmlwdEtleSB8fCBpbmZvLmphdmFzY3JpcHRLZXk7XG4gICAgfVxuICB9XG5cbiAgaWYgKHJlcS5ib2R5KSB7XG4gICAgLy8gVW5pdHkgU0RLIHNlbmRzIGEgX25vQm9keSBrZXkgd2hpY2ggbmVlZHMgdG8gYmUgcmVtb3ZlZC5cbiAgICAvLyBVbmNsZWFyIGF0IHRoaXMgcG9pbnQgaWYgYWN0aW9uIG5lZWRzIHRvIGJlIHRha2VuLlxuICAgIGRlbGV0ZSByZXEuYm9keS5fbm9Cb2R5O1xuICB9XG5cbiAgdmFyIGZpbGVWaWFKU09OID0gZmFsc2U7XG5cbiAgaWYgKCFpbmZvLmFwcElkIHx8ICFBcHBDYWNoZS5nZXQoaW5mby5hcHBJZCkpIHtcbiAgICAvLyBTZWUgaWYgd2UgY2FuIGZpbmQgdGhlIGFwcCBpZCBvbiB0aGUgYm9keS5cbiAgICBpZiAocmVxLmJvZHkgaW5zdGFuY2VvZiBCdWZmZXIpIHtcbiAgICAgIC8vIFRoZSBvbmx5IGNoYW5jZSB0byBmaW5kIHRoZSBhcHAgaWQgaXMgaWYgdGhpcyBpcyBhIGZpbGVcbiAgICAgIC8vIHVwbG9hZCB0aGF0IGFjdHVhbGx5IGlzIGEgSlNPTiBib2R5LiBTbyB0cnkgdG8gcGFyc2UgaXQuXG4gICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vcGFyc2UtY29tbXVuaXR5L3BhcnNlLXNlcnZlci9pc3N1ZXMvNjU4OVxuICAgICAgLy8gSXQgaXMgYWxzbyBwb3NzaWJsZSB0aGF0IHRoZSBjbGllbnQgaXMgdHJ5aW5nIHRvIHVwbG9hZCBhIGZpbGUgYnV0IGZvcmdvdFxuICAgICAgLy8gdG8gcHJvdmlkZSB4LXBhcnNlLWFwcC1pZCBpbiBoZWFkZXIgYW5kIHBhcnNlIGEgYmluYXJ5IGZpbGUgd2lsbCBmYWlsXG4gICAgICB0cnkge1xuICAgICAgICByZXEuYm9keSA9IEpTT04ucGFyc2UocmVxLmJvZHkpO1xuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICByZXR1cm4gaW52YWxpZFJlcXVlc3QocmVxLCByZXMpO1xuICAgICAgfVxuICAgICAgZmlsZVZpYUpTT04gPSB0cnVlO1xuICAgIH1cblxuICAgIGlmIChyZXEuYm9keSkge1xuICAgICAgZGVsZXRlIHJlcS5ib2R5Ll9SZXZvY2FibGVTZXNzaW9uO1xuICAgIH1cblxuICAgIGlmIChcbiAgICAgIHJlcS5ib2R5ICYmXG4gICAgICByZXEuYm9keS5fQXBwbGljYXRpb25JZCAmJlxuICAgICAgQXBwQ2FjaGUuZ2V0KHJlcS5ib2R5Ll9BcHBsaWNhdGlvbklkKSAmJlxuICAgICAgKCFpbmZvLm1hc3RlcktleSB8fCBBcHBDYWNoZS5nZXQocmVxLmJvZHkuX0FwcGxpY2F0aW9uSWQpLm1hc3RlcktleSA9PT0gaW5mby5tYXN0ZXJLZXkpXG4gICAgKSB7XG4gICAgICBpbmZvLmFwcElkID0gcmVxLmJvZHkuX0FwcGxpY2F0aW9uSWQ7XG4gICAgICBpbmZvLmphdmFzY3JpcHRLZXkgPSByZXEuYm9keS5fSmF2YVNjcmlwdEtleSB8fCAnJztcbiAgICAgIGRlbGV0ZSByZXEuYm9keS5fQXBwbGljYXRpb25JZDtcbiAgICAgIGRlbGV0ZSByZXEuYm9keS5fSmF2YVNjcmlwdEtleTtcbiAgICAgIC8vIFRPRE86IHRlc3QgdGhhdCB0aGUgUkVTVCBBUEkgZm9ybWF0cyBnZW5lcmF0ZWQgYnkgdGhlIG90aGVyXG4gICAgICAvLyBTREtzIGFyZSBoYW5kbGVkIG9rXG4gICAgICBpZiAocmVxLmJvZHkuX0NsaWVudFZlcnNpb24pIHtcbiAgICAgICAgaW5mby5jbGllbnRWZXJzaW9uID0gcmVxLmJvZHkuX0NsaWVudFZlcnNpb247XG4gICAgICAgIGRlbGV0ZSByZXEuYm9keS5fQ2xpZW50VmVyc2lvbjtcbiAgICAgIH1cbiAgICAgIGlmIChyZXEuYm9keS5fSW5zdGFsbGF0aW9uSWQpIHtcbiAgICAgICAgaW5mby5pbnN0YWxsYXRpb25JZCA9IHJlcS5ib2R5Ll9JbnN0YWxsYXRpb25JZDtcbiAgICAgICAgZGVsZXRlIHJlcS5ib2R5Ll9JbnN0YWxsYXRpb25JZDtcbiAgICAgIH1cbiAgICAgIGlmIChyZXEuYm9keS5fU2Vzc2lvblRva2VuKSB7XG4gICAgICAgIGluZm8uc2Vzc2lvblRva2VuID0gcmVxLmJvZHkuX1Nlc3Npb25Ub2tlbjtcbiAgICAgICAgZGVsZXRlIHJlcS5ib2R5Ll9TZXNzaW9uVG9rZW47XG4gICAgICB9XG4gICAgICBpZiAocmVxLmJvZHkuX01hc3RlcktleSkge1xuICAgICAgICBpbmZvLm1hc3RlcktleSA9IHJlcS5ib2R5Ll9NYXN0ZXJLZXk7XG4gICAgICAgIGRlbGV0ZSByZXEuYm9keS5fTWFzdGVyS2V5O1xuICAgICAgfVxuICAgICAgaWYgKHJlcS5ib2R5Ll9jb250ZXh0KSB7XG4gICAgICAgIGlmIChyZXEuYm9keS5fY29udGV4dCBpbnN0YW5jZW9mIE9iamVjdCkge1xuICAgICAgICAgIGluZm8uY29udGV4dCA9IHJlcS5ib2R5Ll9jb250ZXh0O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBpbmZvLmNvbnRleHQgPSBKU09OLnBhcnNlKHJlcS5ib2R5Ll9jb250ZXh0KTtcbiAgICAgICAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoaW5mby5jb250ZXh0KSAhPT0gJ1tvYmplY3QgT2JqZWN0XScpIHtcbiAgICAgICAgICAgICAgdGhyb3cgJ0NvbnRleHQgaXMgbm90IGFuIG9iamVjdCc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgcmV0dXJuIG1hbGZvcm1lZENvbnRleHQocmVxLCByZXMpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBkZWxldGUgcmVxLmJvZHkuX2NvbnRleHQ7XG4gICAgICB9XG4gICAgICBpZiAocmVxLmJvZHkuX0NvbnRlbnRUeXBlKSB7XG4gICAgICAgIHJlcS5oZWFkZXJzWydjb250ZW50LXR5cGUnXSA9IHJlcS5ib2R5Ll9Db250ZW50VHlwZTtcbiAgICAgICAgZGVsZXRlIHJlcS5ib2R5Ll9Db250ZW50VHlwZTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIGludmFsaWRSZXF1ZXN0KHJlcSwgcmVzKTtcbiAgICB9XG4gIH1cblxuICBpZiAoaW5mby5zZXNzaW9uVG9rZW4gJiYgdHlwZW9mIGluZm8uc2Vzc2lvblRva2VuICE9PSAnc3RyaW5nJykge1xuICAgIGluZm8uc2Vzc2lvblRva2VuID0gaW5mby5zZXNzaW9uVG9rZW4udG9TdHJpbmcoKTtcbiAgfVxuXG4gIGlmIChpbmZvLmNsaWVudFZlcnNpb24pIHtcbiAgICBpbmZvLmNsaWVudFNESyA9IENsaWVudFNESy5mcm9tU3RyaW5nKGluZm8uY2xpZW50VmVyc2lvbik7XG4gIH1cblxuICBpZiAoZmlsZVZpYUpTT04pIHtcbiAgICByZXEuZmlsZURhdGEgPSByZXEuYm9keS5maWxlRGF0YTtcbiAgICAvLyBXZSBuZWVkIHRvIHJlcG9wdWxhdGUgcmVxLmJvZHkgd2l0aCBhIGJ1ZmZlclxuICAgIHZhciBiYXNlNjQgPSByZXEuYm9keS5iYXNlNjQ7XG4gICAgcmVxLmJvZHkgPSBCdWZmZXIuZnJvbShiYXNlNjQsICdiYXNlNjQnKTtcbiAgfVxuXG4gIGNvbnN0IGNsaWVudElwID0gZ2V0Q2xpZW50SXAocmVxKTtcblxuICBpbmZvLmFwcCA9IEFwcENhY2hlLmdldChpbmZvLmFwcElkKTtcbiAgcmVxLmNvbmZpZyA9IENvbmZpZy5nZXQoaW5mby5hcHBJZCwgbW91bnQpO1xuICByZXEuY29uZmlnLmhlYWRlcnMgPSByZXEuaGVhZGVycyB8fCB7fTtcbiAgcmVxLmNvbmZpZy5pcCA9IGNsaWVudElwO1xuICByZXEuaW5mbyA9IGluZm87XG5cbiAgaWYgKFxuICAgIGluZm8ubWFzdGVyS2V5ICYmXG4gICAgcmVxLmNvbmZpZy5tYXN0ZXJLZXlJcHMgJiZcbiAgICByZXEuY29uZmlnLm1hc3RlcktleUlwcy5sZW5ndGggIT09IDAgJiZcbiAgICByZXEuY29uZmlnLm1hc3RlcktleUlwcy5pbmRleE9mKGNsaWVudElwKSA9PT0gLTFcbiAgKSB7XG4gICAgcmV0dXJuIGludmFsaWRSZXF1ZXN0KHJlcSwgcmVzKTtcbiAgfVxuXG4gIHZhciBpc01hc3RlciA9IGluZm8ubWFzdGVyS2V5ID09PSByZXEuY29uZmlnLm1hc3RlcktleTtcblxuICBpZiAoaXNNYXN0ZXIpIHtcbiAgICByZXEuYXV0aCA9IG5ldyBhdXRoLkF1dGgoe1xuICAgICAgY29uZmlnOiByZXEuY29uZmlnLFxuICAgICAgaW5zdGFsbGF0aW9uSWQ6IGluZm8uaW5zdGFsbGF0aW9uSWQsXG4gICAgICBpc01hc3RlcjogdHJ1ZSxcbiAgICB9KTtcbiAgICBuZXh0KCk7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgdmFyIGlzUmVhZE9ubHlNYXN0ZXIgPSBpbmZvLm1hc3RlcktleSA9PT0gcmVxLmNvbmZpZy5yZWFkT25seU1hc3RlcktleTtcbiAgaWYgKFxuICAgIHR5cGVvZiByZXEuY29uZmlnLnJlYWRPbmx5TWFzdGVyS2V5ICE9ICd1bmRlZmluZWQnICYmXG4gICAgcmVxLmNvbmZpZy5yZWFkT25seU1hc3RlcktleSAmJlxuICAgIGlzUmVhZE9ubHlNYXN0ZXJcbiAgKSB7XG4gICAgcmVxLmF1dGggPSBuZXcgYXV0aC5BdXRoKHtcbiAgICAgIGNvbmZpZzogcmVxLmNvbmZpZyxcbiAgICAgIGluc3RhbGxhdGlvbklkOiBpbmZvLmluc3RhbGxhdGlvbklkLFxuICAgICAgaXNNYXN0ZXI6IHRydWUsXG4gICAgICBpc1JlYWRPbmx5OiB0cnVlLFxuICAgIH0pO1xuICAgIG5leHQoKTtcbiAgICByZXR1cm47XG4gIH1cblxuICAvLyBDbGllbnQga2V5cyBhcmUgbm90IHJlcXVpcmVkIGluIHBhcnNlLXNlcnZlciwgYnV0IGlmIGFueSBoYXZlIGJlZW4gY29uZmlndXJlZCBpbiB0aGUgc2VydmVyLCB2YWxpZGF0ZSB0aGVtXG4gIC8vICB0byBwcmVzZXJ2ZSBvcmlnaW5hbCBiZWhhdmlvci5cbiAgY29uc3Qga2V5cyA9IFsnY2xpZW50S2V5JywgJ2phdmFzY3JpcHRLZXknLCAnZG90TmV0S2V5JywgJ3Jlc3RBUElLZXknXTtcbiAgY29uc3Qgb25lS2V5Q29uZmlndXJlZCA9IGtleXMuc29tZShmdW5jdGlvbiAoa2V5KSB7XG4gICAgcmV0dXJuIHJlcS5jb25maWdba2V5XSAhPT0gdW5kZWZpbmVkO1xuICB9KTtcbiAgY29uc3Qgb25lS2V5TWF0Y2hlcyA9IGtleXMuc29tZShmdW5jdGlvbiAoa2V5KSB7XG4gICAgcmV0dXJuIHJlcS5jb25maWdba2V5XSAhPT0gdW5kZWZpbmVkICYmIGluZm9ba2V5XSA9PT0gcmVxLmNvbmZpZ1trZXldO1xuICB9KTtcblxuICBpZiAob25lS2V5Q29uZmlndXJlZCAmJiAhb25lS2V5TWF0Y2hlcykge1xuICAgIHJldHVybiBpbnZhbGlkUmVxdWVzdChyZXEsIHJlcyk7XG4gIH1cblxuICBpZiAocmVxLnVybCA9PSAnL2xvZ2luJykge1xuICAgIGRlbGV0ZSBpbmZvLnNlc3Npb25Ub2tlbjtcbiAgfVxuXG4gIGlmIChyZXEudXNlckZyb21KV1QpIHtcbiAgICByZXEuYXV0aCA9IG5ldyBhdXRoLkF1dGgoe1xuICAgICAgY29uZmlnOiByZXEuY29uZmlnLFxuICAgICAgaW5zdGFsbGF0aW9uSWQ6IGluZm8uaW5zdGFsbGF0aW9uSWQsXG4gICAgICBpc01hc3RlcjogZmFsc2UsXG4gICAgICB1c2VyOiByZXEudXNlckZyb21KV1QsXG4gICAgfSk7XG4gICAgbmV4dCgpO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGlmICghaW5mby5zZXNzaW9uVG9rZW4pIHtcbiAgICByZXEuYXV0aCA9IG5ldyBhdXRoLkF1dGgoe1xuICAgICAgY29uZmlnOiByZXEuY29uZmlnLFxuICAgICAgaW5zdGFsbGF0aW9uSWQ6IGluZm8uaW5zdGFsbGF0aW9uSWQsXG4gICAgICBpc01hc3RlcjogZmFsc2UsXG4gICAgfSk7XG4gICAgbmV4dCgpO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHJldHVybiBQcm9taXNlLnJlc29sdmUoKVxuICAgIC50aGVuKCgpID0+IHtcbiAgICAgIC8vIGhhbmRsZSB0aGUgdXBncmFkZVRvUmV2b2NhYmxlU2Vzc2lvbiBwYXRoIG9uIGl0J3Mgb3duXG4gICAgICBpZiAoXG4gICAgICAgIGluZm8uc2Vzc2lvblRva2VuICYmXG4gICAgICAgIHJlcS51cmwgPT09ICcvdXBncmFkZVRvUmV2b2NhYmxlU2Vzc2lvbicgJiZcbiAgICAgICAgaW5mby5zZXNzaW9uVG9rZW4uaW5kZXhPZigncjonKSAhPSAwXG4gICAgICApIHtcbiAgICAgICAgcmV0dXJuIGF1dGguZ2V0QXV0aEZvckxlZ2FjeVNlc3Npb25Ub2tlbih7XG4gICAgICAgICAgY29uZmlnOiByZXEuY29uZmlnLFxuICAgICAgICAgIGluc3RhbGxhdGlvbklkOiBpbmZvLmluc3RhbGxhdGlvbklkLFxuICAgICAgICAgIHNlc3Npb25Ub2tlbjogaW5mby5zZXNzaW9uVG9rZW4sXG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIGF1dGguZ2V0QXV0aEZvclNlc3Npb25Ub2tlbih7XG4gICAgICAgICAgY29uZmlnOiByZXEuY29uZmlnLFxuICAgICAgICAgIGluc3RhbGxhdGlvbklkOiBpbmZvLmluc3RhbGxhdGlvbklkLFxuICAgICAgICAgIHNlc3Npb25Ub2tlbjogaW5mby5zZXNzaW9uVG9rZW4sXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0pXG4gICAgLnRoZW4oYXV0aCA9PiB7XG4gICAgICBpZiAoYXV0aCkge1xuICAgICAgICByZXEuYXV0aCA9IGF1dGg7XG4gICAgICAgIG5leHQoKTtcbiAgICAgIH1cbiAgICB9KVxuICAgIC5jYXRjaChlcnJvciA9PiB7XG4gICAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBQYXJzZS5FcnJvcikge1xuICAgICAgICBuZXh0KGVycm9yKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gVE9ETzogRGV0ZXJtaW5lIHRoZSBjb3JyZWN0IGVycm9yIHNjZW5hcmlvLlxuICAgICAgICByZXEuY29uZmlnLmxvZ2dlckNvbnRyb2xsZXIuZXJyb3IoJ2Vycm9yIGdldHRpbmcgYXV0aCBmb3Igc2Vzc2lvblRva2VuJywgZXJyb3IpO1xuICAgICAgICB0aHJvdyBuZXcgUGFyc2UuRXJyb3IoUGFyc2UuRXJyb3IuVU5LTk9XTl9FUlJPUiwgZXJyb3IpO1xuICAgICAgfVxuICAgIH0pO1xufVxuXG5mdW5jdGlvbiBnZXRDbGllbnRJcChyZXEpIHtcbiAgaWYgKHJlcS5oZWFkZXJzWyd4LWZvcndhcmRlZC1mb3InXSkge1xuICAgIC8vIHRyeSB0byBnZXQgZnJvbSB4LWZvcndhcmVkLWZvciBpZiBpdCBzZXQgKGJlaGluZCByZXZlcnNlIHByb3h5KVxuICAgIHJldHVybiByZXEuaGVhZGVyc1sneC1mb3J3YXJkZWQtZm9yJ10uc3BsaXQoJywnKVswXTtcbiAgfSBlbHNlIGlmIChyZXEuY29ubmVjdGlvbiAmJiByZXEuY29ubmVjdGlvbi5yZW1vdGVBZGRyZXNzKSB7XG4gICAgLy8gbm8gcHJveHksIHRyeSBnZXR0aW5nIGZyb20gY29ubmVjdGlvbi5yZW1vdGVBZGRyZXNzXG4gICAgcmV0dXJuIHJlcS5jb25uZWN0aW9uLnJlbW90ZUFkZHJlc3M7XG4gIH0gZWxzZSBpZiAocmVxLnNvY2tldCkge1xuICAgIC8vIHRyeSB0byBnZXQgaXQgZnJvbSByZXEuc29ja2V0XG4gICAgcmV0dXJuIHJlcS5zb2NrZXQucmVtb3RlQWRkcmVzcztcbiAgfSBlbHNlIGlmIChyZXEuY29ubmVjdGlvbiAmJiByZXEuY29ubmVjdGlvbi5zb2NrZXQpIHtcbiAgICAvLyB0cnkgdG8gZ2V0IGl0IGZvcm0gdGhlIGNvbm5lY3Rpb24uc29ja2V0XG4gICAgcmV0dXJuIHJlcS5jb25uZWN0aW9uLnNvY2tldC5yZW1vdGVBZGRyZXNzO1xuICB9IGVsc2Uge1xuICAgIC8vIGlmIG5vbiBhYm92ZSwgZmFsbGJhY2suXG4gICAgcmV0dXJuIHJlcS5pcDtcbiAgfVxufVxuXG5mdW5jdGlvbiBodHRwQXV0aChyZXEpIHtcbiAgaWYgKCEocmVxLnJlcSB8fCByZXEpLmhlYWRlcnMuYXV0aG9yaXphdGlvbikgcmV0dXJuO1xuXG4gIHZhciBoZWFkZXIgPSAocmVxLnJlcSB8fCByZXEpLmhlYWRlcnMuYXV0aG9yaXphdGlvbjtcbiAgdmFyIGFwcElkLCBtYXN0ZXJLZXksIGphdmFzY3JpcHRLZXk7XG5cbiAgLy8gcGFyc2UgaGVhZGVyXG4gIHZhciBhdXRoUHJlZml4ID0gJ2Jhc2ljICc7XG5cbiAgdmFyIG1hdGNoID0gaGVhZGVyLnRvTG93ZXJDYXNlKCkuaW5kZXhPZihhdXRoUHJlZml4KTtcblxuICBpZiAobWF0Y2ggPT0gMCkge1xuICAgIHZhciBlbmNvZGVkQXV0aCA9IGhlYWRlci5zdWJzdHJpbmcoYXV0aFByZWZpeC5sZW5ndGgsIGhlYWRlci5sZW5ndGgpO1xuICAgIHZhciBjcmVkZW50aWFscyA9IGRlY29kZUJhc2U2NChlbmNvZGVkQXV0aCkuc3BsaXQoJzonKTtcblxuICAgIGlmIChjcmVkZW50aWFscy5sZW5ndGggPT0gMikge1xuICAgICAgYXBwSWQgPSBjcmVkZW50aWFsc1swXTtcbiAgICAgIHZhciBrZXkgPSBjcmVkZW50aWFsc1sxXTtcblxuICAgICAgdmFyIGpzS2V5UHJlZml4ID0gJ2phdmFzY3JpcHQta2V5PSc7XG5cbiAgICAgIHZhciBtYXRjaEtleSA9IGtleS5pbmRleE9mKGpzS2V5UHJlZml4KTtcbiAgICAgIGlmIChtYXRjaEtleSA9PSAwKSB7XG4gICAgICAgIGphdmFzY3JpcHRLZXkgPSBrZXkuc3Vic3RyaW5nKGpzS2V5UHJlZml4Lmxlbmd0aCwga2V5Lmxlbmd0aCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBtYXN0ZXJLZXkgPSBrZXk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHsgYXBwSWQ6IGFwcElkLCBtYXN0ZXJLZXk6IG1hc3RlcktleSwgamF2YXNjcmlwdEtleTogamF2YXNjcmlwdEtleSB9O1xufVxuXG5mdW5jdGlvbiBkZWNvZGVCYXNlNjQoc3RyKSB7XG4gIHJldHVybiBCdWZmZXIuZnJvbShzdHIsICdiYXNlNjQnKS50b1N0cmluZygpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gYWxsb3dDcm9zc0RvbWFpbihhcHBJZCkge1xuICByZXR1cm4gKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gICAgY29uc3QgY29uZmlnID0gQ29uZmlnLmdldChhcHBJZCwgZ2V0TW91bnRGb3JSZXF1ZXN0KHJlcSkpO1xuICAgIGxldCBhbGxvd0hlYWRlcnMgPSBERUZBVUxUX0FMTE9XRURfSEVBREVSUztcbiAgICBpZiAoY29uZmlnICYmIGNvbmZpZy5hbGxvd0hlYWRlcnMpIHtcbiAgICAgIGFsbG93SGVhZGVycyArPSBgLCAke2NvbmZpZy5hbGxvd0hlYWRlcnMuam9pbignLCAnKX1gO1xuICAgIH1cbiAgICBjb25zdCBhbGxvd09yaWdpbiA9IChjb25maWcgJiYgY29uZmlnLmFsbG93T3JpZ2luKSB8fCAnKic7XG4gICAgcmVzLmhlYWRlcignQWNjZXNzLUNvbnRyb2wtQWxsb3ctT3JpZ2luJywgYWxsb3dPcmlnaW4pO1xuICAgIHJlcy5oZWFkZXIoJ0FjY2Vzcy1Db250cm9sLUFsbG93LU1ldGhvZHMnLCAnR0VULFBVVCxQT1NULERFTEVURSxPUFRJT05TJyk7XG4gICAgcmVzLmhlYWRlcignQWNjZXNzLUNvbnRyb2wtQWxsb3ctSGVhZGVycycsIGFsbG93SGVhZGVycyk7XG4gICAgcmVzLmhlYWRlcignQWNjZXNzLUNvbnRyb2wtRXhwb3NlLUhlYWRlcnMnLCAnWC1QYXJzZS1Kb2ItU3RhdHVzLUlkLCBYLVBhcnNlLVB1c2gtU3RhdHVzLUlkJyk7XG4gICAgLy8gaW50ZXJjZXB0IE9QVElPTlMgbWV0aG9kXG4gICAgaWYgKCdPUFRJT05TJyA9PSByZXEubWV0aG9kKSB7XG4gICAgICByZXMuc2VuZFN0YXR1cygyMDApO1xuICAgIH0gZWxzZSB7XG4gICAgICBuZXh0KCk7XG4gICAgfVxuICB9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gYWxsb3dNZXRob2RPdmVycmlkZShyZXEsIHJlcywgbmV4dCkge1xuICBpZiAocmVxLm1ldGhvZCA9PT0gJ1BPU1QnICYmIHJlcS5ib2R5Ll9tZXRob2QpIHtcbiAgICByZXEub3JpZ2luYWxNZXRob2QgPSByZXEubWV0aG9kO1xuICAgIHJlcS5tZXRob2QgPSByZXEuYm9keS5fbWV0aG9kO1xuICAgIGRlbGV0ZSByZXEuYm9keS5fbWV0aG9kO1xuICB9XG4gIG5leHQoKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGhhbmRsZVBhcnNlRXJyb3JzKGVyciwgcmVxLCByZXMsIG5leHQpIHtcbiAgY29uc3QgbG9nID0gKHJlcS5jb25maWcgJiYgcmVxLmNvbmZpZy5sb2dnZXJDb250cm9sbGVyKSB8fCBkZWZhdWx0TG9nZ2VyO1xuICBpZiAoZXJyIGluc3RhbmNlb2YgUGFyc2UuRXJyb3IpIHtcbiAgICBpZiAocmVxLmNvbmZpZyAmJiByZXEuY29uZmlnLmVuYWJsZUV4cHJlc3NFcnJvckhhbmRsZXIpIHtcbiAgICAgIHJldHVybiBuZXh0KGVycik7XG4gICAgfVxuICAgIGxldCBodHRwU3RhdHVzO1xuICAgIC8vIFRPRE86IGZpbGwgb3V0IHRoaXMgbWFwcGluZ1xuICAgIHN3aXRjaCAoZXJyLmNvZGUpIHtcbiAgICAgIGNhc2UgUGFyc2UuRXJyb3IuSU5URVJOQUxfU0VSVkVSX0VSUk9SOlxuICAgICAgICBodHRwU3RhdHVzID0gNTAwO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgUGFyc2UuRXJyb3IuT0JKRUNUX05PVF9GT1VORDpcbiAgICAgICAgaHR0cFN0YXR1cyA9IDQwNDtcbiAgICAgICAgYnJlYWs7XG4gICAgICBkZWZhdWx0OlxuICAgICAgICBodHRwU3RhdHVzID0gNDAwO1xuICAgIH1cbiAgICByZXMuc3RhdHVzKGh0dHBTdGF0dXMpO1xuICAgIHJlcy5qc29uKHsgY29kZTogZXJyLmNvZGUsIGVycm9yOiBlcnIubWVzc2FnZSB9KTtcbiAgICBsb2cuZXJyb3IoJ1BhcnNlIGVycm9yOiAnLCBlcnIpO1xuICB9IGVsc2UgaWYgKGVyci5zdGF0dXMgJiYgZXJyLm1lc3NhZ2UpIHtcbiAgICByZXMuc3RhdHVzKGVyci5zdGF0dXMpO1xuICAgIHJlcy5qc29uKHsgZXJyb3I6IGVyci5tZXNzYWdlIH0pO1xuICAgIGlmICghKHByb2Nlc3MgJiYgcHJvY2Vzcy5lbnYuVEVTVElORykpIHtcbiAgICAgIG5leHQoZXJyKTtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgbG9nLmVycm9yKCdVbmNhdWdodCBpbnRlcm5hbCBzZXJ2ZXIgZXJyb3IuJywgZXJyLCBlcnIuc3RhY2spO1xuICAgIHJlcy5zdGF0dXMoNTAwKTtcbiAgICByZXMuanNvbih7XG4gICAgICBjb2RlOiBQYXJzZS5FcnJvci5JTlRFUk5BTF9TRVJWRVJfRVJST1IsXG4gICAgICBtZXNzYWdlOiAnSW50ZXJuYWwgc2VydmVyIGVycm9yLicsXG4gICAgfSk7XG4gICAgaWYgKCEocHJvY2VzcyAmJiBwcm9jZXNzLmVudi5URVNUSU5HKSkge1xuICAgICAgbmV4dChlcnIpO1xuICAgIH1cbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gZW5mb3JjZU1hc3RlcktleUFjY2VzcyhyZXEsIHJlcywgbmV4dCkge1xuICBpZiAoIXJlcS5hdXRoLmlzTWFzdGVyKSB7XG4gICAgcmVzLnN0YXR1cyg0MDMpO1xuICAgIHJlcy5lbmQoJ3tcImVycm9yXCI6XCJ1bmF1dGhvcml6ZWQ6IG1hc3RlciBrZXkgaXMgcmVxdWlyZWRcIn0nKTtcbiAgICByZXR1cm47XG4gIH1cbiAgbmV4dCgpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gcHJvbWlzZUVuZm9yY2VNYXN0ZXJLZXlBY2Nlc3MocmVxdWVzdCkge1xuICBpZiAoIXJlcXVlc3QuYXV0aC5pc01hc3Rlcikge1xuICAgIGNvbnN0IGVycm9yID0gbmV3IEVycm9yKCk7XG4gICAgZXJyb3Iuc3RhdHVzID0gNDAzO1xuICAgIGVycm9yLm1lc3NhZ2UgPSAndW5hdXRob3JpemVkOiBtYXN0ZXIga2V5IGlzIHJlcXVpcmVkJztcbiAgICB0aHJvdyBlcnJvcjtcbiAgfVxuICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG59XG5cbi8qKlxuICogRGVkdXBsaWNhdGVzIGEgcmVxdWVzdCB0byBlbnN1cmUgaWRlbXBvdGVuY3kuIER1cGxpY2F0ZXMgYXJlIGRldGVybWluZWQgYnkgdGhlIHJlcXVlc3QgSURcbiAqIGluIHRoZSByZXF1ZXN0IGhlYWRlci4gSWYgYSByZXF1ZXN0IGhhcyBubyByZXF1ZXN0IElELCBpdCBpcyBleGVjdXRlZCBhbnl3YXkuXG4gKiBAcGFyYW0geyp9IHJlcSBUaGUgcmVxdWVzdCB0byBldmFsdWF0ZS5cbiAqIEByZXR1cm5zIFByb21pc2U8e30+XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBwcm9taXNlRW5zdXJlSWRlbXBvdGVuY3kocmVxKSB7XG4gIC8vIEVuYWJsZSBmZWF0dXJlIG9ubHkgZm9yIE1vbmdvREJcbiAgaWYgKCEocmVxLmNvbmZpZy5kYXRhYmFzZS5hZGFwdGVyIGluc3RhbmNlb2YgTW9uZ29TdG9yYWdlQWRhcHRlcikpIHtcbiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG4gIH1cbiAgLy8gR2V0IHBhcmFtZXRlcnNcbiAgY29uc3QgY29uZmlnID0gcmVxLmNvbmZpZztcbiAgY29uc3QgcmVxdWVzdElkID0gKChyZXEgfHwge30pLmhlYWRlcnMgfHwge30pWyd4LXBhcnNlLXJlcXVlc3QtaWQnXTtcbiAgY29uc3QgeyBwYXRocywgdHRsIH0gPSBjb25maWcuaWRlbXBvdGVuY3lPcHRpb25zO1xuICBpZiAoIXJlcXVlc3RJZCB8fCAhY29uZmlnLmlkZW1wb3RlbmN5T3B0aW9ucykge1xuICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcbiAgfVxuICAvLyBSZXF1ZXN0IHBhdGggbWF5IGNvbnRhaW4gdHJhaWxpbmcgc2xhc2hlcywgZGVwZW5kaW5nIG9uIHRoZSBvcmlnaW5hbCByZXF1ZXN0LCBzbyByZW1vdmVcbiAgLy8gbGVhZGluZyBhbmQgdHJhaWxpbmcgc2xhc2hlcyB0byBtYWtlIGl0IGVhc2llciB0byBzcGVjaWZ5IHBhdGhzIGluIHRoZSBjb25maWd1cmF0aW9uXG4gIGNvbnN0IHJlcVBhdGggPSByZXEucGF0aC5yZXBsYWNlKC9eXFwvfFxcLyQvLCAnJyk7XG4gIC8vIERldGVybWluZSB3aGV0aGVyIGlkZW1wb3RlbmN5IGlzIGVuYWJsZWQgZm9yIGN1cnJlbnQgcmVxdWVzdCBwYXRoXG4gIGxldCBtYXRjaCA9IGZhbHNlO1xuICBmb3IgKGNvbnN0IHBhdGggb2YgcGF0aHMpIHtcbiAgICAvLyBBc3N1bWUgb25lIHdhbnRzIGEgcGF0aCB0byBhbHdheXMgbWF0Y2ggZnJvbSB0aGUgYmVnaW5uaW5nIHRvIHByZXZlbnQgYW55IG1pc3Rha2VzXG4gICAgY29uc3QgcmVnZXggPSBuZXcgUmVnRXhwKHBhdGguY2hhckF0KDApID09PSAnXicgPyBwYXRoIDogJ14nICsgcGF0aCk7XG4gICAgaWYgKHJlcVBhdGgubWF0Y2gocmVnZXgpKSB7XG4gICAgICBtYXRjaCA9IHRydWU7XG4gICAgICBicmVhaztcbiAgICB9XG4gIH1cbiAgaWYgKCFtYXRjaCkge1xuICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcbiAgfVxuICAvLyBUcnkgdG8gc3RvcmUgcmVxdWVzdFxuICBjb25zdCBleHBpcnlEYXRlID0gbmV3IERhdGUobmV3IERhdGUoKS5zZXRTZWNvbmRzKG5ldyBEYXRlKCkuZ2V0U2Vjb25kcygpICsgdHRsKSk7XG4gIHJldHVybiByZXN0XG4gICAgLmNyZWF0ZShjb25maWcsIGF1dGgubWFzdGVyKGNvbmZpZyksICdfSWRlbXBvdGVuY3knLCB7XG4gICAgICByZXFJZDogcmVxdWVzdElkLFxuICAgICAgZXhwaXJlOiBQYXJzZS5fZW5jb2RlKGV4cGlyeURhdGUpLFxuICAgIH0pXG4gICAgLmNhdGNoKGUgPT4ge1xuICAgICAgaWYgKGUuY29kZSA9PSBQYXJzZS5FcnJvci5EVVBMSUNBVEVfVkFMVUUpIHtcbiAgICAgICAgdGhyb3cgbmV3IFBhcnNlLkVycm9yKFBhcnNlLkVycm9yLkRVUExJQ0FURV9SRVFVRVNULCAnRHVwbGljYXRlIHJlcXVlc3QnKTtcbiAgICAgIH1cbiAgICAgIHRocm93IGU7XG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIGludmFsaWRSZXF1ZXN0KHJlcSwgcmVzKSB7XG4gIHJlcy5zdGF0dXMoNDAzKTtcbiAgcmVzLmVuZCgne1wiZXJyb3JcIjpcInVuYXV0aG9yaXplZFwifScpO1xufVxuXG5mdW5jdGlvbiBtYWxmb3JtZWRDb250ZXh0KHJlcSwgcmVzKSB7XG4gIHJlcy5zdGF0dXMoNDAwKTtcbiAgcmVzLmpzb24oeyBjb2RlOiBQYXJzZS5FcnJvci5JTlZBTElEX0pTT04sIGVycm9yOiAnSW52YWxpZCBvYmplY3QgZm9yIGNvbnRleHQuJyB9KTtcbn1cbiJdfQ==