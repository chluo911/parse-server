"use strict";/*
  # Parse Server Keycloak Authentication

  ## Keycloak `authData`

  ```
    {
      "keycloak": {
        "access_token": "access token you got from keycloak JS client authentication",
        "id": "the id retrieved from client authentication in Keycloak",
        "roles": ["the roles retrieved from client authentication in Keycloak"],
        "groups": ["the groups retrieved from client authentication in Keycloak"]
      }
    }
  ```

  The authentication module will test if the authData is the same as the
  userinfo oauth call, comparing the attributes

  Copy the JSON config file generated on Keycloak (https://www.keycloak.org/docs/latest/securing_apps/index.html#_javascript_adapter)
  and paste it inside of a folder (Ex.: `auth/keycloak.json`) in your server.

  The options passed to Parse server:

  ```
    {
      auth: {
        keycloak: {
          config: require(`./auth/keycloak.json`)
        }
      }
    }
  ```
*/function cov_261iajv25a(){var path="/parse-server/lib/Adapters/Auth/keycloak.js";var hash="ae4d62de158b700b28d5224d365e2da370fc69f1";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/parse-server/lib/Adapters/Auth/keycloak.js",statementMap:{"0":{start:{line:39,column:4},end:{line:39,column:25}},"1":{start:{line:41,column:21},end:{line:41,column:46}},"2":{start:{line:43,column:20},end:{line:55,column:1}},"3":{start:{line:44,column:2},end:{line:44,column:100}},"4":{start:{line:44,column:87},end:{line:44,column:100}},"5":{start:{line:46,column:13},end:{line:46,column:34}},"6":{start:{line:48,column:13},end:{line:48,column:34}},"7":{start:{line:50,column:2},end:{line:52,column:3}},"8":{start:{line:50,column:15},end:{line:50,column:16}},"9":{start:{line:51,column:4},end:{line:51,column:42}},"10":{start:{line:51,column:29},end:{line:51,column:42}},"11":{start:{line:54,column:2},end:{line:54,column:14}},"12":{start:{line:57,column:19},end:{line:100,column:1}},"13":{start:{line:65,column:2},end:{line:67,column:3}},"14":{start:{line:66,column:4},end:{line:66,column:95}},"15":{start:{line:69,column:2},end:{line:71,column:3}},"16":{start:{line:70,column:4},end:{line:70,column:90}},"17":{start:{line:73,column:2},end:{line:99,column:3}},"18":{start:{line:74,column:21},end:{line:80,column:6}},"19":{start:{line:82,column:4},end:{line:84,column:5}},"20":{start:{line:83,column:6},end:{line:83,column:13}},"21":{start:{line:86,column:4},end:{line:86,column:82}},"22":{start:{line:88,column:4},end:{line:90,column:5}},"23":{start:{line:89,column:6},end:{line:89,column:14}},"24":{start:{line:92,column:18},end:{line:92,column:36}},"25":{start:{line:94,column:4},end:{line:98,column:5}},"26":{start:{line:95,column:6},end:{line:95,column:80}},"27":{start:{line:97,column:6},end:{line:97,column:105}},"28":{start:{line:113,column:2},end:{line:113,column:39}},"29":{start:{line:118,column:2},end:{line:118,column:27}},"30":{start:{line:121,column:0},end:{line:124,column:2}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:43,column:20},end:{line:43,column:21}},loc:{start:{line:43,column:38},end:{line:55,column:1}},line:43},"1":{name:"(anonymous_1)",decl:{start:{line:57,column:19},end:{line:57,column:20}},loc:{start:{line:64,column:11},end:{line:100,column:1}},line:64},"2":{name:"validateAuthData",decl:{start:{line:112,column:9},end:{line:112,column:25}},loc:{start:{line:112,column:50},end:{line:114,column:1}},line:112},"3":{name:"validateAppId",decl:{start:{line:117,column:9},end:{line:117,column:22}},loc:{start:{line:117,column:25},end:{line:119,column:1}},line:117}},branchMap:{"0":{loc:{start:{line:44,column:2},end:{line:44,column:100}},type:"if",locations:[{start:{line:44,column:2},end:{line:44,column:100}},{start:{line:44,column:2},end:{line:44,column:100}}],line:44},"1":{loc:{start:{line:44,column:6},end:{line:44,column:85}},type:"binary-expr",locations:[{start:{line:44,column:6},end:{line:44,column:27}},{start:{line:44,column:31},end:{line:44,column:52}},{start:{line:44,column:56},end:{line:44,column:85}}],line:44},"2":{loc:{start:{line:51,column:4},end:{line:51,column:42}},type:"if",locations:[{start:{line:51,column:4},end:{line:51,column:42}},{start:{line:51,column:4},end:{line:51,column:42}}],line:51},"3":{loc:{start:{line:57,column:26},end:{line:62,column:6}},type:"default-arg",locations:[{start:{line:62,column:4},end:{line:62,column:6}}],line:57},"4":{loc:{start:{line:62,column:8},end:{line:64,column:6}},type:"default-arg",locations:[{start:{line:64,column:4},end:{line:64,column:6}}],line:62},"5":{loc:{start:{line:65,column:2},end:{line:67,column:3}},type:"if",locations:[{start:{line:65,column:2},end:{line:67,column:3}},{start:{line:65,column:2},end:{line:67,column:3}}],line:65},"6":{loc:{start:{line:65,column:8},end:{line:65,column:26}},type:"binary-expr",locations:[{start:{line:65,column:8},end:{line:65,column:20}},{start:{line:65,column:24},end:{line:65,column:26}}],line:65},"7":{loc:{start:{line:69,column:2},end:{line:71,column:3}},type:"if",locations:[{start:{line:69,column:2},end:{line:71,column:3}},{start:{line:69,column:2},end:{line:71,column:3}}],line:69},"8":{loc:{start:{line:69,column:6},end:{line:69,column:64}},type:"binary-expr",locations:[{start:{line:69,column:6},end:{line:69,column:13}},{start:{line:69,column:17},end:{line:69,column:64}}],line:69},"9":{loc:{start:{line:69,column:19},end:{line:69,column:63}},type:"binary-expr",locations:[{start:{line:69,column:19},end:{line:69,column:44}},{start:{line:69,column:48},end:{line:69,column:63}}],line:69},"10":{loc:{start:{line:82,column:4},end:{line:84,column:5}},type:"if",locations:[{start:{line:82,column:4},end:{line:84,column:5}},{start:{line:82,column:4},end:{line:84,column:5}}],line:82},"11":{loc:{start:{line:82,column:8},end:{line:82,column:148}},type:"binary-expr",locations:[{start:{line:82,column:8},end:{line:82,column:16}},{start:{line:82,column:20},end:{line:82,column:33}},{start:{line:82,column:37},end:{line:82,column:60}},{start:{line:82,column:64},end:{line:82,column:103}},{start:{line:82,column:107},end:{line:82,column:148}}],line:82},"12":{loc:{start:{line:88,column:4},end:{line:90,column:5}},type:"if",locations:[{start:{line:88,column:4},end:{line:90,column:5}},{start:{line:88,column:4},end:{line:90,column:5}}],line:88},"13":{loc:{start:{line:94,column:4},end:{line:98,column:5}},type:"if",locations:[{start:{line:94,column:4},end:{line:98,column:5}},{start:{line:94,column:4},end:{line:98,column:5}}],line:94},"14":{loc:{start:{line:112,column:36},end:{line:112,column:48}},type:"default-arg",locations:[{start:{line:112,column:46},end:{line:112,column:48}}],line:112}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0},f:{"0":0,"1":0,"2":0,"3":0},b:{"0":[0,0],"1":[0,0,0],"2":[0,0],"3":[0],"4":[0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0,0,0,0],"12":[0,0],"13":[0,0],"14":[0]},inputSourceMap:{version:3,sources:["../../../src/Adapters/Auth/keycloak.js"],names:["Parse","require","httpsRequest","arraysEqual","_arr1","_arr2","Array","isArray","length","arr1","concat","sort","arr2","i","handleAuth","access_token","id","roles","groups","config","Error","OBJECT_NOT_FOUND","response","get","host","path","headers","Authorization","data","sub","e","error","JSON","parse","text","error_description","HOSTING_ERROR","validateAuthData","authData","options","validateAppId","Promise","resolve","module","exports"],mappings:"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",sourcesContent:["/*\n  # Parse Server Keycloak Authentication\n\n  ## Keycloak `authData`\n\n  ```\n    {\n      \"keycloak\": {\n        \"access_token\": \"access token you got from keycloak JS client authentication\",\n        \"id\": \"the id retrieved from client authentication in Keycloak\",\n        \"roles\": [\"the roles retrieved from client authentication in Keycloak\"],\n        \"groups\": [\"the groups retrieved from client authentication in Keycloak\"]\n      }\n    }\n  ```\n\n  The authentication module will test if the authData is the same as the\n  userinfo oauth call, comparing the attributes\n\n  Copy the JSON config file generated on Keycloak (https://www.keycloak.org/docs/latest/securing_apps/index.html#_javascript_adapter)\n  and paste it inside of a folder (Ex.: `auth/keycloak.json`) in your server.\n\n  The options passed to Parse server:\n\n  ```\n    {\n      auth: {\n        keycloak: {\n          config: require(`./auth/keycloak.json`)\n        }\n      }\n    }\n  ```\n*/\n\nconst { Parse } = require('parse/node');\nconst httpsRequest = require('./httpsRequest');\n\nconst arraysEqual = (_arr1, _arr2) => {\n  if (!Array.isArray(_arr1) || !Array.isArray(_arr2) || _arr1.length !== _arr2.length) return false;\n\n  var arr1 = _arr1.concat().sort();\n  var arr2 = _arr2.concat().sort();\n\n  for (var i = 0; i < arr1.length; i++) {\n    if (arr1[i] !== arr2[i]) return false;\n  }\n\n  return true;\n};\n\nconst handleAuth = async ({ access_token, id, roles, groups } = {}, { config } = {}) => {\n  if (!(access_token && id)) {\n    throw new Parse.Error(Parse.Error.OBJECT_NOT_FOUND, 'Missing access token and/or User id');\n  }\n  if (!config || !(config['auth-server-url'] && config['realm'])) {\n    throw new Parse.Error(Parse.Error.OBJECT_NOT_FOUND, 'Missing keycloak configuration');\n  }\n  try {\n    const response = await httpsRequest.get({\n      host: config['auth-server-url'],\n      path: `/realms/${config['realm']}/protocol/openid-connect/userinfo`,\n      headers: {\n        Authorization: 'Bearer ' + access_token,\n      },\n    });\n    if (\n      response &&\n      response.data &&\n      response.data.sub == id &&\n      arraysEqual(response.data.roles, roles) &&\n      arraysEqual(response.data.groups, groups)\n    ) {\n      return;\n    }\n    throw new Parse.Error(Parse.Error.OBJECT_NOT_FOUND, 'Invalid authentication');\n  } catch (e) {\n    if (e instanceof Parse.Error) {\n      throw e;\n    }\n    const error = JSON.parse(e.text);\n    if (error.error_description) {\n      throw new Parse.Error(Parse.Error.HOSTING_ERROR, error.error_description);\n    } else {\n      throw new Parse.Error(\n        Parse.Error.HOSTING_ERROR,\n        'Could not connect to the authentication server'\n      );\n    }\n  }\n};\n\n/*\n  @param {Object} authData: the client provided authData\n  @param {string} authData.access_token: the access_token retrieved from client authentication in Keycloak\n  @param {string} authData.id: the id retrieved from client authentication in Keycloak\n  @param {Array}  authData.roles: the roles retrieved from client authentication in Keycloak\n  @param {Array}  authData.groups: the groups retrieved from client authentication in Keycloak\n  @param {Object} options: additional options\n  @param {Object} options.config: the config object passed during Parse Server instantiation\n*/\nfunction validateAuthData(authData, options = {}) {\n  return handleAuth(authData, options);\n}\n\n// Returns a promise that fulfills if this app id is valid.\nfunction validateAppId() {\n  return Promise.resolve();\n}\n\nmodule.exports = {\n  validateAppId,\n  validateAuthData,\n};\n"]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"ae4d62de158b700b28d5224d365e2da370fc69f1"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_261iajv25a=function(){return actualCoverage;};}return actualCoverage;}cov_261iajv25a();const{Parse}=(cov_261iajv25a().s[0]++,require('parse/node'));const httpsRequest=(cov_261iajv25a().s[1]++,require('./httpsRequest'));cov_261iajv25a().s[2]++;const arraysEqual=(_arr1,_arr2)=>{cov_261iajv25a().f[0]++;cov_261iajv25a().s[3]++;if((cov_261iajv25a().b[1][0]++,!Array.isArray(_arr1))||(cov_261iajv25a().b[1][1]++,!Array.isArray(_arr2))||(cov_261iajv25a().b[1][2]++,_arr1.length!==_arr2.length)){cov_261iajv25a().b[0][0]++;cov_261iajv25a().s[4]++;return false;}else{cov_261iajv25a().b[0][1]++;}var arr1=(cov_261iajv25a().s[5]++,_arr1.concat().sort());var arr2=(cov_261iajv25a().s[6]++,_arr2.concat().sort());cov_261iajv25a().s[7]++;for(var i=(cov_261iajv25a().s[8]++,0);i<arr1.length;i++){cov_261iajv25a().s[9]++;if(arr1[i]!==arr2[i]){cov_261iajv25a().b[2][0]++;cov_261iajv25a().s[10]++;return false;}else{cov_261iajv25a().b[2][1]++;}}cov_261iajv25a().s[11]++;return true;};cov_261iajv25a().s[12]++;const handleAuth=async({access_token,id,roles,groups}=(cov_261iajv25a().b[3][0]++,{}),{config}=(cov_261iajv25a().b[4][0]++,{}))=>{cov_261iajv25a().f[1]++;cov_261iajv25a().s[13]++;if(!((cov_261iajv25a().b[6][0]++,access_token)&&(cov_261iajv25a().b[6][1]++,id))){cov_261iajv25a().b[5][0]++;cov_261iajv25a().s[14]++;throw new Parse.Error(Parse.Error.OBJECT_NOT_FOUND,'Missing access token and/or User id');}else{cov_261iajv25a().b[5][1]++;}cov_261iajv25a().s[15]++;if((cov_261iajv25a().b[8][0]++,!config)||(cov_261iajv25a().b[8][1]++,!((cov_261iajv25a().b[9][0]++,config['auth-server-url'])&&(cov_261iajv25a().b[9][1]++,config['realm'])))){cov_261iajv25a().b[7][0]++;cov_261iajv25a().s[16]++;throw new Parse.Error(Parse.Error.OBJECT_NOT_FOUND,'Missing keycloak configuration');}else{cov_261iajv25a().b[7][1]++;}cov_261iajv25a().s[17]++;try{const response=(cov_261iajv25a().s[18]++,await httpsRequest.get({host:config['auth-server-url'],path:`/realms/${config['realm']}/protocol/openid-connect/userinfo`,headers:{Authorization:'Bearer '+access_token}}));cov_261iajv25a().s[19]++;if((cov_261iajv25a().b[11][0]++,response)&&(cov_261iajv25a().b[11][1]++,response.data)&&(cov_261iajv25a().b[11][2]++,response.data.sub==id)&&(cov_261iajv25a().b[11][3]++,arraysEqual(response.data.roles,roles))&&(cov_261iajv25a().b[11][4]++,arraysEqual(response.data.groups,groups))){cov_261iajv25a().b[10][0]++;cov_261iajv25a().s[20]++;return;}else{cov_261iajv25a().b[10][1]++;}cov_261iajv25a().s[21]++;throw new Parse.Error(Parse.Error.OBJECT_NOT_FOUND,'Invalid authentication');}catch(e){cov_261iajv25a().s[22]++;if(e instanceof Parse.Error){cov_261iajv25a().b[12][0]++;cov_261iajv25a().s[23]++;throw e;}else{cov_261iajv25a().b[12][1]++;}const error=(cov_261iajv25a().s[24]++,JSON.parse(e.text));cov_261iajv25a().s[25]++;if(error.error_description){cov_261iajv25a().b[13][0]++;cov_261iajv25a().s[26]++;throw new Parse.Error(Parse.Error.HOSTING_ERROR,error.error_description);}else{cov_261iajv25a().b[13][1]++;cov_261iajv25a().s[27]++;throw new Parse.Error(Parse.Error.HOSTING_ERROR,'Could not connect to the authentication server');}}};/*
  @param {Object} authData: the client provided authData
  @param {string} authData.access_token: the access_token retrieved from client authentication in Keycloak
  @param {string} authData.id: the id retrieved from client authentication in Keycloak
  @param {Array}  authData.roles: the roles retrieved from client authentication in Keycloak
  @param {Array}  authData.groups: the groups retrieved from client authentication in Keycloak
  @param {Object} options: additional options
  @param {Object} options.config: the config object passed during Parse Server instantiation
*/function validateAuthData(authData,options=(cov_261iajv25a().b[14][0]++,{})){cov_261iajv25a().f[2]++;cov_261iajv25a().s[28]++;return handleAuth(authData,options);}// Returns a promise that fulfills if this app id is valid.
function validateAppId(){cov_261iajv25a().f[3]++;cov_261iajv25a().s[29]++;return Promise.resolve();}cov_261iajv25a().s[30]++;module.exports={validateAppId,validateAuthData};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9BZGFwdGVycy9BdXRoL2tleWNsb2FrLmpzIl0sIm5hbWVzIjpbIlBhcnNlIiwicmVxdWlyZSIsImh0dHBzUmVxdWVzdCIsImFycmF5c0VxdWFsIiwiX2FycjEiLCJfYXJyMiIsIkFycmF5IiwiaXNBcnJheSIsImxlbmd0aCIsImFycjEiLCJjb25jYXQiLCJzb3J0IiwiYXJyMiIsImkiLCJoYW5kbGVBdXRoIiwiYWNjZXNzX3Rva2VuIiwiaWQiLCJyb2xlcyIsImdyb3VwcyIsImNvbmZpZyIsIkVycm9yIiwiT0JKRUNUX05PVF9GT1VORCIsInJlc3BvbnNlIiwiZ2V0IiwiaG9zdCIsInBhdGgiLCJoZWFkZXJzIiwiQXV0aG9yaXphdGlvbiIsImRhdGEiLCJzdWIiLCJlIiwiZXJyb3IiLCJKU09OIiwicGFyc2UiLCJ0ZXh0IiwiZXJyb3JfZGVzY3JpcHRpb24iLCJIT1NUSU5HX0VSUk9SIiwidmFsaWRhdGVBdXRoRGF0YSIsImF1dGhEYXRhIiwib3B0aW9ucyIsInZhbGlkYXRlQXBwSWQiLCJQcm9taXNlIiwicmVzb2x2ZSIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiI7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQSxNQUFNO0FBQUVBLEVBQUFBO0FBQUYsSUFBWUMsT0FBTyxDQUFDLFlBQUQsQ0FBekI7O0FBQ0EsTUFBTUMsWUFBWSxHQUFHRCxPQUFPLENBQUMsZ0JBQUQsQ0FBNUI7O0FBRUEsTUFBTUUsV0FBVyxHQUFHLENBQUNDLEtBQUQsRUFBUUMsS0FBUixLQUFrQjtBQUNwQyxNQUFJLENBQUNDLEtBQUssQ0FBQ0MsT0FBTixDQUFjSCxLQUFkLENB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QUssQ0FBQ29CLEtBQVYsQ0FDSnBCLEtBQUssQ0FBQ29CLEtBQU4sQ0FBWWdCLGFBRFIsRUFFSixnREFGSSxDQUFOO0FBSUQ7QUFDRjtBQUNGLENBdkNEO0FBeUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBQ0EsU0FBU0MsZ0JBQVQsQ0FBMEJDLFFBQTFCLEVBQW9DQyxPQUFPLEdBQUcsRUFBOUMsRUFBa0Q7QUFDaEQsU0FBT3pCLFVBQVUsQ0FBQ3dCLFFBQUQsRUFBV0MsT0FBWCxDQUFqQjtBQUNELEMsQ0FFRDs7O0FBQ0EsU0FBU0MsYUFBVCxHQUF5QjtBQUN2QixTQUFPQyxPQUFPLENBQUNDLE9BQVIsRUFBUDtBQUNEOztBQUVEQyxNQUFNLENBQUNDLE9BQVAsR0FBaUI7QUFDZkosRUFBQUEsYUFEZTtBQUVmSCxFQUFBQTtBQUZlLENBQWpCIiwic291cmNlc0NvbnRlbnQiOlsiLypcbiAgIyBQYXJzZSBTZXJ2ZXIgS2V5Y2xvYWsgQXV0aGVudGljYXRpb25cblxuICAjIyBLZXljbG9hayBgYXV0aERhdGFgXG5cbiAgYGBgXG4gICAge1xuICAgICAgXCJrZXljbG9ha1wiOiB7XG4gICAgICAgIFwiYWNjZXNzX3Rva2VuXCI6IFwiYWNjZXNzIHRva2VuIHlvdSBnb3QgZnJvbSBrZXljbG9hayBKUyBjbGllbnQgYXV0aGVudGljYXRpb25cIixcbiAgICAgICAgXCJpZFwiOiBcInRoZSBpZCByZXRyaWV2ZWQgZnJvbSBjbGllbnQgYXV0aGVudGljYXRpb24gaW4gS2V5Y2xvYWtcIixcbiAgICAgICAgXCJyb2xlc1wiOiBbXCJ0aGUgcm9sZXMgcmV0cmlldmVkIGZyb20gY2xpZW50IGF1dGhlbnRpY2F0aW9uIGluIEtleWNsb2FrXCJdLFxuICAgICAgICBcImdyb3Vwc1wiOiBbXCJ0aGUgZ3JvdXBzIHJldHJpZXZlZCBmcm9tIGNsaWVudCBhdXRoZW50aWNhdGlvbiBpbiBLZXljbG9ha1wiXVxuICAgICAgfVxuICAgIH1cbiAgYGBgXG5cbiAgVGhlIGF1dGhlbnRpY2F0aW9uIG1vZHVsZSB3aWxsIHRlc3QgaWYgdGhlIGF1dGhEYXRhIGlzIHRoZSBzYW1lIGFzIHRoZVxuICB1c2VyaW5mbyBvYXV0aCBjYWxsLCBjb21wYXJpbmcgdGhlIGF0dHJpYnV0ZXNcblxuICBDb3B5IHRoZSBKU09OIGNvbmZpZyBmaWxlIGdlbmVyYXRlZCBvbiBLZXljbG9hayAoaHR0cHM6Ly93d3cua2V5Y2xvYWsub3JnL2RvY3MvbGF0ZXN0L3NlY3VyaW5nX2FwcHMvaW5kZXguaHRtbCNfamF2YXNjcmlwdF9hZGFwdGVyKVxuICBhbmQgcGFzdGUgaXQgaW5zaWRlIG9mIGEgZm9sZGVyIChFeC46IGBhdXRoL2tleWNsb2FrLmpzb25gKSBpbiB5b3VyIHNlcnZlci5cblxuICBUaGUgb3B0aW9ucyBwYXNzZWQgdG8gUGFyc2Ugc2VydmVyOlxuXG4gIGBgYFxuICAgIHtcbiAgICAgIGF1dGg6IHtcbiAgICAgICAga2V5Y2xvYWs6IHtcbiAgICAgICAgICBjb25maWc6IHJlcXVpcmUoYC4vYXV0aC9rZXljbG9hay5qc29uYClcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgYGBgXG4qL1xuXG5jb25zdCB7IFBhcnNlIH0gPSByZXF1aXJlKCdwYXJzZS9ub2RlJyk7XG5jb25zdCBodHRwc1JlcXVlc3QgPSByZXF1aXJlKCcuL2h0dHBzUmVxdWVzdCcpO1xuXG5jb25zdCBhcnJheXNFcXVhbCA9IChfYXJyMSwgX2FycjIpID0+IHtcbiAgaWYgKCFBcnJheS5pc0FycmF5KF9hcnIxKSB8fCAhQXJyYXkuaXNBcnJheShfYXJyMikgfHwgX2FycjEubGVuZ3RoICE9PSBfYXJyMi5sZW5ndGgpIHJldHVybiBmYWxzZTtcblxuICB2YXIgYXJyMSA9IF9hcnIxLmNvbmNhdCgpLnNvcnQoKTtcbiAgdmFyIGFycjIgPSBfYXJyMi5jb25jYXQoKS5zb3J0KCk7XG5cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcnIxLmxlbmd0aDsgaSsrKSB7XG4gICAgaWYgKGFycjFbaV0gIT09IGFycjJbaV0pIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIHJldHVybiB0cnVlO1xufTtcblxuY29uc3QgaGFuZGxlQXV0aCA9IGFzeW5jICh7IGFjY2Vzc190b2tlbiwgaWQsIHJvbGVzLCBncm91cHMgfSA9IHt9LCB7IGNvbmZpZyB9ID0ge30pID0+IHtcbiAgaWYgKCEoYWNjZXNzX3Rva2VuICYmIGlkKSkge1xuICAgIHRocm93IG5ldyBQYXJzZS5FcnJvcihQYXJzZS5FcnJvci5PQkpFQ1RfTk9UX0ZPVU5ELCAnTWlzc2luZyBhY2Nlc3MgdG9rZW4gYW5kL29yIFVzZXIgaWQnKTtcbiAgfVxuICBpZiAoIWNvbmZpZyB8fCAhKGNvbmZpZ1snYXV0aC1zZXJ2ZXItdXJsJ10gJiYgY29uZmlnWydyZWFsbSddKSkge1xuICAgIHRocm93IG5ldyBQYXJzZS5FcnJvcihQYXJzZS5FcnJvci5PQkpFQ1RfTk9UX0ZPVU5ELCAnTWlzc2luZyBrZXljbG9hayBjb25maWd1cmF0aW9uJyk7XG4gIH1cbiAgdHJ5IHtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGh0dHBzUmVxdWVzdC5nZXQoe1xuICAgICAgaG9zdDogY29uZmlnWydhdXRoLXNlcnZlci11cmwnXSxcbiAgICAgIHBhdGg6IGAvcmVhbG1zLyR7Y29uZmlnWydyZWFsbSddfS9wcm90b2NvbC9vcGVuaWQtY29ubmVjdC91c2VyaW5mb2AsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIEF1dGhvcml6YXRpb246ICdCZWFyZXIgJyArIGFjY2Vzc190b2tlbixcbiAgICAgIH0sXG4gICAgfSk7XG4gICAgaWYgKFxuICAgICAgcmVzcG9uc2UgJiZcbiAgICAgIHJlc3BvbnNlLmRhdGEgJiZcbiAgICAgIHJlc3BvbnNlLmRhdGEuc3ViID09IGlkICYmXG4gICAgICBhcnJheXNFcXVhbChyZXNwb25zZS5kYXRhLnJvbGVzLCByb2xlcykgJiZcbiAgICAgIGFycmF5c0VxdWFsKHJlc3BvbnNlLmRhdGEuZ3JvdXBzLCBncm91cHMpXG4gICAgKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRocm93IG5ldyBQYXJzZS5FcnJvcihQYXJzZS5FcnJvci5PQkpFQ1RfTk9UX0ZPVU5ELCAnSW52YWxpZCBhdXRoZW50aWNhdGlvbicpO1xuICB9IGNhdGNoIChlKSB7XG4gICAgaWYgKGUgaW5zdGFuY2VvZiBQYXJzZS5FcnJvcikge1xuICAgICAgdGhyb3cgZTtcbiAgICB9XG4gICAgY29uc3QgZXJyb3IgPSBKU09OLnBhcnNlKGUudGV4dCk7XG4gICAgaWYgKGVycm9yLmVycm9yX2Rlc2NyaXB0aW9uKSB7XG4gICAgICB0aHJvdyBuZXcgUGFyc2UuRXJyb3IoUGFyc2UuRXJyb3IuSE9TVElOR19FUlJPUiwgZXJyb3IuZXJyb3JfZGVzY3JpcHRpb24pO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aHJvdyBuZXcgUGFyc2UuRXJyb3IoXG4gICAgICAgIFBhcnNlLkVycm9yLkhPU1RJTkdfRVJST1IsXG4gICAgICAgICdDb3VsZCBub3QgY29ubmVjdCB0byB0aGUgYXV0aGVudGljYXRpb24gc2VydmVyJ1xuICAgICAgKTtcbiAgICB9XG4gIH1cbn07XG5cbi8qXG4gIEBwYXJhbSB7T2JqZWN0fSBhdXRoRGF0YTogdGhlIGNsaWVudCBwcm92aWRlZCBhdXRoRGF0YVxuICBAcGFyYW0ge3N0cmluZ30gYXV0aERhdGEuYWNjZXNzX3Rva2VuOiB0aGUgYWNjZXNzX3Rva2VuIHJldHJpZXZlZCBmcm9tIGNsaWVudCBhdXRoZW50aWNhdGlvbiBpbiBLZXljbG9ha1xuICBAcGFyYW0ge3N0cmluZ30gYXV0aERhdGEuaWQ6IHRoZSBpZCByZXRyaWV2ZWQgZnJvbSBjbGllbnQgYXV0aGVudGljYXRpb24gaW4gS2V5Y2xvYWtcbiAgQHBhcmFtIHtBcnJheX0gIGF1dGhEYXRhLnJvbGVzOiB0aGUgcm9sZXMgcmV0cmlldmVkIGZyb20gY2xpZW50IGF1dGhlbnRpY2F0aW9uIGluIEtleWNsb2FrXG4gIEBwYXJhbSB7QXJyYXl9ICBhdXRoRGF0YS5ncm91cHM6IHRoZSBncm91cHMgcmV0cmlldmVkIGZyb20gY2xpZW50IGF1dGhlbnRpY2F0aW9uIGluIEtleWNsb2FrXG4gIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zOiBhZGRpdGlvbmFsIG9wdGlvbnNcbiAgQHBhcmFtIHtPYmplY3R9IG9wdGlvbnMuY29uZmlnOiB0aGUgY29uZmlnIG9iamVjdCBwYXNzZWQgZHVyaW5nIFBhcnNlIFNlcnZlciBpbnN0YW50aWF0aW9uXG4qL1xuZnVuY3Rpb24gdmFsaWRhdGVBdXRoRGF0YShhdXRoRGF0YSwgb3B0aW9ucyA9IHt9KSB7XG4gIHJldHVybiBoYW5kbGVBdXRoKGF1dGhEYXRhLCBvcHRpb25zKTtcbn1cblxuLy8gUmV0dXJucyBhIHByb21pc2UgdGhhdCBmdWxmaWxscyBpZiB0aGlzIGFwcCBpZCBpcyB2YWxpZC5cbmZ1bmN0aW9uIHZhbGlkYXRlQXBwSWQoKSB7XG4gIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSB7XG4gIHZhbGlkYXRlQXBwSWQsXG4gIHZhbGlkYXRlQXV0aERhdGEsXG59O1xuIl19
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9BZGFwdGVycy9BdXRoL2tleWNsb2FrLmpzIl0sIm5hbWVzIjpbIlBhcnNlIiwicmVxdWlyZSIsImh0dHBzUmVxdWVzdCIsImFycmF5c0VxdWFsIiwiQXJyYXkiLCJfYXJyMSIsIl9hcnIyIiwiYXJyMSIsImFycjIiLCJpIiwiaGFuZGxlQXV0aCIsImdyb3VwcyIsImNvbmZpZyIsImFjY2Vzc190b2tlbiIsInJlc3BvbnNlIiwiaG9zdCIsInBhdGgiLCJoZWFkZXJzIiwiQXV0aG9yaXphdGlvbiIsImUiLCJlcnJvciIsIkpTT04iLCJvcHRpb25zIiwiUHJvbWlzZSIsIm1vZHVsZSIsInZhbGlkYXRlQXV0aERhdGEiXSwibWFwcGluZ3MiOiJhQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEUsa3paQXBCQTsyRkFzQkEsS0FBTSxDQUFFQSxLQUFGLDJCQUFZQyxPQUFPLENBQXpCLFlBQXlCLENBQW5CLENBQU4sQ0FDQSxLQUFNQyxDQUFBQSxZQUFZLDBCQUFHRCxPQUFPLENBQTVCLGdCQUE0QixDQUFWLENBQWxCLEMsd0JBRUEsS0FBTUUsQ0FBQUEsV0FBVyxDQUFHLENBQUEsS0FBQSxDQUFBLEtBQUEsR0FBa0IsaURBQ3BDLEdBQUksNkJBQUNDLEtBQUssQ0FBTEEsT0FBQUEsQ0FBRCxLQUFDQSxDQUFELCtCQUF5QixDQUFDQSxLQUFLLENBQUxBLE9BQUFBLENBQTFCLEtBQTBCQSxDQUExQiwrQkFBa0RDLEtBQUssQ0FBTEEsTUFBQUEsR0FBaUJDLEtBQUssQ0FBNUUsTUFBSSxDQUFKLENBQXFGLDBEQUFBLE1BQUEsQ0FBQSxDQUFyRixpQ0FFQSxHQUFJQyxDQUFBQSxJQUFJLDBC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RixDQUFBLElBRU8sc0RBQ0wsS0FBTSxJQUFJcEIsQ0FBQUEsS0FBSyxDQUFULEtBQUEsQ0FDSkEsS0FBSyxDQUFMQSxLQUFBQSxDQURJLGFBQUEsQ0FBTixnREFBTSxDQUFOLENBSUQsQ0FDRixDQXRDSCxDQUFBLENBeUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUNBLFFBQUEsQ0FBQSxnQkFBQSxDQUFBLFFBQUEsQ0FBb0NzQixPQUFPLDhCQUEzQyxFQUEyQyxDQUEzQyxDQUFrRCxrREFDaEQsTUFBT1osQ0FBQUEsVUFBVSxDQUFBLFFBQUEsQ0FBakIsT0FBaUIsQ0FBakIsQyxDQUdGO0FBQ0EsUUFBQSxDQUFBLGFBQUEsRUFBeUIsa0RBQ3ZCLE1BQU9hLENBQUFBLE9BQU8sQ0FBZCxPQUFPQSxFQUFQLENBQ0QsQyx5QkFFREMsTUFBTSxDQUFOQSxPQUFBQSxDQUFpQixDQUFBLGFBQUEsQ0FFZkMsZ0JBRmUsQ0FBakJELEMiLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuICAjIFBhcnNlIFNlcnZlciBLZXljbG9hayBBdXRoZW50aWNhdGlvblxuXG4gICMjIEtleWNsb2FrIGBhdXRoRGF0YWBcblxuICBgYGBcbiAgICB7XG4gICAgICBcImtleWNsb2FrXCI6IHtcbiAgICAgICAgXCJhY2Nlc3NfdG9rZW5cIjogXCJhY2Nlc3MgdG9rZW4geW91IGdvdCBmcm9tIGtleWNsb2FrIEpTIGNsaWVudCBhdXRoZW50aWNhdGlvblwiLFxuICAgICAgICBcImlkXCI6IFwidGhlIGlkIHJldHJpZXZlZCBmcm9tIGNsaWVudCBhdXRoZW50aWNhdGlvbiBpbiBLZXljbG9ha1wiLFxuICAgICAgICBcInJvbGVzXCI6IFtcInRoZSByb2xlcyByZXRyaWV2ZWQgZnJvbSBjbGllbnQgYXV0aGVudGljYXRpb24gaW4gS2V5Y2xvYWtcIl0sXG4gICAgICAgIFwiZ3JvdXBzXCI6IFtcInRoZSBncm91cHMgcmV0cmlldmVkIGZyb20gY2xpZW50IGF1dGhlbnRpY2F0aW9uIGluIEtleWNsb2FrXCJdXG4gICAgICB9XG4gICAgfVxuICBgYGBcblxuICBUaGUgYXV0aGVudGljYXRpb24gbW9kdWxlIHdpbGwgdGVzdCBpZiB0aGUgYXV0aERhdGEgaXMgdGhlIHNhbWUgYXMgdGhlXG4gIHVzZXJpbmZvIG9hdXRoIGNhbGwsIGNvbXBhcmluZyB0aGUgYXR0cmlidXRlc1xuXG4gIENvcHkgdGhlIEpTT04gY29uZmlnIGZpbGUgZ2VuZXJhdGVkIG9uIEtleWNsb2FrIChodHRwczovL3d3dy5rZXljbG9hay5vcmcvZG9jcy9sYXRlc3Qvc2VjdXJpbmdfYXBwcy9pbmRleC5odG1sI19qYXZhc2NyaXB0X2FkYXB0ZXIpXG4gIGFuZCBwYXN0ZSBpdCBpbnNpZGUgb2YgYSBmb2xkZXIgKEV4LjogYGF1dGgva2V5Y2xvYWsuanNvbmApIGluIHlvdXIgc2VydmVyLlxuXG4gIFRoZSBvcHRpb25zIHBhc3NlZCB0byBQYXJzZSBzZXJ2ZXI6XG5cbiAgYGBgXG4gICAge1xuICAgICAgYXV0aDoge1xuICAgICAgICBrZXljbG9hazoge1xuICAgICAgICAgIGNvbmZpZzogcmVxdWlyZShgLi9hdXRoL2tleWNsb2FrLmpzb25gKVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICBgYGBcbiovXG5cbmNvbnN0IHsgUGFyc2UgfSA9IHJlcXVpcmUoJ3BhcnNlL25vZGUnKTtcbmNvbnN0IGh0dHBzUmVxdWVzdCA9IHJlcXVpcmUoJy4vaHR0cHNSZXF1ZXN0Jyk7XG5cbmNvbnN0IGFycmF5c0VxdWFsID0gKF9hcnIxLCBfYXJyMikgPT4ge1xuICBpZiAoIUFycmF5LmlzQXJyYXkoX2FycjEpIHx8ICFBcnJheS5pc0FycmF5KF9hcnIyKSB8fCBfYXJyMS5sZW5ndGggIT09IF9hcnIyLmxlbmd0aCkgcmV0dXJuIGZhbHNlO1xuXG4gIHZhciBhcnIxID0gX2FycjEuY29uY2F0KCkuc29ydCgpO1xuICB2YXIgYXJyMiA9IF9hcnIyLmNvbmNhdCgpLnNvcnQoKTtcblxuICBmb3IgKHZhciBpID0gMDsgaSA8IGFycjEubGVuZ3RoOyBpKyspIHtcbiAgICBpZiAoYXJyMVtpXSAhPT0gYXJyMltpXSkgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgcmV0dXJuIHRydWU7XG59O1xuXG5jb25zdCBoYW5kbGVBdXRoID0gYXN5bmMgKHsgYWNjZXNzX3Rva2VuLCBpZCwgcm9sZXMsIGdyb3VwcyB9ID0ge30sIHsgY29uZmlnIH0gPSB7fSkgPT4ge1xuICBpZiAoIShhY2Nlc3NfdG9rZW4gJiYgaWQpKSB7XG4gICAgdGhyb3cgbmV3IFBhcnNlLkVycm9yKFBhcnNlLkVycm9yLk9CSkVDVF9OT1RfRk9VTkQsICdNaXNzaW5nIGFjY2VzcyB0b2tlbiBhbmQvb3IgVXNlciBpZCcpO1xuICB9XG4gIGlmICghY29uZmlnIHx8ICEoY29uZmlnWydhdXRoLXNlcnZlci11cmwnXSAmJiBjb25maWdbJ3JlYWxtJ10pKSB7XG4gICAgdGhyb3cgbmV3IFBhcnNlLkVycm9yKFBhcnNlLkVycm9yLk9CSkVDVF9OT1RfRk9VTkQsICdNaXNzaW5nIGtleWNsb2FrIGNvbmZpZ3VyYXRpb24nKTtcbiAgfVxuICB0cnkge1xuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgaHR0cHNSZXF1ZXN0LmdldCh7XG4gICAgICBob3N0OiBjb25maWdbJ2F1dGgtc2VydmVyLXVybCddLFxuICAgICAgcGF0aDogYC9yZWFsbXMvJHtjb25maWdbJ3JlYWxtJ119L3Byb3RvY29sL29wZW5pZC1jb25uZWN0L3VzZXJpbmZvYCxcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgQXV0aG9yaXphdGlvbjogJ0JlYXJlciAnICsgYWNjZXNzX3Rva2VuLFxuICAgICAgfSxcbiAgICB9KTtcbiAgICBpZiAoXG4gICAgICByZXNwb25zZSAmJlxuICAgICAgcmVzcG9uc2UuZGF0YSAmJlxuICAgICAgcmVzcG9uc2UuZGF0YS5zdWIgPT0gaWQgJiZcbiAgICAgIGFycmF5c0VxdWFsKHJlc3BvbnNlLmRhdGEucm9sZXMsIHJvbGVzKSAmJlxuICAgICAgYXJyYXlzRXF1YWwocmVzcG9uc2UuZGF0YS5ncm91cHMsIGdyb3VwcylcbiAgICApIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhyb3cgbmV3IFBhcnNlLkVycm9yKFBhcnNlLkVycm9yLk9CSkVDVF9OT1RfRk9VTkQsICdJbnZhbGlkIGF1dGhlbnRpY2F0aW9uJyk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICBpZiAoZSBpbnN0YW5jZW9mIFBhcnNlLkVycm9yKSB7XG4gICAgICB0aHJvdyBlO1xuICAgIH1cbiAgICBjb25zdCBlcnJvciA9IEpTT04ucGFyc2UoZS50ZXh0KTtcbiAgICBpZiAoZXJyb3IuZXJyb3JfZGVzY3JpcHRpb24pIHtcbiAgICAgIHRocm93IG5ldyBQYXJzZS5FcnJvcihQYXJzZS5FcnJvci5IT1NUSU5HX0VSUk9SLCBlcnJvci5lcnJvcl9kZXNjcmlwdGlvbik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRocm93IG5ldyBQYXJzZS5FcnJvcihcbiAgICAgICAgUGFyc2UuRXJyb3IuSE9TVElOR19FUlJPUixcbiAgICAgICAgJ0NvdWxkIG5vdCBjb25uZWN0IHRvIHRoZSBhdXRoZW50aWNhdGlvbiBzZXJ2ZXInXG4gICAgICApO1xuICAgIH1cbiAgfVxufTtcblxuLypcbiAgQHBhcmFtIHtPYmplY3R9IGF1dGhEYXRhOiB0aGUgY2xpZW50IHByb3ZpZGVkIGF1dGhEYXRhXG4gIEBwYXJhbSB7c3RyaW5nfSBhdXRoRGF0YS5hY2Nlc3NfdG9rZW46IHRoZSBhY2Nlc3NfdG9rZW4gcmV0cmlldmVkIGZyb20gY2xpZW50IGF1dGhlbnRpY2F0aW9uIGluIEtleWNsb2FrXG4gIEBwYXJhbSB7c3RyaW5nfSBhdXRoRGF0YS5pZDogdGhlIGlkIHJldHJpZXZlZCBmcm9tIGNsaWVudCBhdXRoZW50aWNhdGlvbiBpbiBLZXljbG9ha1xuICBAcGFyYW0ge0FycmF5fSAgYXV0aERhdGEucm9sZXM6IHRoZSByb2xlcyByZXRyaWV2ZWQgZnJvbSBjbGllbnQgYXV0aGVudGljYXRpb24gaW4gS2V5Y2xvYWtcbiAgQHBhcmFtIHtBcnJheX0gIGF1dGhEYXRhLmdyb3VwczogdGhlIGdyb3VwcyByZXRyaWV2ZWQgZnJvbSBjbGllbnQgYXV0aGVudGljYXRpb24gaW4gS2V5Y2xvYWtcbiAgQHBhcmFtIHtPYmplY3R9IG9wdGlvbnM6IGFkZGl0aW9uYWwgb3B0aW9uc1xuICBAcGFyYW0ge09iamVjdH0gb3B0aW9ucy5jb25maWc6IHRoZSBjb25maWcgb2JqZWN0IHBhc3NlZCBkdXJpbmcgUGFyc2UgU2VydmVyIGluc3RhbnRpYXRpb25cbiovXG5mdW5jdGlvbiB2YWxpZGF0ZUF1dGhEYXRhKGF1dGhEYXRhLCBvcHRpb25zID0ge30pIHtcbiAgcmV0dXJuIGhhbmRsZUF1dGgoYXV0aERhdGEsIG9wdGlvbnMpO1xufVxuXG4vLyBSZXR1cm5zIGEgcHJvbWlzZSB0aGF0IGZ1bGZpbGxzIGlmIHRoaXMgYXBwIGlkIGlzIHZhbGlkLlxuZnVuY3Rpb24gdmFsaWRhdGVBcHBJZCgpIHtcbiAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgdmFsaWRhdGVBcHBJZCxcbiAgdmFsaWRhdGVBdXRoRGF0YSxcbn07XG4iXX0=